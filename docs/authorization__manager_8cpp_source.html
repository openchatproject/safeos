<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Eos: libraries/chain/authorization_manager.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Eos
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_bc0718b08fb2015b8e59c47b2805f60c.html">libraries</a></li><li class="navelem"><a class="el" href="dir_94df585d4e205d65756e56c0817a7014.html">chain</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">authorization_manager.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="authorization__manager_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="authorization__manager_8hpp.html">eosio/chain/authorization_manager.hpp</a>&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="exceptions_8hpp.html">eosio/chain/exceptions.hpp</a>&gt;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="permission__object_8hpp.html">eosio/chain/permission_object.hpp</a>&gt;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="permission__link__object_8hpp.html">eosio/chain/permission_link_object.hpp</a>&gt;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="authority__checker_8hpp.html">eosio/chain/authority_checker.hpp</a>&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="controller_8hpp.html">eosio/chain/controller.hpp</a>&gt;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="global__property__object_8hpp.html">eosio/chain/global_property_object.hpp</a>&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="contract__types_8hpp.html">eosio/chain/contract_types.hpp</a>&gt;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="generated__transaction__object_8hpp.html">eosio/chain/generated_transaction_object.hpp</a>&gt;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceeosio.html">eosio</a> { <span class="keyword">namespace </span>chain {</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1authorization__manager_a04d6fcf78bac06011bf471ec7e85aca1.html#a04d6fcf78bac06011bf471ec7e85aca1">   18</a></span>&#160;   <a class="code" href="classeosio_1_1chain_1_1authorization__manager_a04d6fcf78bac06011bf471ec7e85aca1.html#a04d6fcf78bac06011bf471ec7e85aca1">authorization_manager::authorization_manager</a>(<a class="code" href="classeosio_1_1chain_1_1controller.html">controller</a>&amp; c, database&amp; d)</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;   :_control(c),_db(d){}</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1authorization__manager_af81cfb509b0a2317a79f69d170dbadb3.html#af81cfb509b0a2317a79f69d170dbadb3">   21</a></span>&#160;   <span class="keywordtype">void</span> <a class="code" href="classeosio_1_1chain_1_1authorization__manager_af81cfb509b0a2317a79f69d170dbadb3.html#af81cfb509b0a2317a79f69d170dbadb3">authorization_manager::add_indices</a>() {</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;      _db.add_index&lt;<a class="code" href="namespaceeosio_1_1chain_a8f2f7aceaab268a032990183a430fa4a.html#a8f2f7aceaab268a032990183a430fa4a">permission_index</a>&gt;();</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;      _db.add_index&lt;<a class="code" href="namespaceeosio_1_1chain_adee2bbd448f667030f85d96603e1ee32.html#adee2bbd448f667030f85d96603e1ee32">permission_usage_index</a>&gt;();</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;      _db.add_index&lt;<a class="code" href="namespaceeosio_1_1chain_a8cc2780bda427e8aca0680bc9c1cbda2.html#a8cc2780bda427e8aca0680bc9c1cbda2">permission_link_index</a>&gt;();</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;   }</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1authorization__manager_ad1f330edc0e8067d0118657da09f5994.html#ad1f330edc0e8067d0118657da09f5994">   27</a></span>&#160;   <span class="keywordtype">void</span> <a class="code" href="classeosio_1_1chain_1_1authorization__manager_ad1f330edc0e8067d0118657da09f5994.html#ad1f330edc0e8067d0118657da09f5994">authorization_manager::initialize_database</a>() {</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;      _db.create&lt;<a class="code" href="classeosio_1_1chain_1_1permission__object.html">permission_object</a>&gt;([](<span class="keyword">auto</span>&amp;){}); </div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;   }</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1authorization__manager_a78089b665cfc36ba15d8fd8be54faad3.html#a78089b665cfc36ba15d8fd8be54faad3">   31</a></span>&#160;   <span class="keyword">const</span> <a class="code" href="classeosio_1_1chain_1_1permission__object.html">permission_object</a>&amp; <a class="code" href="classeosio_1_1chain_1_1authorization__manager_a78089b665cfc36ba15d8fd8be54faad3.html#a78089b665cfc36ba15d8fd8be54faad3">authorization_manager::create_permission</a>( <a class="code" href="structeosio_1_1chain_1_1name.html">account_name</a> account,</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;                                                                      <a class="code" href="structeosio_1_1chain_1_1name.html">permission_name</a> <a class="code" href="structeosio_1_1chain_1_1name.html">name</a>,</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;                                                                      <a class="code" href="classeosio_1_1chain_1_1authorization__manager_ac2d8460231201d7555c7dbb37fda47c1.html#ac2d8460231201d7555c7dbb37fda47c1">permission_id_type</a> parent,</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                                                                      <span class="keyword">const</span> <a class="code" href="structeosio_1_1chain_1_1authority.html">authority</a>&amp; auth,</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                                                                      time_point initial_creation_time</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                                                                    )</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;   {</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      <span class="keyword">auto</span> creation_time = initial_creation_time;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      <span class="keywordflow">if</span>( creation_time == time_point() ) {</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;         creation_time = _control.<a class="code" href="classeosio_1_1chain_1_1controller_a675086138c644442ef3a084e027a7d5a.html#a675086138c644442ef3a084e027a7d5a">pending_block_time</a>();</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      }</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; perm_usage = _db.create&lt;<a class="code" href="classeosio_1_1chain_1_1permission__usage__object.html">permission_usage_object</a>&gt;([&amp;](<span class="keyword">auto</span>&amp; p) {</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;         p.last_used = creation_time;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      });</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; perm = _db.create&lt;<a class="code" href="classeosio_1_1chain_1_1permission__object.html">permission_object</a>&gt;([&amp;](<span class="keyword">auto</span>&amp; p) {</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;         p.usage_id     = perm_usage.id;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;         p.parent       = parent;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;         p.owner        = account;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;         p.<a class="code" href="structeosio_1_1chain_1_1name_a2791ae46649a1dada298257d5c321fb8.html#a2791ae46649a1dada298257d5c321fb8">name</a>         = <a class="code" href="structeosio_1_1chain_1_1name.html">name</a>;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;         p.last_updated = creation_time;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;         p.auth         = auth;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      });</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="keywordflow">return</span> perm;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   }</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1authorization__manager_ad01a18835d462a37a72c23bd6183f0ef.html#ad01a18835d462a37a72c23bd6183f0ef">   58</a></span>&#160;   <span class="keyword">const</span> <a class="code" href="classeosio_1_1chain_1_1permission__object.html">permission_object</a>&amp; <a class="code" href="classeosio_1_1chain_1_1authorization__manager_a78089b665cfc36ba15d8fd8be54faad3.html#a78089b665cfc36ba15d8fd8be54faad3">authorization_manager::create_permission</a>( <a class="code" href="structeosio_1_1chain_1_1name.html">account_name</a> account,</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                                                                      <a class="code" href="structeosio_1_1chain_1_1name.html">permission_name</a> <a class="code" href="structeosio_1_1chain_1_1name.html">name</a>,</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                                                                      <a class="code" href="classeosio_1_1chain_1_1authorization__manager_ac2d8460231201d7555c7dbb37fda47c1.html#ac2d8460231201d7555c7dbb37fda47c1">permission_id_type</a> parent,</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                                                                      <a class="code" href="structeosio_1_1chain_1_1authority.html">authority</a>&amp;&amp; auth,</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                                                                      time_point initial_creation_time</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                                                                    )</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   {</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keyword">auto</span> creation_time = initial_creation_time;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keywordflow">if</span>( creation_time == time_point() ) {</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;         creation_time = _control.<a class="code" href="classeosio_1_1chain_1_1controller_a675086138c644442ef3a084e027a7d5a.html#a675086138c644442ef3a084e027a7d5a">pending_block_time</a>();</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      }</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; perm_usage = _db.create&lt;<a class="code" href="classeosio_1_1chain_1_1permission__usage__object.html">permission_usage_object</a>&gt;([&amp;](<span class="keyword">auto</span>&amp; p) {</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;         p.last_used = creation_time;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      });</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; perm = _db.create&lt;<a class="code" href="classeosio_1_1chain_1_1permission__object.html">permission_object</a>&gt;([&amp;](<span class="keyword">auto</span>&amp; p) {</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;         p.usage_id     = perm_usage.id;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;         p.parent       = parent;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;         p.owner        = account;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;         p.<a class="code" href="structeosio_1_1chain_1_1name_a2791ae46649a1dada298257d5c321fb8.html#a2791ae46649a1dada298257d5c321fb8">name</a>         = <a class="code" href="structeosio_1_1chain_1_1name.html">name</a>;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;         p.last_updated = creation_time;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;         p.auth         = std::move(auth);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      });</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keywordflow">return</span> perm;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;   }</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1authorization__manager_a8b4ca2f59c40bdbb6c5e2d82c898caee.html#a8b4ca2f59c40bdbb6c5e2d82c898caee">   85</a></span>&#160;   <span class="keywordtype">void</span> <a class="code" href="classeosio_1_1chain_1_1authorization__manager_a8b4ca2f59c40bdbb6c5e2d82c898caee.html#a8b4ca2f59c40bdbb6c5e2d82c898caee">authorization_manager::modify_permission</a>( <span class="keyword">const</span> <a class="code" href="classeosio_1_1chain_1_1permission__object.html">permission_object</a>&amp; permission, <span class="keyword">const</span> <a class="code" href="structeosio_1_1chain_1_1authority.html">authority</a>&amp; auth ) {</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      _db.modify( permission, [&amp;](<a class="code" href="classeosio_1_1chain_1_1permission__object.html">permission_object</a>&amp; po) {</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;         po.auth = auth;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;         po.last_updated = _control.<a class="code" href="classeosio_1_1chain_1_1controller_a675086138c644442ef3a084e027a7d5a.html#a675086138c644442ef3a084e027a7d5a">pending_block_time</a>();</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      });</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;   }</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1authorization__manager_a46dfa24814957f09c1c2221179ced841.html#a46dfa24814957f09c1c2221179ced841">   92</a></span>&#160;   <span class="keywordtype">void</span> <a class="code" href="classeosio_1_1chain_1_1authorization__manager_a46dfa24814957f09c1c2221179ced841.html#a46dfa24814957f09c1c2221179ced841">authorization_manager::remove_permission</a>( <span class="keyword">const</span> <a class="code" href="classeosio_1_1chain_1_1permission__object.html">permission_object</a>&amp; permission ) {</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; index = _db.template get_index&lt;permission_index, by_parent&gt;();</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <span class="keyword">auto</span> range = index.equal_range(permission.id);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( range.first == range.second, <a class="code" href="namespaceeosio_1_1chain_a5c927b6a4cc85cdefe99b1a48034e584.html#a5c927b6a4cc85cdefe99b1a48034e584">action_validate_exception</a>,</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                  <span class="stringliteral">&quot;Cannot remove a permission which has children. Remove the children first.&quot;</span>);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      _db.get_mutable_index&lt;<a class="code" href="namespaceeosio_1_1chain_adee2bbd448f667030f85d96603e1ee32.html#adee2bbd448f667030f85d96603e1ee32">permission_usage_index</a>&gt;().remove_object( permission.usage_id._id );</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      _db.remove( permission );</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;   }</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1authorization__manager_a2cbd47dc471035cccd8e415617491153.html#a2cbd47dc471035cccd8e415617491153">  102</a></span>&#160;   <span class="keywordtype">void</span> <a class="code" href="classeosio_1_1chain_1_1authorization__manager_a2cbd47dc471035cccd8e415617491153.html#a2cbd47dc471035cccd8e415617491153">authorization_manager::update_permission_usage</a>( <span class="keyword">const</span> <a class="code" href="classeosio_1_1chain_1_1permission__object.html">permission_object</a>&amp; permission ) {</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; puo = _db.get&lt;<a class="code" href="classeosio_1_1chain_1_1permission__usage__object.html">permission_usage_object</a>, by_id&gt;( permission.usage_id );</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      _db.modify( puo, [&amp;](<a class="code" href="classeosio_1_1chain_1_1permission__usage__object.html">permission_usage_object</a>&amp; p) {</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;         p.last_used = _control.<a class="code" href="classeosio_1_1chain_1_1controller_a675086138c644442ef3a084e027a7d5a.html#a675086138c644442ef3a084e027a7d5a">pending_block_time</a>();</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      });</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;   }</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1authorization__manager_abd4544d87930617c51d39c394058c329.html#abd4544d87930617c51d39c394058c329">  109</a></span>&#160;   fc::time_point <a class="code" href="classeosio_1_1chain_1_1authorization__manager_abd4544d87930617c51d39c394058c329.html#abd4544d87930617c51d39c394058c329">authorization_manager::get_permission_last_used</a>( <span class="keyword">const</span> <a class="code" href="classeosio_1_1chain_1_1permission__object.html">permission_object</a>&amp; permission )<span class="keyword">const </span>{</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="keywordflow">return</span> _db.get&lt;<a class="code" href="classeosio_1_1chain_1_1permission__usage__object.html">permission_usage_object</a>, by_id&gt;( permission.usage_id ).last_used;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;   }</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1authorization__manager_a27421e55aa9490ec47637535be08eed5.html#a27421e55aa9490ec47637535be08eed5">  113</a></span>&#160;   <span class="keyword">const</span> <a class="code" href="classeosio_1_1chain_1_1permission__object.html">permission_object</a>*  <a class="code" href="classeosio_1_1chain_1_1authorization__manager_a27421e55aa9490ec47637535be08eed5.html#a27421e55aa9490ec47637535be08eed5">authorization_manager::find_permission</a>( <span class="keyword">const</span> <a class="code" href="structeosio_1_1chain_1_1permission__level.html">permission_level</a>&amp; level )<span class="keyword">const</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="keyword">   </span>{ <span class="keywordflow">try</span> {</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      FC_ASSERT( !level.<a class="code" href="structeosio_1_1chain_1_1permission__level_a2be46de0b7cb1dd3802b62792b2c80ce.html#a2be46de0b7cb1dd3802b62792b2c80ce">actor</a>.<a class="code" href="structeosio_1_1chain_1_1name_a9bf42b486a3bb938fc5cfaf1af8345d7.html#a9bf42b486a3bb938fc5cfaf1af8345d7">empty</a>() &amp;&amp; !level.<a class="code" href="structeosio_1_1chain_1_1permission__level_af2ed5aef662fd4dd82bfac8314c54512.html#af2ed5aef662fd4dd82bfac8314c54512">permission</a>.<a class="code" href="structeosio_1_1chain_1_1name_a9bf42b486a3bb938fc5cfaf1af8345d7.html#a9bf42b486a3bb938fc5cfaf1af8345d7">empty</a>(), <span class="stringliteral">&quot;Invalid permission&quot;</span> );</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <span class="keywordflow">return</span> _db.find&lt;<a class="code" href="classeosio_1_1chain_1_1permission__object.html">permission_object</a>, by_owner&gt;( boost::make_tuple(level.<a class="code" href="structeosio_1_1chain_1_1permission__level_a2be46de0b7cb1dd3802b62792b2c80ce.html#a2be46de0b7cb1dd3802b62792b2c80ce">actor</a>,level.<a class="code" href="structeosio_1_1chain_1_1permission__level_af2ed5aef662fd4dd82bfac8314c54512.html#af2ed5aef662fd4dd82bfac8314c54512">permission</a>) );</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   } <a class="code" href="exceptions_8hpp_ad71dd5d060716dc452bf1f191b9fca54.html#ad71dd5d060716dc452bf1f191b9fca54">EOS_RETHROW_EXCEPTIONS</a>( chain::permission_query_exception, <span class="stringliteral">&quot;Failed to retrieve permission: ${level}&quot;</span>, (<span class="stringliteral">&quot;level&quot;</span>, level) ) }</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1authorization__manager_ae85e228f0e9419b747f1c592e6d422b1.html#ae85e228f0e9419b747f1c592e6d422b1">  119</a></span>&#160;   <span class="keyword">const</span> <a class="code" href="classeosio_1_1chain_1_1permission__object.html">permission_object</a>&amp;  <a class="code" href="classeosio_1_1chain_1_1authorization__manager_ae85e228f0e9419b747f1c592e6d422b1.html#ae85e228f0e9419b747f1c592e6d422b1">authorization_manager::get_permission</a>( <span class="keyword">const</span> <a class="code" href="structeosio_1_1chain_1_1permission__level.html">permission_level</a>&amp; level )<span class="keyword">const</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="keyword">   </span>{ <span class="keywordflow">try</span> {</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      FC_ASSERT( !level.<a class="code" href="structeosio_1_1chain_1_1permission__level_a2be46de0b7cb1dd3802b62792b2c80ce.html#a2be46de0b7cb1dd3802b62792b2c80ce">actor</a>.<a class="code" href="structeosio_1_1chain_1_1name_a9bf42b486a3bb938fc5cfaf1af8345d7.html#a9bf42b486a3bb938fc5cfaf1af8345d7">empty</a>() &amp;&amp; !level.<a class="code" href="structeosio_1_1chain_1_1permission__level_af2ed5aef662fd4dd82bfac8314c54512.html#af2ed5aef662fd4dd82bfac8314c54512">permission</a>.<a class="code" href="structeosio_1_1chain_1_1name_a9bf42b486a3bb938fc5cfaf1af8345d7.html#a9bf42b486a3bb938fc5cfaf1af8345d7">empty</a>(), <span class="stringliteral">&quot;Invalid permission&quot;</span> );</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <span class="keywordflow">return</span> _db.get&lt;<a class="code" href="classeosio_1_1chain_1_1permission__object.html">permission_object</a>, by_owner&gt;( boost::make_tuple(level.<a class="code" href="structeosio_1_1chain_1_1permission__level_a2be46de0b7cb1dd3802b62792b2c80ce.html#a2be46de0b7cb1dd3802b62792b2c80ce">actor</a>,level.<a class="code" href="structeosio_1_1chain_1_1permission__level_af2ed5aef662fd4dd82bfac8314c54512.html#af2ed5aef662fd4dd82bfac8314c54512">permission</a>) );</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;   } <a class="code" href="exceptions_8hpp_ad71dd5d060716dc452bf1f191b9fca54.html#ad71dd5d060716dc452bf1f191b9fca54">EOS_RETHROW_EXCEPTIONS</a>( chain::permission_query_exception, <span class="stringliteral">&quot;Failed to retrieve permission: ${level}&quot;</span>, (<span class="stringliteral">&quot;level&quot;</span>, level) ) }</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;   optional&lt;permission_name&gt; authorization_manager::lookup_linked_permission( <a class="code" href="structeosio_1_1chain_1_1name.html">account_name</a> authorizer_account,</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                                                                              <a class="code" href="structeosio_1_1chain_1_1name.html">account_name</a> scope,</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                                                                              <a class="code" href="namespaceeosio_1_1chain_afb4a1df1715a88764f246867c5d32796.html#afb4a1df1715a88764f246867c5d32796">action_name</a> act_name</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                                                                            )<span class="keyword">const</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="keyword">   </span>{</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="keywordflow">try</span> {</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;         <span class="comment">// First look up a specific link for this message act_name</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;         <span class="keyword">auto</span> key = boost::make_tuple(authorizer_account, scope, act_name);</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;         <span class="keyword">auto</span> link = _db.find&lt;<a class="code" href="classeosio_1_1chain_1_1permission__link__object.html">permission_link_object</a>, by_action_name&gt;(key);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;         <span class="comment">// If no specific link found, check for a contract-wide default</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;         <span class="keywordflow">if</span> (link == <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            boost::get&lt;2&gt;(key) = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            link = _db.find&lt;<a class="code" href="classeosio_1_1chain_1_1permission__link__object.html">permission_link_object</a>, by_action_name&gt;(key);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;         }</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;         <span class="comment">// If no specific or default link found, use active permission</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;         <span class="keywordflow">if</span> (link != <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            <span class="keywordflow">return</span> link-&gt;required_permission;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;         }</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;         <span class="keywordflow">return</span> optional&lt;permission_name&gt;();</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;       <span class="comment">//  return optional&lt;permission_name&gt;();</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      } FC_CAPTURE_AND_RETHROW((authorizer_account)(scope)(act_name))</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;   }</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1authorization__manager_a90ff596e8f43e56adce58888f5b9cdbe.html#a90ff596e8f43e56adce58888f5b9cdbe">  150</a></span>&#160;   optional&lt;permission_name&gt; <a class="code" href="classeosio_1_1chain_1_1authorization__manager_a90ff596e8f43e56adce58888f5b9cdbe.html#a90ff596e8f43e56adce58888f5b9cdbe">authorization_manager::lookup_minimum_permission</a>( <a class="code" href="structeosio_1_1chain_1_1name.html">account_name</a> authorizer_account,</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                                                                               <a class="code" href="structeosio_1_1chain_1_1name.html">account_name</a> scope,</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                                                                               <a class="code" href="namespaceeosio_1_1chain_afb4a1df1715a88764f246867c5d32796.html#afb4a1df1715a88764f246867c5d32796">action_name</a> act_name</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                                                                             )<span class="keyword">const</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="keyword">   </span>{</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="comment">// Special case native actions cannot be linked to a minimum permission, so there is no need to check.</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="keywordflow">if</span>( scope == config::system_account_name ) {</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;          FC_ASSERT( act_name != <a class="code" href="structeosio_1_1chain_1_1updateauth_ad5f94b0b8b12b0e6af3343e9de2785a1.html#ad5f94b0b8b12b0e6af3343e9de2785a1">updateauth::get_name</a>() &amp;&amp;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                     act_name != <a class="code" href="structeosio_1_1chain_1_1deleteauth_aee35011bcdc77db217f3aefa55cd3825.html#aee35011bcdc77db217f3aefa55cd3825">deleteauth::get_name</a>() &amp;&amp;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                     act_name != <a class="code" href="structeosio_1_1chain_1_1linkauth_af6700bc07612af4bfc68ed8ae983dd5d.html#af6700bc07612af4bfc68ed8ae983dd5d">linkauth::get_name</a>() &amp;&amp;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                     act_name != <a class="code" href="structeosio_1_1chain_1_1unlinkauth_adc8f3b48fa1b32191511131e6b2ad3b5.html#adc8f3b48fa1b32191511131e6b2ad3b5">unlinkauth::get_name</a>() &amp;&amp;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                     act_name != <a class="code" href="structeosio_1_1chain_1_1canceldelay_a62e317132e2afb4c99a3aa872d98efdd.html#a62e317132e2afb4c99a3aa872d98efdd">canceldelay::get_name</a>(),</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                     <span class="stringliteral">&quot;cannot call lookup_minimum_permission on native actions that are not allowed to be linked to minimum permissions&quot;</span> );</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      }</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <span class="keywordflow">try</span> {</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;         optional&lt;permission_name&gt; linked_permission = lookup_linked_permission(authorizer_account, scope, act_name);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;         <span class="keywordflow">if</span>( !linked_permission )</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            <span class="keywordflow">return</span> config::active_name;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;         <span class="keywordflow">if</span>( *linked_permission == config::eosio_any_name )</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <span class="keywordflow">return</span> optional&lt;permission_name&gt;();</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;         <span class="keywordflow">return</span> linked_permission;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      } FC_CAPTURE_AND_RETHROW((authorizer_account)(scope)(act_name))</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;   }</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;   <span class="keywordtype">void</span> authorization_manager::check_updateauth_authorization( <span class="keyword">const</span> <a class="code" href="structeosio_1_1chain_1_1updateauth.html">updateauth</a>&amp; update,</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                                                               <span class="keyword">const</span> vector&lt;permission_level&gt;&amp; auths</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                                                             )<span class="keyword">const</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="keyword">   </span>{</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( auths.size() == 1, irrelevant_auth_exception,</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                  <span class="stringliteral">&quot;updateauth action should only have one declared authorization&quot;</span> );</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; auth = auths[0];</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( auth.actor == update.<a class="code" href="structeosio_1_1chain_1_1updateauth_a24d1511732ae261a3212e8b2cb85d29f.html#a24d1511732ae261a3212e8b2cb85d29f">account</a>, irrelevant_auth_exception,</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                  <span class="stringliteral">&quot;the owner of the affected permission needs to be the actor of the declared authorization&quot;</span> );</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>* min_permission = <a class="code" href="classeosio_1_1chain_1_1authorization__manager_a27421e55aa9490ec47637535be08eed5.html#a27421e55aa9490ec47637535be08eed5">find_permission</a>({update.<a class="code" href="structeosio_1_1chain_1_1updateauth_a24d1511732ae261a3212e8b2cb85d29f.html#a24d1511732ae261a3212e8b2cb85d29f">account</a>, update.<a class="code" href="structeosio_1_1chain_1_1updateauth_aa8c084d97749320027bb1207832ff073.html#aa8c084d97749320027bb1207832ff073">permission</a>});</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keywordflow">if</span>( !min_permission ) { <span class="comment">// creating a new permission</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;         min_permission = &amp;<a class="code" href="classeosio_1_1chain_1_1authorization__manager_ae85e228f0e9419b747f1c592e6d422b1.html#ae85e228f0e9419b747f1c592e6d422b1">get_permission</a>({update.<a class="code" href="structeosio_1_1chain_1_1updateauth_a24d1511732ae261a3212e8b2cb85d29f.html#a24d1511732ae261a3212e8b2cb85d29f">account</a>, update.<a class="code" href="structeosio_1_1chain_1_1updateauth_a6e86407d83b12428e07de8441a2a315b.html#a6e86407d83b12428e07de8441a2a315b">parent</a>});</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      }</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( <a class="code" href="classeosio_1_1chain_1_1authorization__manager_ae85e228f0e9419b747f1c592e6d422b1.html#ae85e228f0e9419b747f1c592e6d422b1">get_permission</a>(auth).satisfies( *min_permission,</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                                                  _db.get_index&lt;<a class="code" href="namespaceeosio_1_1chain_a8f2f7aceaab268a032990183a430fa4a.html#a8f2f7aceaab268a032990183a430fa4a">permission_index</a>&gt;().indices() ),</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                  irrelevant_auth_exception,</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                  <span class="stringliteral">&quot;updateauth action declares irrelevant authority &#39;${auth}&#39;; minimum authority is ${min}&quot;</span>,</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                  (<span class="stringliteral">&quot;auth&quot;</span>, auth)(<span class="stringliteral">&quot;min&quot;</span>, permission_level{update.<a class="code" href="structeosio_1_1chain_1_1updateauth_a24d1511732ae261a3212e8b2cb85d29f.html#a24d1511732ae261a3212e8b2cb85d29f">account</a>, min_permission-&gt;<a class="code" href="structeosio_1_1chain_1_1name_a2791ae46649a1dada298257d5c321fb8.html#a2791ae46649a1dada298257d5c321fb8">name</a>}) );</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;   }</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   <span class="keywordtype">void</span> authorization_manager::check_deleteauth_authorization( <span class="keyword">const</span> deleteauth&amp; del,</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                                                               <span class="keyword">const</span> vector&lt;permission_level&gt;&amp; auths</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                                                             )<span class="keyword">const</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="keyword">   </span>{</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( auths.size() == 1, irrelevant_auth_exception,</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                  <span class="stringliteral">&quot;deleteauth action should only have one declared authorization&quot;</span> );</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; auth = auths[0];</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( auth.actor == del.account, irrelevant_auth_exception,</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                  <span class="stringliteral">&quot;the owner of the permission to delete needs to be the actor of the declared authorization&quot;</span> );</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; min_permission = <a class="code" href="classeosio_1_1chain_1_1authorization__manager_ae85e228f0e9419b747f1c592e6d422b1.html#ae85e228f0e9419b747f1c592e6d422b1">get_permission</a>({del.account, del.permission});</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( <a class="code" href="classeosio_1_1chain_1_1authorization__manager_ae85e228f0e9419b747f1c592e6d422b1.html#ae85e228f0e9419b747f1c592e6d422b1">get_permission</a>(auth).satisfies( min_permission,</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                                                  _db.get_index&lt;<a class="code" href="namespaceeosio_1_1chain_a8f2f7aceaab268a032990183a430fa4a.html#a8f2f7aceaab268a032990183a430fa4a">permission_index</a>&gt;().indices() ),</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                  irrelevant_auth_exception,</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                  <span class="stringliteral">&quot;updateauth action declares irrelevant authority &#39;${auth}&#39;; minimum authority is ${min}&quot;</span>,</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                  (<span class="stringliteral">&quot;auth&quot;</span>, auth)(<span class="stringliteral">&quot;min&quot;</span>, permission_level{min_permission.owner, min_permission.name}) );</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;   }</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   <span class="keywordtype">void</span> authorization_manager::check_linkauth_authorization( <span class="keyword">const</span> linkauth&amp; link,</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                                                             <span class="keyword">const</span> vector&lt;permission_level&gt;&amp; auths</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                                                           )<span class="keyword">const</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="keyword">   </span>{</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( auths.size() == 1, irrelevant_auth_exception,</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                  <span class="stringliteral">&quot;link action should only have one declared authorization&quot;</span> );</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; auth = auths[0];</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( auth.actor == link.account, irrelevant_auth_exception,</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                  <span class="stringliteral">&quot;the owner of the linked permission needs to be the actor of the declared authorization&quot;</span> );</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( link.type != <a class="code" href="structeosio_1_1chain_1_1updateauth_ad5f94b0b8b12b0e6af3343e9de2785a1.html#ad5f94b0b8b12b0e6af3343e9de2785a1">updateauth::get_name</a>(),  <a class="code" href="namespaceeosio_1_1chain_a5c927b6a4cc85cdefe99b1a48034e584.html#a5c927b6a4cc85cdefe99b1a48034e584">action_validate_exception</a>,</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                  <span class="stringliteral">&quot;Cannot link eosio::updateauth to a minimum permission&quot;</span> );</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( link.type != <a class="code" href="structeosio_1_1chain_1_1deleteauth_aee35011bcdc77db217f3aefa55cd3825.html#aee35011bcdc77db217f3aefa55cd3825">deleteauth::get_name</a>(),  <a class="code" href="namespaceeosio_1_1chain_a5c927b6a4cc85cdefe99b1a48034e584.html#a5c927b6a4cc85cdefe99b1a48034e584">action_validate_exception</a>,</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                  <span class="stringliteral">&quot;Cannot link eosio::deleteauth to a minimum permission&quot;</span> );</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( link.type != <a class="code" href="structeosio_1_1chain_1_1linkauth_af6700bc07612af4bfc68ed8ae983dd5d.html#af6700bc07612af4bfc68ed8ae983dd5d">linkauth::get_name</a>(),    <a class="code" href="namespaceeosio_1_1chain_a5c927b6a4cc85cdefe99b1a48034e584.html#a5c927b6a4cc85cdefe99b1a48034e584">action_validate_exception</a>,</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                  <span class="stringliteral">&quot;Cannot link eosio::linkauth to a minimum permission&quot;</span> );</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( link.type != <a class="code" href="structeosio_1_1chain_1_1unlinkauth_adc8f3b48fa1b32191511131e6b2ad3b5.html#adc8f3b48fa1b32191511131e6b2ad3b5">unlinkauth::get_name</a>(),  <a class="code" href="namespaceeosio_1_1chain_a5c927b6a4cc85cdefe99b1a48034e584.html#a5c927b6a4cc85cdefe99b1a48034e584">action_validate_exception</a>,</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                  <span class="stringliteral">&quot;Cannot link eosio::unlinkauth to a minimum permission&quot;</span> );</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( link.type != <a class="code" href="structeosio_1_1chain_1_1canceldelay_a62e317132e2afb4c99a3aa872d98efdd.html#a62e317132e2afb4c99a3aa872d98efdd">canceldelay::get_name</a>(), <a class="code" href="namespaceeosio_1_1chain_a5c927b6a4cc85cdefe99b1a48034e584.html#a5c927b6a4cc85cdefe99b1a48034e584">action_validate_exception</a>,</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                  <span class="stringliteral">&quot;Cannot link eosio::canceldelay to a minimum permission&quot;</span> );</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> linked_permission_name = <a class="code" href="classeosio_1_1chain_1_1authorization__manager_a90ff596e8f43e56adce58888f5b9cdbe.html#a90ff596e8f43e56adce58888f5b9cdbe">lookup_minimum_permission</a>(link.account, link.code, link.type);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="keywordflow">if</span>( !linked_permission_name ) <span class="comment">// if action is linked to eosio.any permission</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( <a class="code" href="classeosio_1_1chain_1_1authorization__manager_ae85e228f0e9419b747f1c592e6d422b1.html#ae85e228f0e9419b747f1c592e6d422b1">get_permission</a>(auth).satisfies( <a class="code" href="classeosio_1_1chain_1_1authorization__manager_ae85e228f0e9419b747f1c592e6d422b1.html#ae85e228f0e9419b747f1c592e6d422b1">get_permission</a>({link.account, *linked_permission_name}),</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                                                  _db.get_index&lt;<a class="code" href="namespaceeosio_1_1chain_a8f2f7aceaab268a032990183a430fa4a.html#a8f2f7aceaab268a032990183a430fa4a">permission_index</a>&gt;().indices()              ),</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                  irrelevant_auth_exception,</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                  <span class="stringliteral">&quot;link action declares irrelevant authority &#39;${auth}&#39;; minimum authority is ${min}&quot;</span>,</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                  (<span class="stringliteral">&quot;auth&quot;</span>, auth)(<span class="stringliteral">&quot;min&quot;</span>, permission_level{link.account, *linked_permission_name}) );</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;   }</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;   <span class="keywordtype">void</span> authorization_manager::check_unlinkauth_authorization( <span class="keyword">const</span> unlinkauth&amp; unlink,</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                                                               <span class="keyword">const</span> vector&lt;permission_level&gt;&amp; auths</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                                                             )<span class="keyword">const</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="keyword">   </span>{</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( auths.size() == 1, irrelevant_auth_exception,</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                  <span class="stringliteral">&quot;unlink action should only have one declared authorization&quot;</span> );</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; auth = auths[0];</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( auth.actor == unlink.account, irrelevant_auth_exception,</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                  <span class="stringliteral">&quot;the owner of the linked permission needs to be the actor of the declared authorization&quot;</span> );</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> unlinked_permission_name = lookup_linked_permission(unlink.account, unlink.code, unlink.type);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( unlinked_permission_name.valid(), <a class="code" href="namespaceeosio_1_1chain_ad6e015097a10f08028a3e3df3b17ecdf.html#ad6e015097a10f08028a3e3df3b17ecdf">transaction_exception</a>,</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                  <span class="stringliteral">&quot;cannot unlink non-existent permission link of account &#39;${account}&#39; for actions matching &#39;${code}::${action}&#39;&quot;</span>,</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                  (<span class="stringliteral">&quot;account&quot;</span>, unlink.account)(<span class="stringliteral">&quot;code&quot;</span>, unlink.code)(<span class="stringliteral">&quot;action&quot;</span>, unlink.type) );</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      <span class="keywordflow">if</span>( *unlinked_permission_name == config::eosio_any_name )</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( <a class="code" href="classeosio_1_1chain_1_1authorization__manager_ae85e228f0e9419b747f1c592e6d422b1.html#ae85e228f0e9419b747f1c592e6d422b1">get_permission</a>(auth).satisfies( <a class="code" href="classeosio_1_1chain_1_1authorization__manager_ae85e228f0e9419b747f1c592e6d422b1.html#ae85e228f0e9419b747f1c592e6d422b1">get_permission</a>({unlink.account, *unlinked_permission_name}),</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                                                  _db.get_index&lt;<a class="code" href="namespaceeosio_1_1chain_a8f2f7aceaab268a032990183a430fa4a.html#a8f2f7aceaab268a032990183a430fa4a">permission_index</a>&gt;().indices()                  ),</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                  irrelevant_auth_exception,</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                  <span class="stringliteral">&quot;unlink action declares irrelevant authority &#39;${auth}&#39;; minimum authority is ${min}&quot;</span>,</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                  (<span class="stringliteral">&quot;auth&quot;</span>, auth)(<span class="stringliteral">&quot;min&quot;</span>, permission_level{unlink.account, *unlinked_permission_name}) );</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;   }</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;   fc::microseconds authorization_manager::check_canceldelay_authorization( <span class="keyword">const</span> canceldelay&amp; cancel,</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                                                                            <span class="keyword">const</span> vector&lt;permission_level&gt;&amp; auths</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                                                                          )<span class="keyword">const</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="keyword">   </span>{</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( auths.size() == 1, irrelevant_auth_exception,</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                  <span class="stringliteral">&quot;canceldelay action should only have one declared authorization&quot;</span> );</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; auth = auths[0];</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( <a class="code" href="classeosio_1_1chain_1_1authorization__manager_ae85e228f0e9419b747f1c592e6d422b1.html#ae85e228f0e9419b747f1c592e6d422b1">get_permission</a>(auth).satisfies( <a class="code" href="classeosio_1_1chain_1_1authorization__manager_ae85e228f0e9419b747f1c592e6d422b1.html#ae85e228f0e9419b747f1c592e6d422b1">get_permission</a>(cancel.canceling_auth),</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                                                  _db.get_index&lt;<a class="code" href="namespaceeosio_1_1chain_a8f2f7aceaab268a032990183a430fa4a.html#a8f2f7aceaab268a032990183a430fa4a">permission_index</a>&gt;().indices() ),</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                  irrelevant_auth_exception,</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                  <span class="stringliteral">&quot;canceldelay action declares irrelevant authority &#39;${auth}&#39;; specified authority to satisfy is ${min}&quot;</span>,</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                  (<span class="stringliteral">&quot;auth&quot;</span>, auth)(<span class="stringliteral">&quot;min&quot;</span>, cancel.canceling_auth) );</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; trx_id = cancel.trx_id;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; generated_transaction_idx = _control.<a class="code" href="classeosio_1_1chain_1_1controller_a5fa53b350eec65b6a826d039d0286440.html#a5fa53b350eec65b6a826d039d0286440">db</a>().get_index&lt;<a class="code" href="namespaceeosio_1_1chain_a113a4fa08534159756415238097d0b2b.html#a113a4fa08534159756415238097d0b2b">generated_transaction_multi_index</a>&gt;();</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; generated_index = generated_transaction_idx.indices().get&lt;by_trx_id&gt;();</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; itr = generated_index.lower_bound(trx_id);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      FC_ASSERT( itr != generated_index.end() &amp;&amp; itr-&gt;sender == <a class="code" href="namespaceeosio_1_1chain_a2106ec5ced5c780d6cbebf6a727f910c.html#a2106ec5ced5c780d6cbebf6a727f910c">account_name</a>() &amp;&amp; itr-&gt;trx_id == trx_id,</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                 <span class="stringliteral">&quot;cannot cancel trx_id=${tid}, there is no deferred transaction with that transaction id&quot;</span>,</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                 (<span class="stringliteral">&quot;tid&quot;</span>, trx_id) );</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <span class="keyword">auto</span> trx = fc::raw::unpack&lt;transaction&gt;(itr-&gt;packed_trx.data(), itr-&gt;packed_trx.size());</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; act : trx.actions ) {</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;         <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; auth : act.authorization ) {</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            <span class="keywordflow">if</span>( auth == cancel.canceling_auth ) {</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;               found = <span class="keyword">true</span>;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            }</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;         }</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;         <span class="keywordflow">if</span>( found ) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      }</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( found, <a class="code" href="namespaceeosio_1_1chain_a5c927b6a4cc85cdefe99b1a48034e584.html#a5c927b6a4cc85cdefe99b1a48034e584">action_validate_exception</a>,</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                  <span class="stringliteral">&quot;canceling_auth in canceldelay action was not found as authorization in the original delayed transaction&quot;</span> );</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <span class="keywordflow">return</span> (itr-&gt;delay_until - itr-&gt;published);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;   }</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="namespaceeosio_1_1chain_aab1fcaffb908e321c8d472c7a12faef0.html#aab1fcaffb908e321c8d472c7a12faef0">  317</a></span>&#160;   <span class="keywordtype">void</span> <a class="code" href="namespaceeosio_1_1chain_aab1fcaffb908e321c8d472c7a12faef0.html#aab1fcaffb908e321c8d472c7a12faef0">noop_checktime</a>() {}</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;   std::function&lt;void()&gt; <a class="code" href="classeosio_1_1chain_1_1authorization__manager_a51f600b9dec3e41f1eb3cf7b19a79ad6.html#a51f600b9dec3e41f1eb3cf7b19a79ad6">authorization_manager::_noop_checktime</a>{&amp;<a class="code" href="namespaceeosio_1_1chain_aab1fcaffb908e321c8d472c7a12faef0.html#aab1fcaffb908e321c8d472c7a12faef0">noop_checktime</a>};</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;   <span class="keywordtype">void</span></div><div class="line"><a name="l00322"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1authorization__manager_ae925415529209b8f0ef9987479a866b5.html#ae925415529209b8f0ef9987479a866b5">  322</a></span>&#160;   <a class="code" href="classeosio_1_1chain_1_1authorization__manager_ae925415529209b8f0ef9987479a866b5.html#ae925415529209b8f0ef9987479a866b5">authorization_manager::check_authorization</a>( <span class="keyword">const</span> vector&lt;action&gt;&amp;                actions,</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                                               <span class="keyword">const</span> flat_set&lt;public_key_type&gt;&amp;     provided_keys,</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                                               <span class="keyword">const</span> flat_set&lt;permission_level&gt;&amp;    provided_permissions,</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                                               fc::microseconds                     provided_delay,</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                                               <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>()&gt;&amp;         _checktime,</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                                               <span class="keywordtype">bool</span>                                 allow_unused_keys</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                                             )<span class="keyword">const</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="keyword">   </span>{</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; checktime = ( <span class="keyword">static_cast&lt;</span><span class="keywordtype">bool</span><span class="keyword">&gt;</span>(_checktime) ? _checktime : <a class="code" href="classeosio_1_1chain_1_1authorization__manager_a51f600b9dec3e41f1eb3cf7b19a79ad6.html#a51f600b9dec3e41f1eb3cf7b19a79ad6">_noop_checktime</a> );</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="keyword">auto</span> delay_max_limit = fc::seconds( _control.<a class="code" href="classeosio_1_1chain_1_1controller_a826f8feab4d745ad1ae6ce3daff85774.html#a826f8feab4d745ad1ae6ce3daff85774">get_global_properties</a>().configuration.<a class="code" href="structeosio_1_1chain_1_1chain__config_a09db09cb0c3030af4c08d4b8ad45fbc4.html#a09db09cb0c3030af4c08d4b8ad45fbc4">max_transaction_delay</a> );</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="keyword">auto</span> effective_provided_delay =  (provided_delay &gt;= delay_max_limit) ? fc::microseconds::maximum() : provided_delay;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <span class="keyword">auto</span> checker = <a class="code" href="namespaceeosio_1_1chain_a2a00d1d124350ea613f8e71b25e651dc.html#a2a00d1d124350ea613f8e71b25e651dc">make_auth_checker</a>( [&amp;](<span class="keyword">const</span> <a class="code" href="structeosio_1_1chain_1_1permission__level.html">permission_level</a>&amp; p){ <span class="keywordflow">return</span> <a class="code" href="classeosio_1_1chain_1_1authorization__manager_ae85e228f0e9419b747f1c592e6d422b1.html#ae85e228f0e9419b747f1c592e6d422b1">get_permission</a>(p).auth; },</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                                        _control.<a class="code" href="classeosio_1_1chain_1_1controller_a826f8feab4d745ad1ae6ce3daff85774.html#a826f8feab4d745ad1ae6ce3daff85774">get_global_properties</a>().configuration.<a class="code" href="structeosio_1_1chain_1_1chain__config_a1c625b0b7e7baef8c8e0440374ae4938.html#a1c625b0b7e7baef8c8e0440374ae4938">max_authority_depth</a>,</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                                        provided_keys,</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                                        provided_permissions,</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                                        effective_provided_delay,</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                                        checktime</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                                      );</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      map&lt;permission_level, fc::microseconds&gt; permissions_to_satisfy;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; act : actions ) {</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;         <span class="keywordtype">bool</span> special_case = <span class="keyword">false</span>;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;         fc::microseconds delay = effective_provided_delay;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;         <span class="keywordflow">if</span>( act.account == config::system_account_name ) {</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            special_case = <span class="keyword">true</span>;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="keywordflow">if</span>( act.name == <a class="code" href="structeosio_1_1chain_1_1updateauth_ad5f94b0b8b12b0e6af3343e9de2785a1.html#ad5f94b0b8b12b0e6af3343e9de2785a1">updateauth::get_name</a>() ) {</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;               check_updateauth_authorization( act.data_as&lt;<a class="code" href="structeosio_1_1chain_1_1updateauth.html">updateauth</a>&gt;(), act.authorization );</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( act.name == <a class="code" href="structeosio_1_1chain_1_1deleteauth_aee35011bcdc77db217f3aefa55cd3825.html#aee35011bcdc77db217f3aefa55cd3825">deleteauth::get_name</a>() ) {</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;               check_deleteauth_authorization( act.data_as&lt;<a class="code" href="structeosio_1_1chain_1_1deleteauth.html">deleteauth</a>&gt;(), act.authorization );</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( act.name == <a class="code" href="structeosio_1_1chain_1_1linkauth_af6700bc07612af4bfc68ed8ae983dd5d.html#af6700bc07612af4bfc68ed8ae983dd5d">linkauth::get_name</a>() ) {</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;               check_linkauth_authorization( act.data_as&lt;<a class="code" href="structeosio_1_1chain_1_1linkauth.html">linkauth</a>&gt;(), act.authorization );</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( act.name == <a class="code" href="structeosio_1_1chain_1_1unlinkauth_adc8f3b48fa1b32191511131e6b2ad3b5.html#adc8f3b48fa1b32191511131e6b2ad3b5">unlinkauth::get_name</a>() ) {</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;               check_unlinkauth_authorization( act.data_as&lt;<a class="code" href="structeosio_1_1chain_1_1unlinkauth.html">unlinkauth</a>&gt;(), act.authorization );</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( act.name ==  <a class="code" href="structeosio_1_1chain_1_1canceldelay_a62e317132e2afb4c99a3aa872d98efdd.html#a62e317132e2afb4c99a3aa872d98efdd">canceldelay::get_name</a>() ) {</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;               delay = std::max( delay, check_canceldelay_authorization(act.data_as&lt;<a class="code" href="structeosio_1_1chain_1_1canceldelay.html">canceldelay</a>&gt;(), act.authorization) );</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;               special_case = <span class="keyword">false</span>;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            }</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;         }</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;         <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; declared_auth : act.authorization ) {</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            checktime();</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            <span class="keywordflow">if</span>( !special_case ) {</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;               <span class="keyword">auto</span> min_permission_name = <a class="code" href="classeosio_1_1chain_1_1authorization__manager_a90ff596e8f43e56adce58888f5b9cdbe.html#a90ff596e8f43e56adce58888f5b9cdbe">lookup_minimum_permission</a>(declared_auth.actor, act.account, act.name);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;               <span class="keywordflow">if</span>( min_permission_name ) { <span class="comment">// since special cases were already handled, it should only be false if the permission is eosio.any</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; min_permission = <a class="code" href="classeosio_1_1chain_1_1authorization__manager_ae85e228f0e9419b747f1c592e6d422b1.html#ae85e228f0e9419b747f1c592e6d422b1">get_permission</a>({declared_auth.actor, *min_permission_name});</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                  <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( <a class="code" href="classeosio_1_1chain_1_1authorization__manager_ae85e228f0e9419b747f1c592e6d422b1.html#ae85e228f0e9419b747f1c592e6d422b1">get_permission</a>(declared_auth).satisfies( min_permission,</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                                                                       _db.get_index&lt;<a class="code" href="namespaceeosio_1_1chain_a8f2f7aceaab268a032990183a430fa4a.html#a8f2f7aceaab268a032990183a430fa4a">permission_index</a>&gt;().indices() ),</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                              irrelevant_auth_exception,</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                              <span class="stringliteral">&quot;action declares irrelevant authority &#39;${auth}&#39;; minimum authority is ${min}&quot;</span>,</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                              (<span class="stringliteral">&quot;auth&quot;</span>, declared_auth)(<span class="stringliteral">&quot;min&quot;</span>, <a class="code" href="structeosio_1_1chain_1_1permission__level.html">permission_level</a>{min_permission.owner, min_permission.name}) );</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;               }</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            }</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            <span class="keyword">auto</span> res = permissions_to_satisfy.emplace( declared_auth, delay );</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            <span class="keywordflow">if</span>( !res.second &amp;&amp; res.first-&gt;second &gt; delay) { <span class="comment">// if the declared_auth was already in the map and with a higher delay</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;               res.first-&gt;second = delay;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            }</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;         }</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      }</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <span class="comment">// Now verify that all the declared authorizations are satisfied:</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <span class="comment">// Although this can be made parallel (especially for input transactions) with the optimistic assumption that the</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      <span class="comment">// CPU limit is not reached, because of the CPU limit the protocol must officially specify a sequential algorithm</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <span class="comment">// for checking the set of declared authorizations.</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <span class="comment">// The permission_levels are traversed in ascending order, which is:</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      <span class="comment">// ascending order of the actor name with ties broken by ascending order of the permission name.</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : permissions_to_satisfy ) {</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;         checktime(); <span class="comment">// TODO: this should eventually move into authority_checker instead</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;         <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( checker.satisfied( p.first, p.second ), unsatisfied_authorization,</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                     <span class="stringliteral">&quot;transaction declares authority &#39;${auth}&#39;, &quot;</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                     <span class="stringliteral">&quot;but does not have signatures for it under a provided delay of ${provided_delay} ms&quot;</span>,</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                     (<span class="stringliteral">&quot;auth&quot;</span>, p.first)(<span class="stringliteral">&quot;provided_delay&quot;</span>, provided_delay.count()/1000)</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                     (<span class="stringliteral">&quot;delay_max_limit_ms&quot;</span>, delay_max_limit.count()/1000)</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                   );</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      }</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <span class="keywordflow">if</span>( !allow_unused_keys ) {</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;         <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( checker.all_keys_used(), tx_irrelevant_sig,</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                     <span class="stringliteral">&quot;transaction bears irrelevant signatures from these keys: ${keys}&quot;</span>,</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                     (<span class="stringliteral">&quot;keys&quot;</span>, checker.unused_keys()) );</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      }</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;   }</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;   <span class="keywordtype">void</span></div><div class="line"><a name="l00417"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1authorization__manager_a5c4060e59ce07ea58900091fc941363a.html#a5c4060e59ce07ea58900091fc941363a">  417</a></span>&#160;   <a class="code" href="classeosio_1_1chain_1_1authorization__manager_ae925415529209b8f0ef9987479a866b5.html#ae925415529209b8f0ef9987479a866b5">authorization_manager::check_authorization</a>( <a class="code" href="structeosio_1_1chain_1_1name.html">account_name</a>                         account,</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                                               <a class="code" href="structeosio_1_1chain_1_1name.html">permission_name</a>                      permission,</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                                               <span class="keyword">const</span> flat_set&lt;public_key_type&gt;&amp;     provided_keys,</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                                               <span class="keyword">const</span> flat_set&lt;permission_level&gt;&amp;    provided_permissions,</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                                               fc::microseconds                     provided_delay,</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                                               <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>()&gt;&amp;         _checktime,</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                                               <span class="keywordtype">bool</span>                                 allow_unused_keys</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                                             )<span class="keyword">const</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="keyword">   </span>{</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; checktime = ( <span class="keyword">static_cast&lt;</span><span class="keywordtype">bool</span><span class="keyword">&gt;</span>(_checktime) ? _checktime : <a class="code" href="classeosio_1_1chain_1_1authorization__manager_a51f600b9dec3e41f1eb3cf7b19a79ad6.html#a51f600b9dec3e41f1eb3cf7b19a79ad6">_noop_checktime</a> );</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      <span class="keyword">auto</span> delay_max_limit = fc::seconds( _control.<a class="code" href="classeosio_1_1chain_1_1controller_a826f8feab4d745ad1ae6ce3daff85774.html#a826f8feab4d745ad1ae6ce3daff85774">get_global_properties</a>().configuration.<a class="code" href="structeosio_1_1chain_1_1chain__config_a09db09cb0c3030af4c08d4b8ad45fbc4.html#a09db09cb0c3030af4c08d4b8ad45fbc4">max_transaction_delay</a> );</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <span class="keyword">auto</span> checker = <a class="code" href="namespaceeosio_1_1chain_a2a00d1d124350ea613f8e71b25e651dc.html#a2a00d1d124350ea613f8e71b25e651dc">make_auth_checker</a>( [&amp;](<span class="keyword">const</span> <a class="code" href="structeosio_1_1chain_1_1permission__level.html">permission_level</a>&amp; p){ <span class="keywordflow">return</span> <a class="code" href="classeosio_1_1chain_1_1authorization__manager_ae85e228f0e9419b747f1c592e6d422b1.html#ae85e228f0e9419b747f1c592e6d422b1">get_permission</a>(p).auth; },</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                                        _control.<a class="code" href="classeosio_1_1chain_1_1controller_a826f8feab4d745ad1ae6ce3daff85774.html#a826f8feab4d745ad1ae6ce3daff85774">get_global_properties</a>().configuration.<a class="code" href="structeosio_1_1chain_1_1chain__config_a1c625b0b7e7baef8c8e0440374ae4938.html#a1c625b0b7e7baef8c8e0440374ae4938">max_authority_depth</a>,</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                                        provided_keys,</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                                        provided_permissions,</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                                        ( provided_delay &gt;= delay_max_limit ) ? fc::microseconds::maximum() : provided_delay,</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                                        checktime</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                                      );</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( checker.satisfied({account, permission}), unsatisfied_authorization,</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                  <span class="stringliteral">&quot;permission &#39;${auth}&#39; was not satisfied under a provided delay of ${provided_delay} ms&quot;</span>,</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                  (<span class="stringliteral">&quot;auth&quot;</span>, <a class="code" href="structeosio_1_1chain_1_1permission__level.html">permission_level</a>{account, permission})(<span class="stringliteral">&quot;provided_delay&quot;</span>, provided_delay.count()/1000) );</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <span class="keywordflow">if</span>( !allow_unused_keys ) {</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;         <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( checker.all_keys_used(), tx_irrelevant_sig,</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                     <span class="stringliteral">&quot;irrelevant keys provided: ${keys}&quot;</span>,</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                     (<span class="stringliteral">&quot;keys&quot;</span>, checker.unused_keys()) );</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      }</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;   }</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1authorization__manager_a88f12b737be4118601b8ff411640039d.html#a88f12b737be4118601b8ff411640039d">  449</a></span>&#160;   flat_set&lt;public_key_type&gt; <a class="code" href="classeosio_1_1chain_1_1authorization__manager_a88f12b737be4118601b8ff411640039d.html#a88f12b737be4118601b8ff411640039d">authorization_manager::get_required_keys</a>( <span class="keyword">const</span> <a class="code" href="structeosio_1_1chain_1_1transaction.html">transaction</a>&amp; trx,</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                                                                       <span class="keyword">const</span> flat_set&lt;public_key_type&gt;&amp; candidate_keys,</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                                                                       fc::microseconds provided_delay</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                                                                     )<span class="keyword">const</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="keyword">   </span>{</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      <span class="keyword">auto</span> checker = <a class="code" href="namespaceeosio_1_1chain_a2a00d1d124350ea613f8e71b25e651dc.html#a2a00d1d124350ea613f8e71b25e651dc">make_auth_checker</a>( [&amp;](<span class="keyword">const</span> <a class="code" href="structeosio_1_1chain_1_1permission__level.html">permission_level</a>&amp; p){ <span class="keywordflow">return</span> <a class="code" href="classeosio_1_1chain_1_1authorization__manager_ae85e228f0e9419b747f1c592e6d422b1.html#ae85e228f0e9419b747f1c592e6d422b1">get_permission</a>(p).auth; },</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                                        _control.<a class="code" href="classeosio_1_1chain_1_1controller_a826f8feab4d745ad1ae6ce3daff85774.html#a826f8feab4d745ad1ae6ce3daff85774">get_global_properties</a>().configuration.<a class="code" href="structeosio_1_1chain_1_1chain__config_a1c625b0b7e7baef8c8e0440374ae4938.html#a1c625b0b7e7baef8c8e0440374ae4938">max_authority_depth</a>,</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                                        candidate_keys,</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                                        {},</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                                        provided_delay,</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                                        <a class="code" href="classeosio_1_1chain_1_1authorization__manager_a51f600b9dec3e41f1eb3cf7b19a79ad6.html#a51f600b9dec3e41f1eb3cf7b19a79ad6">_noop_checktime</a></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                                      );</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; act : trx.<a class="code" href="structeosio_1_1chain_1_1transaction_a768465b5929ca1291b303294f353b1c5.html#a768465b5929ca1291b303294f353b1c5">actions</a> ) {</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;         <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; declared_auth : act.authorization) {</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( checker.satisfied(declared_auth), unsatisfied_authorization,</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                        <span class="stringliteral">&quot;transaction declares authority &#39;${auth}&#39;, but does not have signatures for it.&quot;</span>,</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                        (<span class="stringliteral">&quot;auth&quot;</span>, declared_auth) );</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;         }</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      }</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <span class="keywordflow">return</span> checker.used_keys();</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;   }</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;} } </div><div class="ttc" id="classeosio_1_1chain_1_1authorization__manager_ad1f330edc0e8067d0118657da09f5994_html_ad1f330edc0e8067d0118657da09f5994"><div class="ttname"><a href="classeosio_1_1chain_1_1authorization__manager_ad1f330edc0e8067d0118657da09f5994.html#ad1f330edc0e8067d0118657da09f5994">eosio::chain::authorization_manager::initialize_database</a></div><div class="ttdeci">void initialize_database()</div><div class="ttdef"><b>Definition:</b> <a href="authorization__manager_8cpp_source.html#l00027">authorization_manager.cpp:27</a></div></div>
<div class="ttc" id="namespaceeosio_html"><div class="ttname"><a href="namespaceeosio.html">eosio</a></div><div class="ttdef"><b>Definition:</b> <a href="abi__serializer_8cpp_source.html#l00017">abi_serializer.cpp:17</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1authorization__manager_a88f12b737be4118601b8ff411640039d_html_a88f12b737be4118601b8ff411640039d"><div class="ttname"><a href="classeosio_1_1chain_1_1authorization__manager_a88f12b737be4118601b8ff411640039d.html#a88f12b737be4118601b8ff411640039d">eosio::chain::authorization_manager::get_required_keys</a></div><div class="ttdeci">flat_set&lt; public_key_type &gt; get_required_keys(const transaction &amp;trx, const flat_set&lt; public_key_type &gt; &amp;candidate_keys, fc::microseconds provided_delay=fc::microseconds(0)) const</div><div class="ttdef"><b>Definition:</b> <a href="authorization__manager_8cpp_source.html#l00449">authorization_manager.cpp:449</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1authorization__manager_ae925415529209b8f0ef9987479a866b5_html_ae925415529209b8f0ef9987479a866b5"><div class="ttname"><a href="classeosio_1_1chain_1_1authorization__manager_ae925415529209b8f0ef9987479a866b5.html#ae925415529209b8f0ef9987479a866b5">eosio::chain::authorization_manager::check_authorization</a></div><div class="ttdeci">void check_authorization(const vector&lt; action &gt; &amp;actions, const flat_set&lt; public_key_type &gt; &amp;provided_keys, const flat_set&lt; permission_level &gt; &amp;provided_permissions=flat_set&lt; permission_level &gt;(), fc::microseconds provided_delay=fc::microseconds(0), const std::function&lt; void()&gt; &amp;checktime=std::function&lt; void()&gt;(), bool allow_unused_keys=false) const</div><div class="ttdoc">Check authorizations of a vector of actions with provided keys, permission levels, and delay. </div><div class="ttdef"><b>Definition:</b> <a href="authorization__manager_8cpp_source.html#l00322">authorization_manager.cpp:322</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1updateauth_a24d1511732ae261a3212e8b2cb85d29f_html_a24d1511732ae261a3212e8b2cb85d29f"><div class="ttname"><a href="structeosio_1_1chain_1_1updateauth_a24d1511732ae261a3212e8b2cb85d29f.html#a24d1511732ae261a3212e8b2cb85d29f">eosio::chain::updateauth::account</a></div><div class="ttdeci">account_name account</div><div class="ttdef"><b>Definition:</b> <a href="contract__types_8hpp_source.html#l00057">contract_types.hpp:57</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_afb4a1df1715a88764f246867c5d32796_html_afb4a1df1715a88764f246867c5d32796"><div class="ttname"><a href="namespaceeosio_1_1chain_afb4a1df1715a88764f246867c5d32796.html#afb4a1df1715a88764f246867c5d32796">eosio::chain::action_name</a></div><div class="ttdeci">eosio::chain::action_name action_name</div><div class="ttdef"><b>Definition:</b> <a href="contract__types_8hpp_source.html#l00010">contract_types.hpp:10</a></div></div>
<div class="ttc" id="permission__object_8hpp_html"><div class="ttname"><a href="permission__object_8hpp.html">permission_object.hpp</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1authorization__manager_a90ff596e8f43e56adce58888f5b9cdbe_html_a90ff596e8f43e56adce58888f5b9cdbe"><div class="ttname"><a href="classeosio_1_1chain_1_1authorization__manager_a90ff596e8f43e56adce58888f5b9cdbe.html#a90ff596e8f43e56adce58888f5b9cdbe">eosio::chain::authorization_manager::lookup_minimum_permission</a></div><div class="ttdeci">optional&lt; permission_name &gt; lookup_minimum_permission(account_name authorizer_account, scope_name code_account, action_name type) const</div><div class="ttdoc">Find the lowest authority level required for authorizer_account to authorize a message of the specifi...</div><div class="ttdef"><b>Definition:</b> <a href="authorization__manager_8cpp_source.html#l00150">authorization_manager.cpp:150</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1unlinkauth_html"><div class="ttname"><a href="structeosio_1_1chain_1_1unlinkauth.html">eosio::chain::unlinkauth</a></div><div class="ttdef"><b>Definition:</b> <a href="contract__types_8hpp_source.html#l00109">contract_types.hpp:109</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_aab1fcaffb908e321c8d472c7a12faef0_html_aab1fcaffb908e321c8d472c7a12faef0"><div class="ttname"><a href="namespaceeosio_1_1chain_aab1fcaffb908e321c8d472c7a12faef0.html#aab1fcaffb908e321c8d472c7a12faef0">eosio::chain::noop_checktime</a></div><div class="ttdeci">void noop_checktime()</div><div class="ttdef"><b>Definition:</b> <a href="authorization__manager_8cpp_source.html#l00317">authorization_manager.cpp:317</a></div></div>
<div class="ttc" id="exceptions_8hpp_html"><div class="ttname"><a href="exceptions_8hpp.html">exceptions.hpp</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1name_a9bf42b486a3bb938fc5cfaf1af8345d7_html_a9bf42b486a3bb938fc5cfaf1af8345d7"><div class="ttname"><a href="structeosio_1_1chain_1_1name_a9bf42b486a3bb938fc5cfaf1af8345d7.html#a9bf42b486a3bb938fc5cfaf1af8345d7">eosio::chain::name::empty</a></div><div class="ttdeci">bool empty() const</div><div class="ttdef"><b>Definition:</b> <a href="name_8hpp_source.html#l00044">name.hpp:44</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1name_a2791ae46649a1dada298257d5c321fb8_html_a2791ae46649a1dada298257d5c321fb8"><div class="ttname"><a href="structeosio_1_1chain_1_1name_a2791ae46649a1dada298257d5c321fb8.html#a2791ae46649a1dada298257d5c321fb8">eosio::chain::name::name</a></div><div class="ttdeci">name(const char *str)</div><div class="ttdef"><b>Definition:</b> <a href="name_8hpp_source.html#l00047">name.hpp:47</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1transaction_a768465b5929ca1291b303294f353b1c5_html_a768465b5929ca1291b303294f353b1c5"><div class="ttname"><a href="structeosio_1_1chain_1_1transaction_a768465b5929ca1291b303294f353b1c5.html#a768465b5929ca1291b303294f353b1c5">eosio::chain::transaction::actions</a></div><div class="ttdeci">vector&lt; action &gt; actions</div><div class="ttdef"><b>Definition:</b> <a href="transaction_8hpp_source.html#l00056">transaction.hpp:56</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1permission__level_html"><div class="ttname"><a href="structeosio_1_1chain_1_1permission__level.html">eosio::chain::permission_level</a></div><div class="ttdef"><b>Definition:</b> <a href="action_8hpp_source.html#l00011">action.hpp:11</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1canceldelay_html"><div class="ttname"><a href="structeosio_1_1chain_1_1canceldelay.html">eosio::chain::canceldelay</a></div><div class="ttdef"><b>Definition:</b> <a href="contract__types_8hpp_source.html#l00128">contract_types.hpp:128</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_a675086138c644442ef3a084e027a7d5a_html_a675086138c644442ef3a084e027a7d5a"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_a675086138c644442ef3a084e027a7d5a.html#a675086138c644442ef3a084e027a7d5a">eosio::chain::controller::pending_block_time</a></div><div class="ttdeci">time_point pending_block_time() const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01216">controller.cpp:1216</a></div></div>
<div class="ttc" id="global__property__object_8hpp_html"><div class="ttname"><a href="global__property__object_8hpp.html">global_property_object.hpp</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1authorization__manager_abd4544d87930617c51d39c394058c329_html_abd4544d87930617c51d39c394058c329"><div class="ttname"><a href="classeosio_1_1chain_1_1authorization__manager_abd4544d87930617c51d39c394058c329.html#abd4544d87930617c51d39c394058c329">eosio::chain::authorization_manager::get_permission_last_used</a></div><div class="ttdeci">fc::time_point get_permission_last_used(const permission_object &amp;permission) const</div><div class="ttdef"><b>Definition:</b> <a href="authorization__manager_8cpp_source.html#l00109">authorization_manager.cpp:109</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1permission__level_af2ed5aef662fd4dd82bfac8314c54512_html_af2ed5aef662fd4dd82bfac8314c54512"><div class="ttname"><a href="structeosio_1_1chain_1_1permission__level_af2ed5aef662fd4dd82bfac8314c54512.html#af2ed5aef662fd4dd82bfac8314c54512">eosio::chain::permission_level::permission</a></div><div class="ttdeci">permission_name permission</div><div class="ttdef"><b>Definition:</b> <a href="action_8hpp_source.html#l00013">action.hpp:13</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1authorization__manager_ac2d8460231201d7555c7dbb37fda47c1_html_ac2d8460231201d7555c7dbb37fda47c1"><div class="ttname"><a href="classeosio_1_1chain_1_1authorization__manager_ac2d8460231201d7555c7dbb37fda47c1.html#ac2d8460231201d7555c7dbb37fda47c1">eosio::chain::authorization_manager::permission_id_type</a></div><div class="ttdeci">permission_object::id_type permission_id_type</div><div class="ttdef"><b>Definition:</b> <a href="authorization__manager_8hpp_source.html#l00024">authorization_manager.hpp:24</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1permission__link__object_html"><div class="ttname"><a href="classeosio_1_1chain_1_1permission__link__object.html">eosio::chain::permission_link_object</a></div><div class="ttdoc">The permission_link_object class assigns permission_objects to message types. </div><div class="ttdef"><b>Definition:</b> <a href="permission__link__object_8hpp_source.html#l00030">permission_link_object.hpp:30</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1updateauth_a6e86407d83b12428e07de8441a2a315b_html_a6e86407d83b12428e07de8441a2a315b"><div class="ttname"><a href="structeosio_1_1chain_1_1updateauth_a6e86407d83b12428e07de8441a2a315b.html#a6e86407d83b12428e07de8441a2a315b">eosio::chain::updateauth::parent</a></div><div class="ttdeci">permission_name parent</div><div class="ttdef"><b>Definition:</b> <a href="contract__types_8hpp_source.html#l00059">contract_types.hpp:59</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_a5c927b6a4cc85cdefe99b1a48034e584_html_a5c927b6a4cc85cdefe99b1a48034e584"><div class="ttname"><a href="namespaceeosio_1_1chain_a5c927b6a4cc85cdefe99b1a48034e584.html#a5c927b6a4cc85cdefe99b1a48034e584">eosio::chain::action_validate_exception</a></div><div class="ttdeci">chain type exception Invalid public key Invalid authority Invalid transaction No ABI found Invalid transaction ID Invalid asset unlinkable block transaction outputs in block do not match transaction outputs from applying block shard locks in block are incorrect or mal formed block is too old to push Error decompressing transaction transaction should have at least one required authority Expired Transaction Invalid Reference Block duplicate deferred transaction action_validate_exception</div><div class="ttdef"><b>Definition:</b> <a href="exceptions_8hpp_source.html#l00168">exceptions.hpp:168</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1authorization__manager_ae85e228f0e9419b747f1c592e6d422b1_html_ae85e228f0e9419b747f1c592e6d422b1"><div class="ttname"><a href="classeosio_1_1chain_1_1authorization__manager_ae85e228f0e9419b747f1c592e6d422b1.html#ae85e228f0e9419b747f1c592e6d422b1">eosio::chain::authorization_manager::get_permission</a></div><div class="ttdeci">const permission_object &amp; get_permission(const permission_level &amp;level) const</div><div class="ttdef"><b>Definition:</b> <a href="authorization__manager_8cpp_source.html#l00119">authorization_manager.cpp:119</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1updateauth_ad5f94b0b8b12b0e6af3343e9de2785a1_html_ad5f94b0b8b12b0e6af3343e9de2785a1"><div class="ttname"><a href="structeosio_1_1chain_1_1updateauth_ad5f94b0b8b12b0e6af3343e9de2785a1.html#ad5f94b0b8b12b0e6af3343e9de2785a1">eosio::chain::updateauth::get_name</a></div><div class="ttdeci">static action_name get_name()</div><div class="ttdef"><b>Definition:</b> <a href="contract__types_8hpp_source.html#l00066">contract_types.hpp:66</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1authorization__manager_af81cfb509b0a2317a79f69d170dbadb3_html_af81cfb509b0a2317a79f69d170dbadb3"><div class="ttname"><a href="classeosio_1_1chain_1_1authorization__manager_af81cfb509b0a2317a79f69d170dbadb3.html#af81cfb509b0a2317a79f69d170dbadb3">eosio::chain::authorization_manager::add_indices</a></div><div class="ttdeci">void add_indices()</div><div class="ttdef"><b>Definition:</b> <a href="authorization__manager_8cpp_source.html#l00021">authorization_manager.cpp:21</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1chain__config_a1c625b0b7e7baef8c8e0440374ae4938_html_a1c625b0b7e7baef8c8e0440374ae4938"><div class="ttname"><a href="structeosio_1_1chain_1_1chain__config_a1c625b0b7e7baef8c8e0440374ae4938.html#a1c625b0b7e7baef8c8e0440374ae4938">eosio::chain::chain_config::max_authority_depth</a></div><div class="ttdeci">uint16_t max_authority_depth</div><div class="ttdoc">recursion depth limit for checking if an authority is satisfied </div><div class="ttdef"><b>Definition:</b> <a href="chain__config_8hpp_source.html#l00038">chain_config.hpp:38</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1linkauth_html"><div class="ttname"><a href="structeosio_1_1chain_1_1linkauth.html">eosio::chain::linkauth</a></div><div class="ttdef"><b>Definition:</b> <a href="contract__types_8hpp_source.html#l00089">contract_types.hpp:89</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1authorization__manager_a51f600b9dec3e41f1eb3cf7b19a79ad6_html_a51f600b9dec3e41f1eb3cf7b19a79ad6"><div class="ttname"><a href="classeosio_1_1chain_1_1authorization__manager_a51f600b9dec3e41f1eb3cf7b19a79ad6.html#a51f600b9dec3e41f1eb3cf7b19a79ad6">eosio::chain::authorization_manager::_noop_checktime</a></div><div class="ttdeci">static std::function&lt; void()&gt; _noop_checktime</div><div class="ttdef"><b>Definition:</b> <a href="authorization__manager_8hpp_source.html#l00115">authorization_manager.hpp:115</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1permission__usage__object_html"><div class="ttname"><a href="classeosio_1_1chain_1_1permission__usage__object.html">eosio::chain::permission_usage_object</a></div><div class="ttdef"><b>Definition:</b> <a href="permission__object_8hpp_source.html#l00012">permission_object.hpp:12</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1authorization__manager_a27421e55aa9490ec47637535be08eed5_html_a27421e55aa9490ec47637535be08eed5"><div class="ttname"><a href="classeosio_1_1chain_1_1authorization__manager_a27421e55aa9490ec47637535be08eed5.html#a27421e55aa9490ec47637535be08eed5">eosio::chain::authorization_manager::find_permission</a></div><div class="ttdeci">const permission_object * find_permission(const permission_level &amp;level) const</div><div class="ttdef"><b>Definition:</b> <a href="authorization__manager_8cpp_source.html#l00113">authorization_manager.cpp:113</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_a2a00d1d124350ea613f8e71b25e651dc_html_a2a00d1d124350ea613f8e71b25e651dc"><div class="ttname"><a href="namespaceeosio_1_1chain_a2a00d1d124350ea613f8e71b25e651dc.html#a2a00d1d124350ea613f8e71b25e651dc">eosio::chain::make_auth_checker</a></div><div class="ttdeci">auto make_auth_checker(PermissionToAuthorityFunc &amp;&amp;pta, uint16_t recursion_depth_limit, const flat_set&lt; public_key_type &gt; &amp;provided_keys, const flat_set&lt; permission_level &gt; &amp;provided_permissions=flat_set&lt; permission_level &gt;(), fc::microseconds provided_delay=fc::microseconds(0), const std::function&lt; void()&gt; &amp;_checktime=std::function&lt; void()&gt;())</div><div class="ttdoc">authority_checker </div><div class="ttdef"><b>Definition:</b> <a href="authority__checker_8hpp_source.html#l00275">authority_checker.hpp:275</a></div></div>
<div class="ttc" id="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16_html_a2cb5d7112457a24df46ffcd923270e16"><div class="ttname"><a href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a></div><div class="ttdeci">#define EOS_ASSERT(expr, exc_type, FORMAT,...)</div><div class="ttdef"><b>Definition:</b> <a href="exceptions_8hpp_source.html#l00012">exceptions.hpp:12</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1updateauth_aa8c084d97749320027bb1207832ff073_html_aa8c084d97749320027bb1207832ff073"><div class="ttname"><a href="structeosio_1_1chain_1_1updateauth_aa8c084d97749320027bb1207832ff073.html#aa8c084d97749320027bb1207832ff073">eosio::chain::updateauth::permission</a></div><div class="ttdeci">permission_name permission</div><div class="ttdef"><b>Definition:</b> <a href="contract__types_8hpp_source.html#l00058">contract_types.hpp:58</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_a826f8feab4d745ad1ae6ce3daff85774_html_a826f8feab4d745ad1ae6ce3daff85774"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_a826f8feab4d745ad1ae6ce3daff85774.html#a826f8feab4d745ad1ae6ce3daff85774">eosio::chain::controller::get_global_properties</a></div><div class="ttdeci">const global_property_object &amp; get_global_properties() const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01239">controller.cpp:1239</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1authorization__manager_a04d6fcf78bac06011bf471ec7e85aca1_html_a04d6fcf78bac06011bf471ec7e85aca1"><div class="ttname"><a href="classeosio_1_1chain_1_1authorization__manager_a04d6fcf78bac06011bf471ec7e85aca1.html#a04d6fcf78bac06011bf471ec7e85aca1">eosio::chain::authorization_manager::authorization_manager</a></div><div class="ttdeci">authorization_manager(controller &amp;c, chainbase::database &amp;d)</div><div class="ttdef"><b>Definition:</b> <a href="authorization__manager_8cpp_source.html#l00018">authorization_manager.cpp:18</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_ad6e015097a10f08028a3e3df3b17ecdf_html_ad6e015097a10f08028a3e3df3b17ecdf"><div class="ttname"><a href="namespaceeosio_1_1chain_ad6e015097a10f08028a3e3df3b17ecdf.html#ad6e015097a10f08028a3e3df3b17ecdf">eosio::chain::transaction_exception</a></div><div class="ttdeci">chain type exception Invalid public key Invalid authority Invalid transaction No ABI found Invalid transaction ID Invalid asset unlinkable block transaction outputs in block do not match transaction outputs from applying block shard locks in block are incorrect or mal formed block is too old to push transaction_exception</div><div class="ttdef"><b>Definition:</b> <a href="exceptions_8hpp_source.html#l00145">exceptions.hpp:145</a></div></div>
<div class="ttc" id="contract__types_8hpp_html"><div class="ttname"><a href="contract__types_8hpp.html">contract_types.hpp</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1permission__level_a2be46de0b7cb1dd3802b62792b2c80ce_html_a2be46de0b7cb1dd3802b62792b2c80ce"><div class="ttname"><a href="structeosio_1_1chain_1_1permission__level_a2be46de0b7cb1dd3802b62792b2c80ce.html#a2be46de0b7cb1dd3802b62792b2c80ce">eosio::chain::permission_level::actor</a></div><div class="ttdeci">account_name actor</div><div class="ttdef"><b>Definition:</b> <a href="action_8hpp_source.html#l00012">action.hpp:12</a></div></div>
<div class="ttc" id="authorization__manager_8hpp_html"><div class="ttname"><a href="authorization__manager_8hpp.html">authorization_manager.hpp</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_a8cc2780bda427e8aca0680bc9c1cbda2_html_a8cc2780bda427e8aca0680bc9c1cbda2"><div class="ttname"><a href="namespaceeosio_1_1chain_a8cc2780bda427e8aca0680bc9c1cbda2.html#a8cc2780bda427e8aca0680bc9c1cbda2">eosio::chain::permission_link_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; permission_link_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, &gt;, ordered_unique&lt; tag&lt; by_action_name &gt;, composite_key&lt; permission_link_object, BOOST_MULTI_INDEX_MEMBER(permission_link_object, account_name, account), BOOST_MULTI_INDEX_MEMBER(permission_link_object, account_name, code), &gt; &gt;, ordered_unique&lt; tag&lt; by_permission_name &gt;, composite_key&lt; permission_link_object, BOOST_MULTI_INDEX_MEMBER(permission_link_object, account_name, account), BOOST_MULTI_INDEX_MEMBER(permission_link_object, permission_name, required_permission), BOOST_MULTI_INDEX_MEMBER(permission_link_object, account_name, code), &gt; &gt; &gt; &gt; permission_link_index</div><div class="ttdef"><b>Definition:</b> <a href="permission__link__object_8hpp_source.html#l00069">permission_link_object.hpp:69</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1canceldelay_a62e317132e2afb4c99a3aa872d98efdd_html_a62e317132e2afb4c99a3aa872d98efdd"><div class="ttname"><a href="structeosio_1_1chain_1_1canceldelay_a62e317132e2afb4c99a3aa872d98efdd.html#a62e317132e2afb4c99a3aa872d98efdd">eosio::chain::canceldelay::get_name</a></div><div class="ttdeci">static action_name get_name()</div><div class="ttdef"><b>Definition:</b> <a href="contract__types_8hpp_source.html#l00136">contract_types.hpp:136</a></div></div>
<div class="ttc" id="authority__checker_8hpp_html"><div class="ttname"><a href="authority__checker_8hpp.html">authority_checker.hpp</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1name_html"><div class="ttname"><a href="structeosio_1_1chain_1_1name.html">eosio::chain::name</a></div><div class="ttdef"><b>Definition:</b> <a href="name_8hpp_source.html#l00042">name.hpp:42</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_a8f2f7aceaab268a032990183a430fa4a_html_a8f2f7aceaab268a032990183a430fa4a"><div class="ttname"><a href="namespaceeosio_1_1chain_a8f2f7aceaab268a032990183a430fa4a.html#a8f2f7aceaab268a032990183a430fa4a">eosio::chain::permission_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; permission_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, member&lt; permission_object, permission_object::id_type, &amp;permission_object::id &gt; &gt;, ordered_unique&lt; tag&lt; by_parent &gt;, composite_key&lt; permission_object, member&lt; permission_object, permission_object::id_type, &amp;permission_object::parent &gt;, member&lt; permission_object, permission_object::id_type, &amp;permission_object::id &gt; &gt; &gt;, ordered_unique&lt; tag&lt; by_owner &gt;, composite_key&lt; permission_object, member&lt; permission_object, account_name, &amp;permission_object::owner &gt;, member&lt; permission_object, permission_name, &amp;permission_object::name &gt; &gt; &gt;, ordered_unique&lt; tag&lt; by_name &gt;, composite_key&lt; permission_object, member&lt; permission_object, permission_name, &amp;permission_object::name &gt;, member&lt; permission_object, permission_object::id_type, &amp;permission_object::id &gt; &gt; &gt; &gt; &gt; permission_index</div><div class="ttdef"><b>Definition:</b> <a href="permission__object_8hpp_source.html#l00099">permission_object.hpp:99</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1transaction_html"><div class="ttname"><a href="structeosio_1_1chain_1_1transaction.html">eosio::chain::transaction</a></div><div class="ttdef"><b>Definition:</b> <a href="transaction_8hpp_source.html#l00054">transaction.hpp:54</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_adee2bbd448f667030f85d96603e1ee32_html_adee2bbd448f667030f85d96603e1ee32"><div class="ttname"><a href="namespaceeosio_1_1chain_adee2bbd448f667030f85d96603e1ee32.html#adee2bbd448f667030f85d96603e1ee32">eosio::chain::permission_usage_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; permission_usage_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, member&lt; permission_usage_object, permission_usage_object::id_type, &amp;permission_usage_object::id &gt; &gt; &gt; &gt; permission_usage_index</div><div class="ttdef"><b>Definition:</b> <a href="permission__object_8hpp_source.html#l00025">permission_object.hpp:25</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1authorization__manager_a8b4ca2f59c40bdbb6c5e2d82c898caee_html_a8b4ca2f59c40bdbb6c5e2d82c898caee"><div class="ttname"><a href="classeosio_1_1chain_1_1authorization__manager_a8b4ca2f59c40bdbb6c5e2d82c898caee.html#a8b4ca2f59c40bdbb6c5e2d82c898caee">eosio::chain::authorization_manager::modify_permission</a></div><div class="ttdeci">void modify_permission(const permission_object &amp;permission, const authority &amp;auth)</div><div class="ttdef"><b>Definition:</b> <a href="authorization__manager_8cpp_source.html#l00085">authorization_manager.cpp:85</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1chain__config_a09db09cb0c3030af4c08d4b8ad45fbc4_html_a09db09cb0c3030af4c08d4b8ad45fbc4"><div class="ttname"><a href="structeosio_1_1chain_1_1chain__config_a09db09cb0c3030af4c08d4b8ad45fbc4.html#a09db09cb0c3030af4c08d4b8ad45fbc4">eosio::chain::chain_config::max_transaction_delay</a></div><div class="ttdeci">uint32_t max_transaction_delay</div><div class="ttdoc">the maximum number of seconds that can be imposed as a delay requirement by authorization checks ...</div><div class="ttdef"><b>Definition:</b> <a href="chain__config_8hpp_source.html#l00035">chain_config.hpp:35</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_a113a4fa08534159756415238097d0b2b_html_a113a4fa08534159756415238097d0b2b"><div class="ttname"><a href="namespaceeosio_1_1chain_a113a4fa08534159756415238097d0b2b.html#a113a4fa08534159756415238097d0b2b">eosio::chain::generated_transaction_multi_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; generated_transaction_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, BOOST_MULTI_INDEX_MEMBER(generated_transaction_object, generated_transaction_object::id_type, id)&gt;, ordered_unique&lt; tag&lt; by_trx_id &gt;, BOOST_MULTI_INDEX_MEMBER(generated_transaction_object, transaction_id_type, trx_id)&gt;, ordered_unique&lt; tag&lt; by_expiration &gt;, composite_key&lt; generated_transaction_object, BOOST_MULTI_INDEX_MEMBER(generated_transaction_object, time_point, expiration), &gt; &gt;, ordered_unique&lt; tag&lt; by_delay &gt;, composite_key&lt; generated_transaction_object, BOOST_MULTI_INDEX_MEMBER(generated_transaction_object, time_point, delay_until), &gt; &gt;, ordered_unique&lt; tag&lt; by_sender_id &gt;, composite_key&lt; generated_transaction_object, BOOST_MULTI_INDEX_MEMBER(generated_transaction_object, account_name, sender), &gt; &gt; &gt; &gt; generated_transaction_multi_index</div><div class="ttdef"><b>Definition:</b> <a href="generated__transaction__object_8hpp_source.html#l00078">generated_transaction_object.hpp:78</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1authorization__manager_a78089b665cfc36ba15d8fd8be54faad3_html_a78089b665cfc36ba15d8fd8be54faad3"><div class="ttname"><a href="classeosio_1_1chain_1_1authorization__manager_a78089b665cfc36ba15d8fd8be54faad3.html#a78089b665cfc36ba15d8fd8be54faad3">eosio::chain::authorization_manager::create_permission</a></div><div class="ttdeci">const permission_object &amp; create_permission(account_name account, permission_name name, permission_id_type parent, const authority &amp;auth, time_point initial_creation_time=time_point())</div><div class="ttdef"><b>Definition:</b> <a href="authorization__manager_8cpp_source.html#l00031">authorization_manager.cpp:31</a></div></div>
<div class="ttc" id="exceptions_8hpp_ad71dd5d060716dc452bf1f191b9fca54_html_ad71dd5d060716dc452bf1f191b9fca54"><div class="ttname"><a href="exceptions_8hpp_ad71dd5d060716dc452bf1f191b9fca54.html#ad71dd5d060716dc452bf1f191b9fca54">EOS_RETHROW_EXCEPTIONS</a></div><div class="ttdeci">#define EOS_RETHROW_EXCEPTIONS(exception_type, FORMAT,...)</div><div class="ttdef"><b>Definition:</b> <a href="exceptions_8hpp_source.html#l00026">exceptions.hpp:26</a></div></div>
<div class="ttc" id="permission__link__object_8hpp_html"><div class="ttname"><a href="permission__link__object_8hpp.html">permission_link_object.hpp</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_html"><div class="ttname"><a href="classeosio_1_1chain_1_1controller.html">eosio::chain::controller</a></div><div class="ttdef"><b>Definition:</b> <a href="controller_8hpp_source.html#l00036">controller.hpp:36</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1unlinkauth_adc8f3b48fa1b32191511131e6b2ad3b5_html_adc8f3b48fa1b32191511131e6b2ad3b5"><div class="ttname"><a href="structeosio_1_1chain_1_1unlinkauth_adc8f3b48fa1b32191511131e6b2ad3b5.html#adc8f3b48fa1b32191511131e6b2ad3b5">eosio::chain::unlinkauth::get_name</a></div><div class="ttdeci">static action_name get_name()</div><div class="ttdef"><b>Definition:</b> <a href="contract__types_8hpp_source.html#l00123">contract_types.hpp:123</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1permission__object_html"><div class="ttname"><a href="classeosio_1_1chain_1_1permission__object.html">eosio::chain::permission_object</a></div><div class="ttdef"><b>Definition:</b> <a href="permission__object_8hpp_source.html#l00028">permission_object.hpp:28</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1authority_html"><div class="ttname"><a href="structeosio_1_1chain_1_1authority.html">eosio::chain::authority</a></div><div class="ttdef"><b>Definition:</b> <a href="authority_8hpp_source.html#l00059">authority.hpp:59</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1updateauth_html"><div class="ttname"><a href="structeosio_1_1chain_1_1updateauth.html">eosio::chain::updateauth</a></div><div class="ttdef"><b>Definition:</b> <a href="contract__types_8hpp_source.html#l00056">contract_types.hpp:56</a></div></div>
<div class="ttc" id="controller_8hpp_html"><div class="ttname"><a href="controller_8hpp.html">controller.hpp</a></div></div>
<div class="ttc" id="generated__transaction__object_8hpp_html"><div class="ttname"><a href="generated__transaction__object_8hpp.html">generated_transaction_object.hpp</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1deleteauth_aee35011bcdc77db217f3aefa55cd3825_html_aee35011bcdc77db217f3aefa55cd3825"><div class="ttname"><a href="structeosio_1_1chain_1_1deleteauth_aee35011bcdc77db217f3aefa55cd3825.html#aee35011bcdc77db217f3aefa55cd3825">eosio::chain::deleteauth::get_name</a></div><div class="ttdeci">static action_name get_name()</div><div class="ttdef"><b>Definition:</b> <a href="contract__types_8hpp_source.html#l00084">contract_types.hpp:84</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_a5fa53b350eec65b6a826d039d0286440_html_a5fa53b350eec65b6a826d039d0286440"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_a5fa53b350eec65b6a826d039d0286440.html#a5fa53b350eec65b6a826d039d0286440">eosio::chain::controller::db</a></div><div class="ttdeci">chainbase::database &amp; db() const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01151">controller.cpp:1151</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1authorization__manager_a46dfa24814957f09c1c2221179ced841_html_a46dfa24814957f09c1c2221179ced841"><div class="ttname"><a href="classeosio_1_1chain_1_1authorization__manager_a46dfa24814957f09c1c2221179ced841.html#a46dfa24814957f09c1c2221179ced841">eosio::chain::authorization_manager::remove_permission</a></div><div class="ttdeci">void remove_permission(const permission_object &amp;permission)</div><div class="ttdef"><b>Definition:</b> <a href="authorization__manager_8cpp_source.html#l00092">authorization_manager.cpp:92</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1deleteauth_html"><div class="ttname"><a href="structeosio_1_1chain_1_1deleteauth.html">eosio::chain::deleteauth</a></div><div class="ttdef"><b>Definition:</b> <a href="contract__types_8hpp_source.html#l00071">contract_types.hpp:71</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1linkauth_af6700bc07612af4bfc68ed8ae983dd5d_html_af6700bc07612af4bfc68ed8ae983dd5d"><div class="ttname"><a href="structeosio_1_1chain_1_1linkauth_af6700bc07612af4bfc68ed8ae983dd5d.html#af6700bc07612af4bfc68ed8ae983dd5d">eosio::chain::linkauth::get_name</a></div><div class="ttdeci">static action_name get_name()</div><div class="ttdef"><b>Definition:</b> <a href="contract__types_8hpp_source.html#l00104">contract_types.hpp:104</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_a2106ec5ced5c780d6cbebf6a727f910c_html_a2106ec5ced5c780d6cbebf6a727f910c"><div class="ttname"><a href="namespaceeosio_1_1chain_a2106ec5ced5c780d6cbebf6a727f910c.html#a2106ec5ced5c780d6cbebf6a727f910c">eosio::chain::account_name</a></div><div class="ttdeci">name account_name</div><div class="ttdef"><b>Definition:</b> <a href="types_8hpp_source.html#l00101">types.hpp:101</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1authorization__manager_a2cbd47dc471035cccd8e415617491153_html_a2cbd47dc471035cccd8e415617491153"><div class="ttname"><a href="classeosio_1_1chain_1_1authorization__manager_a2cbd47dc471035cccd8e415617491153.html#a2cbd47dc471035cccd8e415617491153">eosio::chain::authorization_manager::update_permission_usage</a></div><div class="ttdeci">void update_permission_usage(const permission_object &amp;permission)</div><div class="ttdef"><b>Definition:</b> <a href="authorization__manager_8cpp_source.html#l00102">authorization_manager.cpp:102</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue May 29 2018 17:40:53 for Eos by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
