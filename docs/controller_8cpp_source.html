<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Eos: libraries/chain/controller.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Eos
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_bc0718b08fb2015b8e59c47b2805f60c.html">libraries</a></li><li class="navelem"><a class="el" href="dir_94df585d4e205d65756e56c0817a7014.html">chain</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">controller.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="controller_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="controller_8hpp.html">eosio/chain/controller.hpp</a>&gt;</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="transaction__context_8hpp.html">eosio/chain/transaction_context.hpp</a>&gt;</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="block__log_8hpp.html">eosio/chain/block_log.hpp</a>&gt;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="fork__database_8hpp.html">eosio/chain/fork_database.hpp</a>&gt;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="account__object_8hpp.html">eosio/chain/account_object.hpp</a>&gt;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="block__summary__object_8hpp.html">eosio/chain/block_summary_object.hpp</a>&gt;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="global__property__object_8hpp.html">eosio/chain/global_property_object.hpp</a>&gt;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="contract__table__objects_8hpp.html">eosio/chain/contract_table_objects.hpp</a>&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="generated__transaction__object_8hpp.html">eosio/chain/generated_transaction_object.hpp</a>&gt;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="transaction__object_8hpp.html">eosio/chain/transaction_object.hpp</a>&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="reversible__block__object_8hpp.html">eosio/chain/reversible_block_object.hpp</a>&gt;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="authorization__manager_8hpp.html">eosio/chain/authorization_manager.hpp</a>&gt;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="resource__limits_8hpp.html">eosio/chain/resource_limits.hpp</a>&gt;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;chainbase/chainbase.hpp&gt;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;fc/io/json.hpp&gt;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;fc/scoped_exit.hpp&gt;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="eosio__contract_8hpp.html">eosio/chain/eosio_contract.hpp</a>&gt;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceeosio.html">eosio</a> { <span class="keyword">namespace </span>chain {</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keyword">using</span> resource_limits::resource_limits_manager;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1pending__state.html">   29</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structeosio_1_1chain_1_1pending__state.html">pending_state</a> {</div><div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1pending__state_a423b424b888f3ed111faddbcc5169c5b.html#a423b424b888f3ed111faddbcc5169c5b">   30</a></span>&#160;   <a class="code" href="structeosio_1_1chain_1_1pending__state_a423b424b888f3ed111faddbcc5169c5b.html#a423b424b888f3ed111faddbcc5169c5b">pending_state</a>( database::session&amp;&amp; s )</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;   :<a class="code" href="structeosio_1_1chain_1_1pending__state_a537316e4e8178e8d8c19976e33a7e40e.html#a537316e4e8178e8d8c19976e33a7e40e">_db_session</a>( move(s) ){}</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1pending__state_a537316e4e8178e8d8c19976e33a7e40e.html#a537316e4e8178e8d8c19976e33a7e40e">   33</a></span>&#160;   database::session                  <a class="code" href="structeosio_1_1chain_1_1pending__state_a537316e4e8178e8d8c19976e33a7e40e.html#a537316e4e8178e8d8c19976e33a7e40e">_db_session</a>;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1pending__state_af0d6debfaef54e452f92d73179de98af.html#af0d6debfaef54e452f92d73179de98af">   35</a></span>&#160;   <a class="code" href="namespaceeosio_1_1chain_ae6d914f3a3962e565e36b7c967990d65.html#ae6d914f3a3962e565e36b7c967990d65">block_state_ptr</a>                    <a class="code" href="structeosio_1_1chain_1_1pending__state_af0d6debfaef54e452f92d73179de98af.html#af0d6debfaef54e452f92d73179de98af">_pending_block_state</a>;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1pending__state_a3aaa36e814d0dda471485780ce3f039a.html#a3aaa36e814d0dda471485780ce3f039a">   37</a></span>&#160;   vector&lt;action_receipt&gt;             <a class="code" href="structeosio_1_1chain_1_1pending__state_a3aaa36e814d0dda471485780ce3f039a.html#a3aaa36e814d0dda471485780ce3f039a">_actions</a>;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1pending__state_a5a3481dd5961e2a18a916b95facfee45.html#a5a3481dd5961e2a18a916b95facfee45">   39</a></span>&#160;   <a class="code" href="classeosio_1_1chain_1_1controller_aefc14531638f18365926345eb19fa2e6.html#aefc14531638f18365926345eb19fa2e6">controller::block_status</a>           <a class="code" href="structeosio_1_1chain_1_1pending__state_a5a3481dd5961e2a18a916b95facfee45.html#a5a3481dd5961e2a18a916b95facfee45">_block_status</a> = <a class="code" href="classeosio_1_1chain_1_1controller_aefc14531638f18365926345eb19fa2e6.html#aefc14531638f18365926345eb19fa2e6a5ed4e9858ad8d239145ef285b6210a00">controller::block_status::incomplete</a>;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1pending__state_a03463b295d413d85f2521ddc7e66345f.html#a03463b295d413d85f2521ddc7e66345f">   41</a></span>&#160;   <span class="keywordtype">void</span> <a class="code" href="structeosio_1_1chain_1_1pending__state_a03463b295d413d85f2521ddc7e66345f.html#a03463b295d413d85f2521ddc7e66345f">push</a>() {</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1pending__state_a537316e4e8178e8d8c19976e33a7e40e.html#a537316e4e8178e8d8c19976e33a7e40e">_db_session</a>.push();</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;   }</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;};</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl.html">   46</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structeosio_1_1chain_1_1controller__impl.html">controller_impl</a> {</div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a73bf06c95a2f3d9dae0531996e8e1833.html#a73bf06c95a2f3d9dae0531996e8e1833">   47</a></span>&#160;   <a class="code" href="classeosio_1_1chain_1_1controller.html">controller</a>&amp;                    <span class="keyword">self</span>;</div><div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">   48</a></span>&#160;   chainbase::database            <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>;</div><div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a589cc4ccddcc2325401bc7114b2e0f2d.html#a589cc4ccddcc2325401bc7114b2e0f2d">   49</a></span>&#160;   chainbase::database            <a class="code" href="structeosio_1_1chain_1_1controller__impl_a589cc4ccddcc2325401bc7114b2e0f2d.html#a589cc4ccddcc2325401bc7114b2e0f2d">reversible_blocks</a>; </div><div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_ab5c1e9a69d9cfd3beb3ec87676b2de48.html#ab5c1e9a69d9cfd3beb3ec87676b2de48">   50</a></span>&#160;   <a class="code" href="classeosio_1_1chain_1_1block__log.html">block_log</a>                      <a class="code" href="structeosio_1_1chain_1_1controller__impl_ab5c1e9a69d9cfd3beb3ec87676b2de48.html#ab5c1e9a69d9cfd3beb3ec87676b2de48">blog</a>;</div><div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a59302140653329127e39e4bb54bd0ba8.html#a59302140653329127e39e4bb54bd0ba8">   51</a></span>&#160;   optional&lt;pending_state&gt;        <a class="code" href="structeosio_1_1chain_1_1controller__impl_a59302140653329127e39e4bb54bd0ba8.html#a59302140653329127e39e4bb54bd0ba8">pending</a>;</div><div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a.html#af1ddbd95476e5e9b1a83b0bf6667428a">   52</a></span>&#160;   <a class="code" href="namespaceeosio_1_1chain_ae6d914f3a3962e565e36b7c967990d65.html#ae6d914f3a3962e565e36b7c967990d65">block_state_ptr</a>                <a class="code" href="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a.html#af1ddbd95476e5e9b1a83b0bf6667428a">head</a>;</div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a1e289b420cc20017f3e71ba22796103a.html#a1e289b420cc20017f3e71ba22796103a">   53</a></span>&#160;   <a class="code" href="classeosio_1_1chain_1_1fork__database.html">fork_database</a>                  <a class="code" href="structeosio_1_1chain_1_1controller__impl_a1e289b420cc20017f3e71ba22796103a.html#a1e289b420cc20017f3e71ba22796103a">fork_db</a>;</div><div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_ad3716fa18dac5439c8d0dd63e4920b19.html#ad3716fa18dac5439c8d0dd63e4920b19">   54</a></span>&#160;   <a class="code" href="classeosio_1_1chain_1_1wasm__interface.html">wasm_interface</a>                 <a class="code" href="structeosio_1_1chain_1_1controller__impl_ad3716fa18dac5439c8d0dd63e4920b19.html#ad3716fa18dac5439c8d0dd63e4920b19">wasmif</a>;</div><div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_af826b7e42e964e5942bbb53d6e8cd99a.html#af826b7e42e964e5942bbb53d6e8cd99a">   55</a></span>&#160;   <a class="code" href="classeosio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html">resource_limits_manager</a>        <a class="code" href="structeosio_1_1chain_1_1controller__impl_af826b7e42e964e5942bbb53d6e8cd99a.html#af826b7e42e964e5942bbb53d6e8cd99a">resource_limits</a>;</div><div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a7872719d533c96482bda49179dc79f42.html#a7872719d533c96482bda49179dc79f42">   56</a></span>&#160;   <a class="code" href="classeosio_1_1chain_1_1authorization__manager.html">authorization_manager</a>          <a class="code" href="structeosio_1_1chain_1_1controller__impl_a7872719d533c96482bda49179dc79f42.html#a7872719d533c96482bda49179dc79f42">authorization</a>;</div><div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a94b666c1656f9b21fc2d01e3dfaf4fb9.html#a94b666c1656f9b21fc2d01e3dfaf4fb9">   57</a></span>&#160;   <a class="code" href="structeosio_1_1chain_1_1controller_1_1config.html">controller::config</a>             <a class="code" href="structeosio_1_1chain_1_1controller__impl_a94b666c1656f9b21fc2d01e3dfaf4fb9.html#a94b666c1656f9b21fc2d01e3dfaf4fb9">conf</a>;</div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_adbe569ad52efdaa687486381712d5121.html#adbe569ad52efdaa687486381712d5121">   58</a></span>&#160;   <a class="code" href="structeosio_1_1chain_1_1chain__id__type.html">chain_id_type</a>                  <a class="code" href="structeosio_1_1chain_1_1controller__impl_adbe569ad52efdaa687486381712d5121.html#adbe569ad52efdaa687486381712d5121">chain_id</a>;</div><div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_afc114a9bfeaf2673c72b095dde4700e5.html#afc114a9bfeaf2673c72b095dde4700e5">   59</a></span>&#160;   <span class="keywordtype">bool</span>                           <a class="code" href="structeosio_1_1chain_1_1controller__impl_afc114a9bfeaf2673c72b095dde4700e5.html#afc114a9bfeaf2673c72b095dde4700e5">replaying</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a4f6e1b734639b1892be2a63414655e0a.html#a4f6e1b734639b1892be2a63414655e0a">   61</a></span>&#160;   <span class="keyword">typedef</span> pair&lt;scope_name,action_name&gt;                   <a class="code" href="structeosio_1_1chain_1_1controller__impl_a4f6e1b734639b1892be2a63414655e0a.html#a4f6e1b734639b1892be2a63414655e0a">handler_key</a>;</div><div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a5603fe6d434370976459475b8df8bfb7.html#a5603fe6d434370976459475b8df8bfb7">   62</a></span>&#160;   map&lt; account_name, map&lt;handler_key, apply_handler&gt; &gt;   <a class="code" href="structeosio_1_1chain_1_1controller__impl_a5603fe6d434370976459475b8df8bfb7.html#a5603fe6d434370976459475b8df8bfb7">apply_handlers</a>;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_ac7e099b137d6edfd2ae97b91b8fc8a80.html#ac7e099b137d6edfd2ae97b91b8fc8a80">   69</a></span>&#160;   map&lt;digest_type, transaction_metadata_ptr&gt;     <a class="code" href="structeosio_1_1chain_1_1controller__impl_ac7e099b137d6edfd2ae97b91b8fc8a80.html#ac7e099b137d6edfd2ae97b91b8fc8a80">unapplied_transactions</a>;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a7b01c847954f3c105dc2df798636c2a7.html#a7b01c847954f3c105dc2df798636c2a7">   71</a></span>&#160;   <span class="keywordtype">void</span> <a class="code" href="structeosio_1_1chain_1_1controller__impl_a7b01c847954f3c105dc2df798636c2a7.html#a7b01c847954f3c105dc2df798636c2a7">pop_block</a>() {</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <span class="keyword">auto</span> prev = <a class="code" href="structeosio_1_1chain_1_1controller__impl_a1e289b420cc20017f3e71ba22796103a.html#a1e289b420cc20017f3e71ba22796103a">fork_db</a>.<a class="code" href="classeosio_1_1chain_1_1fork__database_af12004b2f63091cfcf76dae31197f324.html#af12004b2f63091cfcf76dae31197f324">get_block</a>( <a class="code" href="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a.html#af1ddbd95476e5e9b1a83b0bf6667428a">head</a>-&gt;header.previous );</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      FC_ASSERT( prev, <span class="stringliteral">&quot;attempt to pop beyond last irreversible block&quot;</span> );</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <span class="keywordflow">if</span>( <span class="keyword">const</span> <span class="keyword">auto</span>* b = <a class="code" href="structeosio_1_1chain_1_1controller__impl_a589cc4ccddcc2325401bc7114b2e0f2d.html#a589cc4ccddcc2325401bc7114b2e0f2d">reversible_blocks</a>.find&lt;<a class="code" href="classeosio_1_1chain_1_1reversible__block__object.html">reversible_block_object</a>,by_num&gt;(<a class="code" href="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a.html#af1ddbd95476e5e9b1a83b0bf6667428a">head</a>-&gt;block_num) )</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      {</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;         <a class="code" href="structeosio_1_1chain_1_1controller__impl_a589cc4ccddcc2325401bc7114b2e0f2d.html#a589cc4ccddcc2325401bc7114b2e0f2d">reversible_blocks</a>.remove( *b );</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      }</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; t : <a class="code" href="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a.html#af1ddbd95476e5e9b1a83b0bf6667428a">head</a>-&gt;trxs )</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;         <a class="code" href="structeosio_1_1chain_1_1controller__impl_ac7e099b137d6edfd2ae97b91b8fc8a80.html#ac7e099b137d6edfd2ae97b91b8fc8a80">unapplied_transactions</a>[t-&gt;signed_id] = t;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a.html#af1ddbd95476e5e9b1a83b0bf6667428a">head</a> = prev;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.undo();</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;   }</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a2593b2f5863eb130ff4d4fc9ce2574ab.html#a2593b2f5863eb130ff4d4fc9ce2574ab">   88</a></span>&#160;   <span class="keywordtype">void</span> <a class="code" href="structeosio_1_1chain_1_1controller__impl_a2593b2f5863eb130ff4d4fc9ce2574ab.html#a2593b2f5863eb130ff4d4fc9ce2574ab">set_apply_handler</a>( <a class="code" href="structeosio_1_1chain_1_1name.html">account_name</a> receiver, <a class="code" href="structeosio_1_1chain_1_1name.html">account_name</a> contract, <a class="code" href="namespaceeosio_1_1chain_afb4a1df1715a88764f246867c5d32796.html#afb4a1df1715a88764f246867c5d32796">action_name</a> <a class="code" href="structeosio_1_1chain_1_1action.html">action</a>, <a class="code" href="namespaceeosio_1_1chain_a411a7151b8bf3be332abd8f3670dfdf2.html#a411a7151b8bf3be332abd8f3670dfdf2">apply_handler</a> v ) {</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a5603fe6d434370976459475b8df8bfb7.html#a5603fe6d434370976459475b8df8bfb7">apply_handlers</a>[receiver][make_pair(contract,<a class="code" href="structeosio_1_1chain_1_1action.html">action</a>)] = v;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;   }</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a4be8b9052764dd73e4a710293d3b876e.html#a4be8b9052764dd73e4a710293d3b876e">   92</a></span>&#160;   <a class="code" href="structeosio_1_1chain_1_1controller__impl_a4be8b9052764dd73e4a710293d3b876e.html#a4be8b9052764dd73e4a710293d3b876e">controller_impl</a>( <span class="keyword">const</span> <a class="code" href="structeosio_1_1chain_1_1controller_1_1config.html">controller::config</a>&amp; cfg, <a class="code" href="classeosio_1_1chain_1_1controller.html">controller</a>&amp; s  )</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   :<a class="code" href="structeosio_1_1chain_1_1controller__impl_a73bf06c95a2f3d9dae0531996e8e1833.html#a73bf06c95a2f3d9dae0531996e8e1833">self</a>(s),</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>( cfg.state_dir,</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        cfg.read_only ? database::read_only : database::read_write,</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        cfg.state_size ),</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="structeosio_1_1chain_1_1controller__impl_a589cc4ccddcc2325401bc7114b2e0f2d.html#a589cc4ccddcc2325401bc7114b2e0f2d">reversible_blocks</a>( cfg.blocks_dir/config::reversible_blocks_dir_name,</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        cfg.read_only ? database::read_only : database::read_write,</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        cfg.reversible_cache_size ),</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="structeosio_1_1chain_1_1controller__impl_ab5c1e9a69d9cfd3beb3ec87676b2de48.html#ab5c1e9a69d9cfd3beb3ec87676b2de48">blog</a>( cfg.blocks_dir ),</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <a class="code" href="structeosio_1_1chain_1_1controller__impl_a1e289b420cc20017f3e71ba22796103a.html#a1e289b420cc20017f3e71ba22796103a">fork_db</a>( cfg.state_dir ),</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="structeosio_1_1chain_1_1controller__impl_ad3716fa18dac5439c8d0dd63e4920b19.html#ad3716fa18dac5439c8d0dd63e4920b19">wasmif</a>( cfg.wasm_runtime ),</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="structeosio_1_1chain_1_1controller__impl_af826b7e42e964e5942bbb53d6e8cd99a.html#af826b7e42e964e5942bbb53d6e8cd99a">resource_limits</a>( <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a> ),</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="structeosio_1_1chain_1_1controller__impl_a7872719d533c96482bda49179dc79f42.html#a7872719d533c96482bda49179dc79f42">authorization</a>( s, <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a> ),</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="structeosio_1_1chain_1_1controller__impl_a94b666c1656f9b21fc2d01e3dfaf4fb9.html#a94b666c1656f9b21fc2d01e3dfaf4fb9">conf</a>( cfg ),</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="structeosio_1_1chain_1_1controller__impl_adbe569ad52efdaa687486381712d5121.html#adbe569ad52efdaa687486381712d5121">chain_id</a>( cfg.genesis.compute_chain_id() )</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;   {</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor">#define SET_APP_HANDLER( receiver, contract, action) \</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor">   set_apply_handler( #receiver, #contract, #action, &amp;BOOST_PP_CAT(apply_, BOOST_PP_CAT(contract, BOOST_PP_CAT(_,action) ) ) )</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;   <a class="code" href="controller_8cpp_a903c4d2c725a565b423b8c7978ba252c.html#a903c4d2c725a565b423b8c7978ba252c">SET_APP_HANDLER</a>( <a class="code" href="namespaceeosio.html">eosio</a>, <a class="code" href="namespaceeosio.html">eosio</a>, <a class="code" href="structeosio_1_1chain_1_1newaccount.html">newaccount</a> );</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;   <a class="code" href="controller_8cpp_a903c4d2c725a565b423b8c7978ba252c.html#a903c4d2c725a565b423b8c7978ba252c">SET_APP_HANDLER</a>( <a class="code" href="namespaceeosio.html">eosio</a>, <a class="code" href="namespaceeosio.html">eosio</a>, <a class="code" href="structeosio_1_1chain_1_1setcode.html">setcode</a> );</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;   <a class="code" href="controller_8cpp_a903c4d2c725a565b423b8c7978ba252c.html#a903c4d2c725a565b423b8c7978ba252c">SET_APP_HANDLER</a>( <a class="code" href="namespaceeosio.html">eosio</a>, <a class="code" href="namespaceeosio.html">eosio</a>, <a class="code" href="structeosio_1_1chain_1_1setabi.html">setabi</a> );</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   <a class="code" href="controller_8cpp_a903c4d2c725a565b423b8c7978ba252c.html#a903c4d2c725a565b423b8c7978ba252c">SET_APP_HANDLER</a>( <a class="code" href="namespaceeosio.html">eosio</a>, <a class="code" href="namespaceeosio.html">eosio</a>, <a class="code" href="structeosio_1_1chain_1_1updateauth.html">updateauth</a> );</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;   <a class="code" href="controller_8cpp_a903c4d2c725a565b423b8c7978ba252c.html#a903c4d2c725a565b423b8c7978ba252c">SET_APP_HANDLER</a>( <a class="code" href="namespaceeosio.html">eosio</a>, <a class="code" href="namespaceeosio.html">eosio</a>, <a class="code" href="structeosio_1_1chain_1_1deleteauth.html">deleteauth</a> );</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   <a class="code" href="controller_8cpp_a903c4d2c725a565b423b8c7978ba252c.html#a903c4d2c725a565b423b8c7978ba252c">SET_APP_HANDLER</a>( <a class="code" href="namespaceeosio.html">eosio</a>, <a class="code" href="namespaceeosio.html">eosio</a>, <a class="code" href="structeosio_1_1chain_1_1linkauth.html">linkauth</a> );</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   <a class="code" href="controller_8cpp_a903c4d2c725a565b423b8c7978ba252c.html#a903c4d2c725a565b423b8c7978ba252c">SET_APP_HANDLER</a>( <a class="code" href="namespaceeosio.html">eosio</a>, <a class="code" href="namespaceeosio.html">eosio</a>, <a class="code" href="structeosio_1_1chain_1_1unlinkauth.html">unlinkauth</a> );</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">   SET_APP_HANDLER( eosio, eosio, postrecovery );</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">   SET_APP_HANDLER( eosio, eosio, passrecovery );</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">   SET_APP_HANDLER( eosio, eosio, vetorecovery );</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;   <a class="code" href="controller_8cpp_a903c4d2c725a565b423b8c7978ba252c.html#a903c4d2c725a565b423b8c7978ba252c">SET_APP_HANDLER</a>( <a class="code" href="namespaceeosio.html">eosio</a>, <a class="code" href="namespaceeosio.html">eosio</a>, <a class="code" href="structeosio_1_1chain_1_1canceldelay.html">canceldelay</a> );</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;   <a class="code" href="structeosio_1_1chain_1_1controller__impl_a1e289b420cc20017f3e71ba22796103a.html#a1e289b420cc20017f3e71ba22796103a">fork_db</a>.<a class="code" href="classeosio_1_1chain_1_1fork__database_ae7998230cf13cc4476de64f77ce0d820.html#ae7998230cf13cc4476de64f77ce0d820">irreversible</a>.connect( [&amp;]( <span class="keyword">auto</span> b ) {</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                                 <a class="code" href="structeosio_1_1chain_1_1controller__impl_a5cdb950f1640260acf38ed7ac6e9d6f7.html#a5cdb950f1640260acf38ed7ac6e9d6f7">on_irreversible</a>(b);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                                 });</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;   }</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;   <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Signal, <span class="keyword">typename</span> Arg&gt;</div><div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a5e1cd636c73b6f40e125abcfd0703451.html#a5e1cd636c73b6f40e125abcfd0703451">  143</a></span>&#160;   <span class="keywordtype">void</span> <a class="code" href="structeosio_1_1chain_1_1controller__impl_a5e1cd636c73b6f40e125abcfd0703451.html#a5e1cd636c73b6f40e125abcfd0703451">emit</a>( <span class="keyword">const</span> Signal&amp; s, Arg&amp;&amp; a ) {</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <span class="keywordflow">try</span> {</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        s(std::forward&lt;Arg&gt;(a));</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      } <span class="keywordflow">catch</span> (boost::interprocess::bad_alloc&amp; e) {</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;         wlog( <span class="stringliteral">&quot;bad alloc&quot;</span> );</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;         <span class="keywordflow">throw</span> e;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      } <span class="keywordflow">catch</span> ( fc::exception&amp; e ) {</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;         wlog( <span class="stringliteral">&quot;${details}&quot;</span>, (<span class="stringliteral">&quot;details&quot;</span>, e.to_detail_string()) );</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      } <span class="keywordflow">catch</span> ( ... ) {</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;         wlog( <span class="stringliteral">&quot;signal handler threw exception&quot;</span> );</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      }</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;   }</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a5cdb950f1640260acf38ed7ac6e9d6f7.html#a5cdb950f1640260acf38ed7ac6e9d6f7">  156</a></span>&#160;   <span class="keywordtype">void</span> <a class="code" href="structeosio_1_1chain_1_1controller__impl_a5cdb950f1640260acf38ed7ac6e9d6f7.html#a5cdb950f1640260acf38ed7ac6e9d6f7">on_irreversible</a>( <span class="keyword">const</span> <a class="code" href="namespaceeosio_1_1chain_ae6d914f3a3962e565e36b7c967990d65.html#ae6d914f3a3962e565e36b7c967990d65">block_state_ptr</a>&amp; s ) {</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="keywordflow">if</span>( !<a class="code" href="structeosio_1_1chain_1_1controller__impl_ab5c1e9a69d9cfd3beb3ec87676b2de48.html#ab5c1e9a69d9cfd3beb3ec87676b2de48">blog</a>.<a class="code" href="classeosio_1_1chain_1_1block__log_af65701d8271b67983f14a7161aac12aa.html#af65701d8271b67983f14a7161aac12aa">head</a>() )</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;         <a class="code" href="structeosio_1_1chain_1_1controller__impl_ab5c1e9a69d9cfd3beb3ec87676b2de48.html#ab5c1e9a69d9cfd3beb3ec87676b2de48">blog</a>.<a class="code" href="classeosio_1_1chain_1_1block__log_a3afac3abf8906f2491c58110fca00155.html#a3afac3abf8906f2491c58110fca00155">read_head</a>();</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; log_head = <a class="code" href="structeosio_1_1chain_1_1controller__impl_ab5c1e9a69d9cfd3beb3ec87676b2de48.html#ab5c1e9a69d9cfd3beb3ec87676b2de48">blog</a>.<a class="code" href="classeosio_1_1chain_1_1block__log_af65701d8271b67983f14a7161aac12aa.html#af65701d8271b67983f14a7161aac12aa">head</a>();</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      FC_ASSERT( log_head );</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="keyword">auto</span> lh_block_num = log_head-&gt;block_num();</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a5e1cd636c73b6f40e125abcfd0703451.html#a5e1cd636c73b6f40e125abcfd0703451">emit</a>( <span class="keyword">self</span>.irreversible_block, s );</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.commit( s-&gt;block_num );</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="keywordflow">if</span>( s-&gt;block_num &lt;= lh_block_num ) {</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">//         edump((s-&gt;block_num)(&quot;double call to on_irr&quot;));</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">//         edump((s-&gt;block_num)(s-&gt;block-&gt;previous)(log_head-&gt;id()));</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      }</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      FC_ASSERT( s-&gt;block_num - 1  == lh_block_num, <span class="stringliteral">&quot;unlinkable block&quot;</span>, (<span class="stringliteral">&quot;s-&gt;block_num&quot;</span>,s-&gt;block_num)(<span class="stringliteral">&quot;lh_block_num&quot;</span>, lh_block_num) );</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      FC_ASSERT( s-&gt;block-&gt;previous == log_head-&gt;id(), <span class="stringliteral">&quot;irreversible doesn&#39;t link to block log head&quot;</span> );</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_ab5c1e9a69d9cfd3beb3ec87676b2de48.html#ab5c1e9a69d9cfd3beb3ec87676b2de48">blog</a>.<a class="code" href="classeosio_1_1chain_1_1block__log_a60726f7fe12c0918e4973aac125201d9.html#a60726f7fe12c0918e4973aac125201d9">append</a>(s-&gt;block);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; ubi = <a class="code" href="structeosio_1_1chain_1_1controller__impl_a589cc4ccddcc2325401bc7114b2e0f2d.html#a589cc4ccddcc2325401bc7114b2e0f2d">reversible_blocks</a>.get_index&lt;<a class="code" href="namespaceeosio_1_1chain_af5042e3b6e189bfd9d666ba6e4e6b00b.html#af5042e3b6e189bfd9d666ba6e4e6b00b">reversible_block_index</a>,by_num&gt;();</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="keyword">auto</span> objitr = ubi.begin();</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <span class="keywordflow">while</span>( objitr != ubi.end() &amp;&amp; objitr-&gt;blocknum &lt;= s-&gt;block_num ) {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;         <a class="code" href="structeosio_1_1chain_1_1controller__impl_a589cc4ccddcc2325401bc7114b2e0f2d.html#a589cc4ccddcc2325401bc7114b2e0f2d">reversible_blocks</a>.remove( *objitr );</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;         objitr = ubi.begin();</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      }</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;   }</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_ae5391da2367f807ec2faa52a276cfeab.html#ae5391da2367f807ec2faa52a276cfeab">  185</a></span>&#160;   <span class="keywordtype">void</span> <a class="code" href="structeosio_1_1chain_1_1controller__impl_ae5391da2367f807ec2faa52a276cfeab.html#ae5391da2367f807ec2faa52a276cfeab">init</a>() {</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="keywordflow">if</span>( !<a class="code" href="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a.html#af1ddbd95476e5e9b1a83b0bf6667428a">head</a> ) {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;         <a class="code" href="structeosio_1_1chain_1_1controller__impl_ab4ef0a03050f7740fe082fa687ddb9b1.html#ab4ef0a03050f7740fe082fa687ddb9b1">initialize_fork_db</a>(); <span class="comment">// set head to genesis state</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;         <span class="keyword">auto</span> end = <a class="code" href="structeosio_1_1chain_1_1controller__impl_ab5c1e9a69d9cfd3beb3ec87676b2de48.html#ab5c1e9a69d9cfd3beb3ec87676b2de48">blog</a>.<a class="code" href="classeosio_1_1chain_1_1block__log_a3afac3abf8906f2491c58110fca00155.html#a3afac3abf8906f2491c58110fca00155">read_head</a>();</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;         <span class="keywordflow">if</span>( end &amp;&amp; end-&gt;block_num() &gt; 1 ) {</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <a class="code" href="structeosio_1_1chain_1_1controller__impl_afc114a9bfeaf2673c72b095dde4700e5.html#afc114a9bfeaf2673c72b095dde4700e5">replaying</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            ilog( <span class="stringliteral">&quot;existing block log, attempting to replay ${n} blocks&quot;</span>, (<span class="stringliteral">&quot;n&quot;</span>,end-&gt;block_num()) );</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            <span class="keyword">auto</span> start = fc::time_point::now();</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <span class="keywordflow">while</span>( <span class="keyword">auto</span> next = <a class="code" href="structeosio_1_1chain_1_1controller__impl_ab5c1e9a69d9cfd3beb3ec87676b2de48.html#ab5c1e9a69d9cfd3beb3ec87676b2de48">blog</a>.<a class="code" href="classeosio_1_1chain_1_1block__log_a0f249b7ed0343f32d022c7a1e16d97cb.html#a0f249b7ed0343f32d022c7a1e16d97cb">read_block_by_num</a>( <a class="code" href="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a.html#af1ddbd95476e5e9b1a83b0bf6667428a">head</a>-&gt;block_num + 1 ) ) {</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;               <span class="keyword">self</span>.push_block( next, <a class="code" href="classeosio_1_1chain_1_1controller_aefc14531638f18365926345eb19fa2e6.html#aefc14531638f18365926345eb19fa2e6a7e6e4eb3ff27864637756cb4d2a2a45d">controller::block_status::irreversible</a> );</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;               <span class="keywordflow">if</span>( next-&gt;block_num() % 100 == 0 ) {</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                  std::cerr &lt;&lt; std::setw(10) &lt;&lt; next-&gt;block_num() &lt;&lt; <span class="stringliteral">&quot; of &quot;</span> &lt;&lt; end-&gt;block_num() &lt;&lt;<span class="stringliteral">&quot;\r&quot;</span>;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;               }</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            }</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            <span class="keywordtype">int</span> rev = 0;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            <span class="keywordflow">while</span>( <span class="keyword">auto</span> obj = <a class="code" href="structeosio_1_1chain_1_1controller__impl_a589cc4ccddcc2325401bc7114b2e0f2d.html#a589cc4ccddcc2325401bc7114b2e0f2d">reversible_blocks</a>.find&lt;<a class="code" href="classeosio_1_1chain_1_1reversible__block__object.html">reversible_block_object</a>,by_num&gt;(<a class="code" href="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a.html#af1ddbd95476e5e9b1a83b0bf6667428a">head</a>-&gt;block_num+1) ) {</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;               ++rev;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;               <span class="keyword">self</span>.push_block( obj-&gt;get_block(), <a class="code" href="classeosio_1_1chain_1_1controller_aefc14531638f18365926345eb19fa2e6.html#aefc14531638f18365926345eb19fa2e6ac9e825f4641cd3bec0ba01a0c2d67755">controller::block_status::validated</a> );</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            }</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            std::cerr&lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            ilog( <span class="stringliteral">&quot;${n} reversible blocks replayed&quot;</span>, (<span class="stringliteral">&quot;n&quot;</span>,rev) );</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <span class="keyword">auto</span> end = fc::time_point::now();</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            ilog( <span class="stringliteral">&quot;replayed ${n} blocks in seconds, ${mspb} ms/block&quot;</span>,</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                  (<span class="stringliteral">&quot;n&quot;</span>, <a class="code" href="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a.html#af1ddbd95476e5e9b1a83b0bf6667428a">head</a>-&gt;block_num)(<span class="stringliteral">&quot;duration&quot;</span>, (end-start).count()/1000000)</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                  (<span class="stringliteral">&quot;mspb&quot;</span>, ((end-start).count()/1000.0)/<a class="code" href="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a.html#af1ddbd95476e5e9b1a83b0bf6667428a">head</a>-&gt;block_num)        );</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            std::cerr&lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            <a class="code" href="structeosio_1_1chain_1_1controller__impl_afc114a9bfeaf2673c72b095dde4700e5.html#afc114a9bfeaf2673c72b095dde4700e5">replaying</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( !end ) {</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            <a class="code" href="structeosio_1_1chain_1_1controller__impl_ab5c1e9a69d9cfd3beb3ec87676b2de48.html#ab5c1e9a69d9cfd3beb3ec87676b2de48">blog</a>.<a class="code" href="classeosio_1_1chain_1_1block__log_a4c80fb522e95773c33a035c863201aef.html#a4c80fb522e95773c33a035c863201aef">reset_to_genesis</a>( <a class="code" href="structeosio_1_1chain_1_1controller__impl_a94b666c1656f9b21fc2d01e3dfaf4fb9.html#a94b666c1656f9b21fc2d01e3dfaf4fb9">conf</a>.<a class="code" href="structeosio_1_1chain_1_1controller_1_1config_a11b0f8fdb59a89d306fd8f75eeb734a2.html#a11b0f8fdb59a89d306fd8f75eeb734a2">genesis</a>, <a class="code" href="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a.html#af1ddbd95476e5e9b1a83b0bf6667428a">head</a>-&gt;block );</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;         }</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      }</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; ubi = <a class="code" href="structeosio_1_1chain_1_1controller__impl_a589cc4ccddcc2325401bc7114b2e0f2d.html#a589cc4ccddcc2325401bc7114b2e0f2d">reversible_blocks</a>.get_index&lt;<a class="code" href="namespaceeosio_1_1chain_af5042e3b6e189bfd9d666ba6e4e6b00b.html#af5042e3b6e189bfd9d666ba6e4e6b00b">reversible_block_index</a>,by_num&gt;();</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="keyword">auto</span> objitr = ubi.rbegin();</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="keywordflow">if</span>( objitr != ubi.rend() ) {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;         FC_ASSERT( objitr-&gt;blocknum == <a class="code" href="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a.html#af1ddbd95476e5e9b1a83b0bf6667428a">head</a>-&gt;block_num,</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                    <span class="stringliteral">&quot;reversible block database is inconsistent with fork database, replay blockchain&quot;</span>,</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                    (<span class="stringliteral">&quot;head&quot;</span>,<a class="code" href="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a.html#af1ddbd95476e5e9b1a83b0bf6667428a">head</a>-&gt;block_num)(<span class="stringliteral">&quot;unconfimed&quot;</span>, objitr-&gt;blocknum)         );</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;         <span class="keyword">auto</span> end = <a class="code" href="structeosio_1_1chain_1_1controller__impl_ab5c1e9a69d9cfd3beb3ec87676b2de48.html#ab5c1e9a69d9cfd3beb3ec87676b2de48">blog</a>.<a class="code" href="classeosio_1_1chain_1_1block__log_a3afac3abf8906f2491c58110fca00155.html#a3afac3abf8906f2491c58110fca00155">read_head</a>();</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;         FC_ASSERT( end &amp;&amp; end-&gt;block_num() == <a class="code" href="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a.html#af1ddbd95476e5e9b1a83b0bf6667428a">head</a>-&gt;block_num,</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                    <span class="stringliteral">&quot;fork database exists but reversible block database does not, replay blockchain&quot;</span>,</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                    (<span class="stringliteral">&quot;blog_head&quot;</span>,end-&gt;block_num())(<span class="stringliteral">&quot;head&quot;</span>,<a class="code" href="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a.html#af1ddbd95476e5e9b1a83b0bf6667428a">head</a>-&gt;block_num)  );</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      }</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      FC_ASSERT( <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.revision() &gt;= <a class="code" href="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a.html#af1ddbd95476e5e9b1a83b0bf6667428a">head</a>-&gt;block_num, <span class="stringliteral">&quot;fork database is inconsistent with shared memory&quot;</span>,</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                 (<span class="stringliteral">&quot;db&quot;</span>,<a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.revision())(<span class="stringliteral">&quot;head&quot;</span>,<a class="code" href="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a.html#af1ddbd95476e5e9b1a83b0bf6667428a">head</a>-&gt;block_num) );</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="keywordflow">if</span>( <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.revision() &gt; <a class="code" href="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a.html#af1ddbd95476e5e9b1a83b0bf6667428a">head</a>-&gt;block_num ) {</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;         wlog( <span class="stringliteral">&quot;warning: database revision (${db}) is greater than head block number (${head}), &quot;</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;               <span class="stringliteral">&quot;attempting to undo pending changes&quot;</span>,</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;               (<span class="stringliteral">&quot;db&quot;</span>,<a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.revision())(<span class="stringliteral">&quot;head&quot;</span>,<a class="code" href="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a.html#af1ddbd95476e5e9b1a83b0bf6667428a">head</a>-&gt;block_num) );</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      }</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <span class="keywordflow">while</span>( <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.revision() &gt; <a class="code" href="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a.html#af1ddbd95476e5e9b1a83b0bf6667428a">head</a>-&gt;block_num ) {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;         <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.undo();</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      }</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;   }</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a8f54c478a172bdd2d3fa523fdb30d144.html#a8f54c478a172bdd2d3fa523fdb30d144">  256</a></span>&#160;   <a class="code" href="structeosio_1_1chain_1_1controller__impl_a8f54c478a172bdd2d3fa523fdb30d144.html#a8f54c478a172bdd2d3fa523fdb30d144">~controller_impl</a>() {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a59302140653329127e39e4bb54bd0ba8.html#a59302140653329127e39e4bb54bd0ba8">pending</a>.reset();</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a1e289b420cc20017f3e71ba22796103a.html#a1e289b420cc20017f3e71ba22796103a">fork_db</a>.<a class="code" href="classeosio_1_1chain_1_1fork__database_ae3d07c1d16a79bb7f9d47ef0e972656b.html#ae3d07c1d16a79bb7f9d47ef0e972656b">close</a>();</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a.html#af1ddbd95476e5e9b1a83b0bf6667428a">head</a> &amp;&amp; <a class="code" href="structeosio_1_1chain_1_1controller__impl_ab5c1e9a69d9cfd3beb3ec87676b2de48.html#ab5c1e9a69d9cfd3beb3ec87676b2de48">blog</a>.<a class="code" href="classeosio_1_1chain_1_1block__log_a3afac3abf8906f2491c58110fca00155.html#a3afac3abf8906f2491c58110fca00155">read_head</a>())</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;         edump((<a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.revision())(<a class="code" href="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a.html#af1ddbd95476e5e9b1a83b0bf6667428a">head</a>-&gt;block_num)(<a class="code" href="structeosio_1_1chain_1_1controller__impl_ab5c1e9a69d9cfd3beb3ec87676b2de48.html#ab5c1e9a69d9cfd3beb3ec87676b2de48">blog</a>.<a class="code" href="classeosio_1_1chain_1_1block__log_a3afac3abf8906f2491c58110fca00155.html#a3afac3abf8906f2491c58110fca00155">read_head</a>()-&gt;block_num()));</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.flush();</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a589cc4ccddcc2325401bc7114b2e0f2d.html#a589cc4ccddcc2325401bc7114b2e0f2d">reversible_blocks</a>.flush();</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;   }</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_ac40e393162757df9f0ef076b616dc97c.html#ac40e393162757df9f0ef076b616dc97c">  267</a></span>&#160;   <span class="keywordtype">void</span> <a class="code" href="structeosio_1_1chain_1_1controller__impl_ac40e393162757df9f0ef076b616dc97c.html#ac40e393162757df9f0ef076b616dc97c">add_indices</a>() {</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a589cc4ccddcc2325401bc7114b2e0f2d.html#a589cc4ccddcc2325401bc7114b2e0f2d">reversible_blocks</a>.add_index&lt;<a class="code" href="namespaceeosio_1_1chain_af5042e3b6e189bfd9d666ba6e4e6b00b.html#af5042e3b6e189bfd9d666ba6e4e6b00b">reversible_block_index</a>&gt;();</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.add_index&lt;<a class="code" href="namespaceeosio_1_1chain_a20cdc5f2d77f983c95cdf9fea027099d.html#a20cdc5f2d77f983c95cdf9fea027099d">account_index</a>&gt;();</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.add_index&lt;<a class="code" href="namespaceeosio_1_1chain_af99ca68873873e4f928250e0a52741fb.html#af99ca68873873e4f928250e0a52741fb">account_sequence_index</a>&gt;();</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.add_index&lt;<a class="code" href="namespaceeosio_1_1chain_a1bad8b23919a2869f2a4638b0cccda87.html#a1bad8b23919a2869f2a4638b0cccda87">table_id_multi_index</a>&gt;();</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.add_index&lt;<a class="code" href="namespaceeosio_1_1chain_aeb54dc422fa3fcbf3f8c2df1793da46f.html#aeb54dc422fa3fcbf3f8c2df1793da46f">key_value_index</a>&gt;();</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.add_index&lt;<a class="code" href="namespaceeosio_1_1chain_abda1ad5506d3b359cad3db85da70cff6.html#abda1ad5506d3b359cad3db85da70cff6">index64_index</a>&gt;();</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.add_index&lt;<a class="code" href="namespaceeosio_1_1chain_ae31257e06eed13d1fceba7a5851c8e82.html#ae31257e06eed13d1fceba7a5851c8e82">index128_index</a>&gt;();</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.add_index&lt;<a class="code" href="namespaceeosio_1_1chain_a8ae80d1fa16cf1d2f5f04d54f265fcff.html#a8ae80d1fa16cf1d2f5f04d54f265fcff">index256_index</a>&gt;();</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.add_index&lt;<a class="code" href="namespaceeosio_1_1chain_adf4d23d76329a7feb6669ff6c00c8f76.html#adf4d23d76329a7feb6669ff6c00c8f76">index_double_index</a>&gt;();</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.add_index&lt;<a class="code" href="namespaceeosio_1_1chain_ac7ee942bcbf5a7b5bea07cb651db697e.html#ac7ee942bcbf5a7b5bea07cb651db697e">index_long_double_index</a>&gt;();</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.add_index&lt;<a class="code" href="namespaceeosio_1_1chain_a3f1c90d1dfd7085ab59fa78d47d215e4.html#a3f1c90d1dfd7085ab59fa78d47d215e4">global_property_multi_index</a>&gt;();</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.add_index&lt;<a class="code" href="namespaceeosio_1_1chain_ac54e313144a65a354a663fe6d5cd508a.html#ac54e313144a65a354a663fe6d5cd508a">dynamic_global_property_multi_index</a>&gt;();</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.add_index&lt;<a class="code" href="namespaceeosio_1_1chain_ab169c7a71ffe3673cfedfab745ae7ccd.html#ab169c7a71ffe3673cfedfab745ae7ccd">block_summary_multi_index</a>&gt;();</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.add_index&lt;<a class="code" href="namespaceeosio_1_1chain_a3714f7d86e74d48807be7a70a16462e2.html#a3714f7d86e74d48807be7a70a16462e2">transaction_multi_index</a>&gt;();</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.add_index&lt;<a class="code" href="namespaceeosio_1_1chain_a113a4fa08534159756415238097d0b2b.html#a113a4fa08534159756415238097d0b2b">generated_transaction_multi_index</a>&gt;();</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a7872719d533c96482bda49179dc79f42.html#a7872719d533c96482bda49179dc79f42">authorization</a>.<a class="code" href="classeosio_1_1chain_1_1authorization__manager_af81cfb509b0a2317a79f69d170dbadb3.html#af81cfb509b0a2317a79f69d170dbadb3">add_indices</a>();</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_af826b7e42e964e5942bbb53d6e8cd99a.html#af826b7e42e964e5942bbb53d6e8cd99a">resource_limits</a>.<a class="code" href="classeosio_1_1chain_1_1resource__limits_1_1resource__limits__manager_ae5bf9dae31e77d62b013a6590911f627.html#ae5bf9dae31e77d62b013a6590911f627">add_indices</a>();</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;   }</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_af13c72c9ffae64a8bc75dcb846b5d1d1.html#af13c72c9ffae64a8bc75dcb846b5d1d1">  291</a></span>&#160;   <span class="keywordtype">void</span> <a class="code" href="structeosio_1_1chain_1_1controller__impl_af13c72c9ffae64a8bc75dcb846b5d1d1.html#af13c72c9ffae64a8bc75dcb846b5d1d1">clear_all_undo</a>() {</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      <span class="comment">// Rewind the database to the last irreversible block</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.with_write_lock([&amp;] {</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;         <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.undo_all();</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">         FC_ASSERT(db.revision() == self.head_block_num(),</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">                   &quot;Chainbase revision does not match head block num&quot;,</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">                   (&quot;rev&quot;, db.revision())(&quot;head_block&quot;, self.head_block_num()));</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">                   */</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      });</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;   }</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_ab4ef0a03050f7740fe082fa687ddb9b1.html#ab4ef0a03050f7740fe082fa687ddb9b1">  306</a></span>&#160;   <span class="keywordtype">void</span> <a class="code" href="structeosio_1_1chain_1_1controller__impl_ab4ef0a03050f7740fe082fa687ddb9b1.html#ab4ef0a03050f7740fe082fa687ddb9b1">initialize_fork_db</a>() {</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      wlog( <span class="stringliteral">&quot; Initializing new blockchain with genesis state                  &quot;</span> );</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1producer__schedule__type.html">producer_schedule_type</a> initial_schedule{ 0, {{<a class="code" href="name_8hpp_af9c1edb0e0da55ec6ba09f32f6839529.html#af9c1edb0e0da55ec6ba09f32f6839529">N</a>(<a class="code" href="namespaceeosio.html">eosio</a>), <a class="code" href="structeosio_1_1chain_1_1controller__impl_a94b666c1656f9b21fc2d01e3dfaf4fb9.html#a94b666c1656f9b21fc2d01e3dfaf4fb9">conf</a>.<a class="code" href="structeosio_1_1chain_1_1controller_1_1config_a11b0f8fdb59a89d306fd8f75eeb734a2.html#a11b0f8fdb59a89d306fd8f75eeb734a2">genesis</a>.<a class="code" href="structeosio_1_1chain_1_1genesis__state_a4f41d002ea3a0736293498c178a34a28.html#a4f41d002ea3a0736293498c178a34a28">initial_key</a>}} };</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1block__header__state.html">block_header_state</a> genheader;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      genheader.<a class="code" href="structeosio_1_1chain_1_1block__header__state_a04b4b750a38256cd43112e537618d553.html#a04b4b750a38256cd43112e537618d553">active_schedule</a>       = initial_schedule;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      genheader.<a class="code" href="structeosio_1_1chain_1_1block__header__state_abd0c02b8959779786d000c2510ec500d.html#abd0c02b8959779786d000c2510ec500d">pending_schedule</a>      = initial_schedule;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      genheader.<a class="code" href="structeosio_1_1chain_1_1block__header__state_a1df750fdfdca0431b971cada82a68174.html#a1df750fdfdca0431b971cada82a68174">pending_schedule_hash</a> = fc::sha256::hash(initial_schedule);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      genheader.<a class="code" href="structeosio_1_1chain_1_1block__header__state_a49fa283af011bd3e7ebbea4cac9dd24b.html#a49fa283af011bd3e7ebbea4cac9dd24b">header</a>.<a class="code" href="structeosio_1_1chain_1_1block__header_a0ed33479cde4df295d7c41a388b34220.html#a0ed33479cde4df295d7c41a388b34220">timestamp</a>      = <a class="code" href="structeosio_1_1chain_1_1controller__impl_a94b666c1656f9b21fc2d01e3dfaf4fb9.html#a94b666c1656f9b21fc2d01e3dfaf4fb9">conf</a>.<a class="code" href="structeosio_1_1chain_1_1controller_1_1config_a11b0f8fdb59a89d306fd8f75eeb734a2.html#a11b0f8fdb59a89d306fd8f75eeb734a2">genesis</a>.<a class="code" href="structeosio_1_1chain_1_1genesis__state_ad0bd1ed62be48cca99af294838c38742.html#ad0bd1ed62be48cca99af294838c38742">initial_timestamp</a>;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      genheader.<a class="code" href="structeosio_1_1chain_1_1block__header__state_a49fa283af011bd3e7ebbea4cac9dd24b.html#a49fa283af011bd3e7ebbea4cac9dd24b">header</a>.<a class="code" href="structeosio_1_1chain_1_1block__header_a187c61e659e9590c656507c663b3b9a2.html#a187c61e659e9590c656507c663b3b9a2">action_mroot</a>   = <a class="code" href="structeosio_1_1chain_1_1controller__impl_a94b666c1656f9b21fc2d01e3dfaf4fb9.html#a94b666c1656f9b21fc2d01e3dfaf4fb9">conf</a>.<a class="code" href="structeosio_1_1chain_1_1controller_1_1config_a11b0f8fdb59a89d306fd8f75eeb734a2.html#a11b0f8fdb59a89d306fd8f75eeb734a2">genesis</a>.<a class="code" href="structeosio_1_1chain_1_1genesis__state_a3face836985a26fcbee5c5f69012d16a.html#a3face836985a26fcbee5c5f69012d16a">compute_chain_id</a>();</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      genheader.<a class="code" href="structeosio_1_1chain_1_1block__header__state_ac8906d526bf9072f098e3f9f8cbb15c9.html#ac8906d526bf9072f098e3f9f8cbb15c9">id</a>                    = genheader.<a class="code" href="structeosio_1_1chain_1_1block__header__state_a49fa283af011bd3e7ebbea4cac9dd24b.html#a49fa283af011bd3e7ebbea4cac9dd24b">header</a>.<a class="code" href="structeosio_1_1chain_1_1block__header_a02c9f27bf281917a1caf468e229e9c58.html#a02c9f27bf281917a1caf468e229e9c58">id</a>();</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      genheader.<a class="code" href="structeosio_1_1chain_1_1block__header__state_a3e3f59359928472ef235acb057987bf5.html#a3e3f59359928472ef235acb057987bf5">block_num</a>             = genheader.<a class="code" href="structeosio_1_1chain_1_1block__header__state_a49fa283af011bd3e7ebbea4cac9dd24b.html#a49fa283af011bd3e7ebbea4cac9dd24b">header</a>.<a class="code" href="structeosio_1_1chain_1_1block__header_a743c65588c382c3c1702341b2c84c552.html#a743c65588c382c3c1702341b2c84c552">block_num</a>();</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a.html#af1ddbd95476e5e9b1a83b0bf6667428a">head</a> = std::make_shared&lt;block_state&gt;( genheader );</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a.html#af1ddbd95476e5e9b1a83b0bf6667428a">head</a>-&gt;block = std::make_shared&lt;signed_block&gt;(genheader.<a class="code" href="structeosio_1_1chain_1_1block__header__state_a49fa283af011bd3e7ebbea4cac9dd24b.html#a49fa283af011bd3e7ebbea4cac9dd24b">header</a>);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a1e289b420cc20017f3e71ba22796103a.html#a1e289b420cc20017f3e71ba22796103a">fork_db</a>.<a class="code" href="classeosio_1_1chain_1_1fork__database_acca8c09eb357d95a2fc2e989a40ffc89.html#acca8c09eb357d95a2fc2e989a40ffc89">set</a>( <a class="code" href="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a.html#af1ddbd95476e5e9b1a83b0bf6667428a">head</a> );</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.set_revision( <a class="code" href="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a.html#af1ddbd95476e5e9b1a83b0bf6667428a">head</a>-&gt;block_num );</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_af6a3e729d218d758a39da4dcec11a280.html#af6a3e729d218d758a39da4dcec11a280">initialize_database</a>();</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;   }</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a6e07da740cc105ebe561ab6f3bf69cc8.html#a6e07da740cc105ebe561ab6f3bf69cc8">  327</a></span>&#160;   <span class="keywordtype">void</span> <a class="code" href="structeosio_1_1chain_1_1controller__impl_a6e07da740cc105ebe561ab6f3bf69cc8.html#a6e07da740cc105ebe561ab6f3bf69cc8">create_native_account</a>( <a class="code" href="structeosio_1_1chain_1_1name.html">account_name</a> <a class="code" href="structeosio_1_1chain_1_1name.html">name</a>, <span class="keyword">const</span> <a class="code" href="structeosio_1_1chain_1_1authority.html">authority</a>&amp; owner, <span class="keyword">const</span> <a class="code" href="structeosio_1_1chain_1_1authority.html">authority</a>&amp; active, <span class="keywordtype">bool</span> is_privileged = <span class="keyword">false</span> ) {</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.create&lt;<a class="code" href="classeosio_1_1chain_1_1account__object.html">account_object</a>&gt;([&amp;](<span class="keyword">auto</span>&amp; a) {</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;         a.name = <a class="code" href="structeosio_1_1chain_1_1name.html">name</a>;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;         a.creation_date = <a class="code" href="structeosio_1_1chain_1_1controller__impl_a94b666c1656f9b21fc2d01e3dfaf4fb9.html#a94b666c1656f9b21fc2d01e3dfaf4fb9">conf</a>.<a class="code" href="structeosio_1_1chain_1_1controller_1_1config_a11b0f8fdb59a89d306fd8f75eeb734a2.html#a11b0f8fdb59a89d306fd8f75eeb734a2">genesis</a>.<a class="code" href="structeosio_1_1chain_1_1genesis__state_ad0bd1ed62be48cca99af294838c38742.html#ad0bd1ed62be48cca99af294838c38742">initial_timestamp</a>;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;         a.privileged = is_privileged;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;         <span class="keywordflow">if</span>( <a class="code" href="structeosio_1_1chain_1_1name.html">name</a> == config::system_account_name ) {</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            a.set_abi(<a class="code" href="namespaceeosio_1_1chain_a432018c55e824a3056b823dee7c67f8d.html#a432018c55e824a3056b823dee7c67f8d">eosio_contract_abi</a>(<a class="code" href="structeosio_1_1chain_1_1abi__def.html">abi_def</a>()));</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;         }</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      });</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.create&lt;<a class="code" href="classeosio_1_1chain_1_1account__sequence__object.html">account_sequence_object</a>&gt;([&amp;](<span class="keyword">auto</span> &amp; a) {</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        a.name = <a class="code" href="structeosio_1_1chain_1_1name.html">name</a>;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      });</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; owner_permission  = <a class="code" href="structeosio_1_1chain_1_1controller__impl_a7872719d533c96482bda49179dc79f42.html#a7872719d533c96482bda49179dc79f42">authorization</a>.<a class="code" href="classeosio_1_1chain_1_1authorization__manager_a78089b665cfc36ba15d8fd8be54faad3.html#a78089b665cfc36ba15d8fd8be54faad3">create_permission</a>(<a class="code" href="structeosio_1_1chain_1_1name.html">name</a>, config::owner_name, 0,</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                                                                      owner, <a class="code" href="structeosio_1_1chain_1_1controller__impl_a94b666c1656f9b21fc2d01e3dfaf4fb9.html#a94b666c1656f9b21fc2d01e3dfaf4fb9">conf</a>.<a class="code" href="structeosio_1_1chain_1_1controller_1_1config_a11b0f8fdb59a89d306fd8f75eeb734a2.html#a11b0f8fdb59a89d306fd8f75eeb734a2">genesis</a>.<a class="code" href="structeosio_1_1chain_1_1genesis__state_ad0bd1ed62be48cca99af294838c38742.html#ad0bd1ed62be48cca99af294838c38742">initial_timestamp</a> );</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; active_permission = <a class="code" href="structeosio_1_1chain_1_1controller__impl_a7872719d533c96482bda49179dc79f42.html#a7872719d533c96482bda49179dc79f42">authorization</a>.<a class="code" href="classeosio_1_1chain_1_1authorization__manager_a78089b665cfc36ba15d8fd8be54faad3.html#a78089b665cfc36ba15d8fd8be54faad3">create_permission</a>(<a class="code" href="structeosio_1_1chain_1_1name.html">name</a>, config::active_name, owner_permission.id,</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                                                                      active, <a class="code" href="structeosio_1_1chain_1_1controller__impl_a94b666c1656f9b21fc2d01e3dfaf4fb9.html#a94b666c1656f9b21fc2d01e3dfaf4fb9">conf</a>.<a class="code" href="structeosio_1_1chain_1_1controller_1_1config_a11b0f8fdb59a89d306fd8f75eeb734a2.html#a11b0f8fdb59a89d306fd8f75eeb734a2">genesis</a>.<a class="code" href="structeosio_1_1chain_1_1genesis__state_ad0bd1ed62be48cca99af294838c38742.html#ad0bd1ed62be48cca99af294838c38742">initial_timestamp</a> );</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_af826b7e42e964e5942bbb53d6e8cd99a.html#af826b7e42e964e5942bbb53d6e8cd99a">resource_limits</a>.<a class="code" href="classeosio_1_1chain_1_1resource__limits_1_1resource__limits__manager_a453dba43454b8498745200b37f658b26.html#a453dba43454b8498745200b37f658b26">initialize_account</a>(<a class="code" href="structeosio_1_1chain_1_1name.html">name</a>);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      int64_t ram_delta = config::overhead_per_account_ram_bytes;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      ram_delta += 2*config::billable_size_v&lt;permission_object&gt;;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      ram_delta += owner_permission.auth.get_billable_size();</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      ram_delta += active_permission.auth.get_billable_size();</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_af826b7e42e964e5942bbb53d6e8cd99a.html#af826b7e42e964e5942bbb53d6e8cd99a">resource_limits</a>.<a class="code" href="classeosio_1_1chain_1_1resource__limits_1_1resource__limits__manager_a221e58d79e2b684714cb1acc19da5492.html#a221e58d79e2b684714cb1acc19da5492">add_pending_ram_usage</a>(<a class="code" href="structeosio_1_1chain_1_1name.html">name</a>, ram_delta);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_af826b7e42e964e5942bbb53d6e8cd99a.html#af826b7e42e964e5942bbb53d6e8cd99a">resource_limits</a>.<a class="code" href="classeosio_1_1chain_1_1resource__limits_1_1resource__limits__manager_a0e777aedcff5772d317ff6b56c7b655b.html#a0e777aedcff5772d317ff6b56c7b655b">verify_account_ram_usage</a>(<a class="code" href="structeosio_1_1chain_1_1name.html">name</a>);</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;   }</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_af6a3e729d218d758a39da4dcec11a280.html#af6a3e729d218d758a39da4dcec11a280">  357</a></span>&#160;   <span class="keywordtype">void</span> <a class="code" href="structeosio_1_1chain_1_1controller__impl_af6a3e729d218d758a39da4dcec11a280.html#af6a3e729d218d758a39da4dcec11a280">initialize_database</a>() {</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      <span class="comment">// Initialize block summary index</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 0x10000; i++)</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;         <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.create&lt;<a class="code" href="classeosio_1_1chain_1_1block__summary__object.html">block_summary_object</a>&gt;([&amp;](<a class="code" href="classeosio_1_1chain_1_1block__summary__object.html">block_summary_object</a>&amp;) {});</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; tapos_block_summary = <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.get&lt;<a class="code" href="classeosio_1_1chain_1_1block__summary__object.html">block_summary_object</a>&gt;(1);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.modify( tapos_block_summary, [&amp;]( <span class="keyword">auto</span>&amp; bs ) {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        bs.block_id = <a class="code" href="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a.html#af1ddbd95476e5e9b1a83b0bf6667428a">head</a>-&gt;id;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      });</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a94b666c1656f9b21fc2d01e3dfaf4fb9.html#a94b666c1656f9b21fc2d01e3dfaf4fb9">conf</a>.<a class="code" href="structeosio_1_1chain_1_1controller_1_1config_a11b0f8fdb59a89d306fd8f75eeb734a2.html#a11b0f8fdb59a89d306fd8f75eeb734a2">genesis</a>.<a class="code" href="structeosio_1_1chain_1_1genesis__state_a1a52eef6a3a907b99a7539991200f03d.html#a1a52eef6a3a907b99a7539991200f03d">initial_configuration</a>.<a class="code" href="structeosio_1_1chain_1_1chain__config_a57ec7cb5cdb3e6f1f63132f2f51b3ffb.html#a57ec7cb5cdb3e6f1f63132f2f51b3ffb">validate</a>();</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.create&lt;<a class="code" href="classeosio_1_1chain_1_1global__property__object.html">global_property_object</a>&gt;([&amp;](<span class="keyword">auto</span>&amp; gpo ){</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        gpo.configuration = <a class="code" href="structeosio_1_1chain_1_1controller__impl_a94b666c1656f9b21fc2d01e3dfaf4fb9.html#a94b666c1656f9b21fc2d01e3dfaf4fb9">conf</a>.<a class="code" href="structeosio_1_1chain_1_1controller_1_1config_a11b0f8fdb59a89d306fd8f75eeb734a2.html#a11b0f8fdb59a89d306fd8f75eeb734a2">genesis</a>.<a class="code" href="structeosio_1_1chain_1_1genesis__state_a1a52eef6a3a907b99a7539991200f03d.html#a1a52eef6a3a907b99a7539991200f03d">initial_configuration</a>;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      });</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.create&lt;<a class="code" href="classeosio_1_1chain_1_1dynamic__global__property__object.html">dynamic_global_property_object</a>&gt;([](<span class="keyword">auto</span>&amp;){});</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a7872719d533c96482bda49179dc79f42.html#a7872719d533c96482bda49179dc79f42">authorization</a>.<a class="code" href="classeosio_1_1chain_1_1authorization__manager_ad1f330edc0e8067d0118657da09f5994.html#ad1f330edc0e8067d0118657da09f5994">initialize_database</a>();</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_af826b7e42e964e5942bbb53d6e8cd99a.html#af826b7e42e964e5942bbb53d6e8cd99a">resource_limits</a>.<a class="code" href="classeosio_1_1chain_1_1resource__limits_1_1resource__limits__manager_a20d3da9fa3e3c322db28670d4f2e589b.html#a20d3da9fa3e3c322db28670d4f2e589b">initialize_database</a>();</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1authority.html">authority</a> system_auth(<a class="code" href="structeosio_1_1chain_1_1controller__impl_a94b666c1656f9b21fc2d01e3dfaf4fb9.html#a94b666c1656f9b21fc2d01e3dfaf4fb9">conf</a>.<a class="code" href="structeosio_1_1chain_1_1controller_1_1config_a11b0f8fdb59a89d306fd8f75eeb734a2.html#a11b0f8fdb59a89d306fd8f75eeb734a2">genesis</a>.<a class="code" href="structeosio_1_1chain_1_1genesis__state_a4f41d002ea3a0736293498c178a34a28.html#a4f41d002ea3a0736293498c178a34a28">initial_key</a>);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a6e07da740cc105ebe561ab6f3bf69cc8.html#a6e07da740cc105ebe561ab6f3bf69cc8">create_native_account</a>( config::system_account_name, system_auth, system_auth, <span class="keyword">true</span> );</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <span class="keyword">auto</span> empty_authority = <a class="code" href="structeosio_1_1chain_1_1authority.html">authority</a>(1, {}, {});</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      <span class="keyword">auto</span> active_producers_authority = <a class="code" href="structeosio_1_1chain_1_1authority.html">authority</a>(1, {}, {});</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      active_producers_authority.<a class="code" href="structeosio_1_1chain_1_1authority_ae836513329658bea29e24f4122f4f5d6.html#ae836513329658bea29e24f4122f4f5d6">accounts</a>.push_back({{config::system_account_name, config::active_name}, 1});</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a6e07da740cc105ebe561ab6f3bf69cc8.html#a6e07da740cc105ebe561ab6f3bf69cc8">create_native_account</a>( config::null_account_name, empty_authority, empty_authority );</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a6e07da740cc105ebe561ab6f3bf69cc8.html#a6e07da740cc105ebe561ab6f3bf69cc8">create_native_account</a>( config::producers_account_name, empty_authority, active_producers_authority );</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; active_permission       = <a class="code" href="structeosio_1_1chain_1_1controller__impl_a7872719d533c96482bda49179dc79f42.html#a7872719d533c96482bda49179dc79f42">authorization</a>.<a class="code" href="classeosio_1_1chain_1_1authorization__manager_ae85e228f0e9419b747f1c592e6d422b1.html#ae85e228f0e9419b747f1c592e6d422b1">get_permission</a>({config::producers_account_name, config::active_name});</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; majority_permission     = <a class="code" href="structeosio_1_1chain_1_1controller__impl_a7872719d533c96482bda49179dc79f42.html#a7872719d533c96482bda49179dc79f42">authorization</a>.<a class="code" href="classeosio_1_1chain_1_1authorization__manager_a78089b665cfc36ba15d8fd8be54faad3.html#a78089b665cfc36ba15d8fd8be54faad3">create_permission</a>( config::producers_account_name,</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                                                                             config::majority_producers_permission_name,</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                                                                             active_permission.id,</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                                                                             active_producers_authority,</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                                                                             <a class="code" href="structeosio_1_1chain_1_1controller__impl_a94b666c1656f9b21fc2d01e3dfaf4fb9.html#a94b666c1656f9b21fc2d01e3dfaf4fb9">conf</a>.<a class="code" href="structeosio_1_1chain_1_1controller_1_1config_a11b0f8fdb59a89d306fd8f75eeb734a2.html#a11b0f8fdb59a89d306fd8f75eeb734a2">genesis</a>.<a class="code" href="structeosio_1_1chain_1_1genesis__state_ad0bd1ed62be48cca99af294838c38742.html#ad0bd1ed62be48cca99af294838c38742">initial_timestamp</a> );</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; minority_permission     = <a class="code" href="structeosio_1_1chain_1_1controller__impl_a7872719d533c96482bda49179dc79f42.html#a7872719d533c96482bda49179dc79f42">authorization</a>.<a class="code" href="classeosio_1_1chain_1_1authorization__manager_a78089b665cfc36ba15d8fd8be54faad3.html#a78089b665cfc36ba15d8fd8be54faad3">create_permission</a>( config::producers_account_name,</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                                                                             config::minority_producers_permission_name,</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                                                                             majority_permission.id,</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                                                                             active_producers_authority,</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                                                                             <a class="code" href="structeosio_1_1chain_1_1controller__impl_a94b666c1656f9b21fc2d01e3dfaf4fb9.html#a94b666c1656f9b21fc2d01e3dfaf4fb9">conf</a>.<a class="code" href="structeosio_1_1chain_1_1controller_1_1config_a11b0f8fdb59a89d306fd8f75eeb734a2.html#a11b0f8fdb59a89d306fd8f75eeb734a2">genesis</a>.<a class="code" href="structeosio_1_1chain_1_1genesis__state_ad0bd1ed62be48cca99af294838c38742.html#ad0bd1ed62be48cca99af294838c38742">initial_timestamp</a> );</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;   }</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a344c7895a93edd0d2af298a0cd69d720.html#a344c7895a93edd0d2af298a0cd69d720">  400</a></span>&#160;   <span class="keywordtype">void</span> <a class="code" href="structeosio_1_1chain_1_1controller__impl_a344c7895a93edd0d2af298a0cd69d720.html#a344c7895a93edd0d2af298a0cd69d720">commit_block</a>( <span class="keywordtype">bool</span> add_to_fork_db ) {</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <span class="keywordflow">if</span>( add_to_fork_db ) {</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;         <a class="code" href="structeosio_1_1chain_1_1controller__impl_a59302140653329127e39e4bb54bd0ba8.html#a59302140653329127e39e4bb54bd0ba8">pending</a>-&gt;_pending_block_state-&gt;validated = <span class="keyword">true</span>;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;         <span class="keyword">auto</span> new_bsp = <a class="code" href="structeosio_1_1chain_1_1controller__impl_a1e289b420cc20017f3e71ba22796103a.html#a1e289b420cc20017f3e71ba22796103a">fork_db</a>.<a class="code" href="classeosio_1_1chain_1_1fork__database_a76e682087ff59329225dbe4bad63c3c9.html#a76e682087ff59329225dbe4bad63c3c9">add</a>( <a class="code" href="structeosio_1_1chain_1_1controller__impl_a59302140653329127e39e4bb54bd0ba8.html#a59302140653329127e39e4bb54bd0ba8">pending</a>-&gt;_pending_block_state );</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;         <a class="code" href="structeosio_1_1chain_1_1controller__impl_a5e1cd636c73b6f40e125abcfd0703451.html#a5e1cd636c73b6f40e125abcfd0703451">emit</a>( <span class="keyword">self</span>.accepted_block_header, <a class="code" href="structeosio_1_1chain_1_1controller__impl_a59302140653329127e39e4bb54bd0ba8.html#a59302140653329127e39e4bb54bd0ba8">pending</a>-&gt;_pending_block_state );</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;         <a class="code" href="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a.html#af1ddbd95476e5e9b1a83b0bf6667428a">head</a> = <a class="code" href="structeosio_1_1chain_1_1controller__impl_a1e289b420cc20017f3e71ba22796103a.html#a1e289b420cc20017f3e71ba22796103a">fork_db</a>.<a class="code" href="classeosio_1_1chain_1_1fork__database_a6c741acfeaa00a41fb5bd3b76b8408dd.html#a6c741acfeaa00a41fb5bd3b76b8408dd">head</a>();</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;         FC_ASSERT( new_bsp == <a class="code" href="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a.html#af1ddbd95476e5e9b1a83b0bf6667428a">head</a>, <span class="stringliteral">&quot;committed block did not become the new head in fork database&quot;</span> );</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      }</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="comment">//    ilog((fc::json::to_pretty_string(*pending-&gt;_pending_block_state-&gt;block)));</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a5e1cd636c73b6f40e125abcfd0703451.html#a5e1cd636c73b6f40e125abcfd0703451">emit</a>( <span class="keyword">self</span>.accepted_block, <a class="code" href="structeosio_1_1chain_1_1controller__impl_a59302140653329127e39e4bb54bd0ba8.html#a59302140653329127e39e4bb54bd0ba8">pending</a>-&gt;_pending_block_state );</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <span class="keywordflow">if</span>( !<a class="code" href="structeosio_1_1chain_1_1controller__impl_afc114a9bfeaf2673c72b095dde4700e5.html#afc114a9bfeaf2673c72b095dde4700e5">replaying</a> ) {</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;         <a class="code" href="structeosio_1_1chain_1_1controller__impl_a589cc4ccddcc2325401bc7114b2e0f2d.html#a589cc4ccddcc2325401bc7114b2e0f2d">reversible_blocks</a>.create&lt;<a class="code" href="classeosio_1_1chain_1_1reversible__block__object.html">reversible_block_object</a>&gt;( [&amp;]( <span class="keyword">auto</span>&amp; ubo ) {</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            ubo.blocknum = <a class="code" href="structeosio_1_1chain_1_1controller__impl_a59302140653329127e39e4bb54bd0ba8.html#a59302140653329127e39e4bb54bd0ba8">pending</a>-&gt;_pending_block_state-&gt;block_num;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            ubo.set_block( <a class="code" href="structeosio_1_1chain_1_1controller__impl_a59302140653329127e39e4bb54bd0ba8.html#a59302140653329127e39e4bb54bd0ba8">pending</a>-&gt;_pending_block_state-&gt;block );</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;         });</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      }</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a59302140653329127e39e4bb54bd0ba8.html#a59302140653329127e39e4bb54bd0ba8">pending</a>-&gt;push();</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1controller__impl_a59302140653329127e39e4bb54bd0ba8.html#a59302140653329127e39e4bb54bd0ba8">pending</a>.reset();</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;   }</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;   <span class="comment">// The returned scoped_exit should not exceed the lifetime of the pending which existed when make_block_restore_point was called.</span></div><div class="line"><a name="l00426"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a1295267c273db02724675e38215ea81f.html#a1295267c273db02724675e38215ea81f">  426</a></span>&#160;   fc::scoped_exit&lt;std::function&lt;void()&gt;&gt; <a class="code" href="structeosio_1_1chain_1_1controller__impl_a1295267c273db02724675e38215ea81f.html#a1295267c273db02724675e38215ea81f">make_block_restore_point</a>() {</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      <span class="keyword">auto</span> orig_block_transactions_size = <a class="code" href="structeosio_1_1chain_1_1controller__impl_a59302140653329127e39e4bb54bd0ba8.html#a59302140653329127e39e4bb54bd0ba8">pending</a>-&gt;_pending_block_state-&gt;block-&gt;transactions.size();</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      <span class="keyword">auto</span> orig_state_transactions_size = <a class="code" href="structeosio_1_1chain_1_1controller__impl_a59302140653329127e39e4bb54bd0ba8.html#a59302140653329127e39e4bb54bd0ba8">pending</a>-&gt;_pending_block_state-&gt;trxs.size();</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <span class="keyword">auto</span> orig_state_actions_size      = <a class="code" href="structeosio_1_1chain_1_1controller__impl_a59302140653329127e39e4bb54bd0ba8.html#a59302140653329127e39e4bb54bd0ba8">pending</a>-&gt;_actions.size();</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      std::function&lt;void()&gt; callback = [<span class="keyword">this</span>,</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                                        orig_block_transactions_size,</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                                        orig_state_transactions_size,</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                                        orig_state_actions_size]()</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      {</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;         <a class="code" href="structeosio_1_1chain_1_1controller__impl_a59302140653329127e39e4bb54bd0ba8.html#a59302140653329127e39e4bb54bd0ba8">pending</a>-&gt;_pending_block_state-&gt;block-&gt;transactions.resize(orig_block_transactions_size);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;         <a class="code" href="structeosio_1_1chain_1_1controller__impl_a59302140653329127e39e4bb54bd0ba8.html#a59302140653329127e39e4bb54bd0ba8">pending</a>-&gt;_pending_block_state-&gt;trxs.resize(orig_state_transactions_size);</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;         <a class="code" href="structeosio_1_1chain_1_1controller__impl_a59302140653329127e39e4bb54bd0ba8.html#a59302140653329127e39e4bb54bd0ba8">pending</a>-&gt;_actions.resize(orig_state_actions_size);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      };</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <span class="keywordflow">return</span> fc::make_scoped_exit( std::move(callback) );</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;   }</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div><div class="line"><a name="l00444"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a32412d6102d6e878aaec56ae64cb523e.html#a32412d6102d6e878aaec56ae64cb523e">  444</a></span>&#160;   <a class="code" href="namespaceeosio_1_1chain_a8fd103739c49a43cea9f4ad9633a6fa7.html#a8fd103739c49a43cea9f4ad9633a6fa7">transaction_trace_ptr</a> <a class="code" href="structeosio_1_1chain_1_1controller__impl_a32412d6102d6e878aaec56ae64cb523e.html#a32412d6102d6e878aaec56ae64cb523e">apply_onerror</a>( <span class="keyword">const</span> <a class="code" href="classeosio_1_1chain_1_1generated__transaction__object.html">generated_transaction_object</a>&amp; gto,</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                                        fc::time_point deadline,</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                                        fc::time_point start,</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                                        uint32_t billed_cpu_time_us) {</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1signed__transaction.html">signed_transaction</a> etrx;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      <span class="comment">// Deliver onerror action containing the failed deferred transaction directly back to the sender.</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      etrx.<a class="code" href="structeosio_1_1chain_1_1transaction_a768465b5929ca1291b303294f353b1c5.html#a768465b5929ca1291b303294f353b1c5">actions</a>.emplace_back( vector&lt;permission_level&gt;{},</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                                 <a class="code" href="structeosio_1_1chain_1_1onerror.html">onerror</a>( gto.sender_id, gto.packed_trx.data(), gto.packed_trx.size() ) );</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      etrx.<a class="code" href="structeosio_1_1chain_1_1transaction__header_acb8d4b05d574db9550dda7ae24f62d3e.html#acb8d4b05d574db9550dda7ae24f62d3e">expiration</a> = <span class="keyword">self</span>.pending_block_time() + fc::microseconds(999<span class="stringliteral">&#39;999); // Round up to avoid appearing expired</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="stringliteral">      etrx.set_reference_block( self.head_block_id() );</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="stringliteral">      transaction_context trx_context( self, etrx, etrx.id(), start );</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="stringliteral">      trx_context.deadline = deadline;</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="stringliteral">      trx_context.billed_cpu_time_us = billed_cpu_time_us;</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="stringliteral">      transaction_trace_ptr trace = trx_context.trace;</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="stringliteral">      try {</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="stringliteral">         trx_context.init_for_implicit_trx();</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="stringliteral">         trx_context.published = gto.published;</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="stringliteral">         trx_context.trace-&gt;action_traces.emplace_back();</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="stringliteral">         trx_context.dispatch_action( trx_context.trace-&gt;action_traces.back(), etrx.actions.back(), gto.sender );</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="stringliteral">         trx_context.finalize(); // Automatically rounds up network and CPU usage in trace and bills payers if successful</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="stringliteral">         auto restore = make_block_restore_point();</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="stringliteral">         trace-&gt;receipt = push_receipt( gto.trx_id, transaction_receipt::soft_fail,</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="stringliteral">                                        trx_context.billed_cpu_time_us, trace-&gt;net_usage );</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="stringliteral">         fc::move_append( pending-&gt;_actions, move(trx_context.executed) );</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="stringliteral">         emit( self.applied_transaction, trace );</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="stringliteral">         trx_context.squash();</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="stringliteral">         restore.cancel();</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="stringliteral">         return trace;</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="stringliteral">      } catch( const fc::exception&amp; e ) {</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="stringliteral">         trace-&gt;except = e;</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="stringliteral">         trace-&gt;except_ptr = std::current_exception();</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="stringliteral">      }</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="stringliteral">      return trace;</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00483"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a83f16ac43263687ab137fecb5d51c31c.html#a83f16ac43263687ab137fecb5d51c31c">  483</a></span>&#160;<span class="stringliteral">   void remove_scheduled_transaction( const generated_transaction_object&amp; gto ) {</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="stringliteral">      resource_limits.add_pending_ram_usage(</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="stringliteral">         gto.payer,</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="stringliteral">         -(config::billable_size_v&lt;generated_transaction_object&gt; + gto.packed_trx.size())</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="stringliteral">      );</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="stringliteral">      // No need to verify_account_ram_usage since we are only reducing memory</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="stringliteral">      db.remove( gto );</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00493"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a2b8ac9e6f7d05cd432af95ae0a78ad17.html#a2b8ac9e6f7d05cd432af95ae0a78ad17">  493</a></span>&#160;<span class="stringliteral">   bool failure_is_subjective( const fc::exception&amp; e ) {</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="stringliteral">      auto code = e.code();</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="stringliteral">      return (code == block_net_usage_exceeded::code_value) ||</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="stringliteral">             (code == block_cpu_usage_exceeded::code_value) ||</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="stringliteral">             (code == deadline_exception::code_value)       ||</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="stringliteral">             (code == leeway_deadline_exception::code_value);</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00501"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_afa9d9bac8ff956fcb73e21bd79c42746.html#afa9d9bac8ff956fcb73e21bd79c42746">  501</a></span>&#160;<span class="stringliteral">   transaction_trace_ptr push_scheduled_transaction( const transaction_id_type&amp; trxid, fc::time_point deadline, uint32_t billed_cpu_time_us ) {</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="stringliteral">      const auto&amp; idx = db.get_index&lt;generated_transaction_multi_index,by_trx_id&gt;();</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="stringliteral">      auto itr = idx.find( trxid );</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="stringliteral">      FC_ASSERT( itr != idx.end(), &quot;unknown transaction&quot; );</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="stringliteral">      return push_scheduled_transaction( *itr, deadline, billed_cpu_time_us );</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00508"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a20d752ccf577670b7933b7e8e6c4f14b.html#a20d752ccf577670b7933b7e8e6c4f14b">  508</a></span>&#160;<span class="stringliteral">   transaction_trace_ptr push_scheduled_transaction( const generated_transaction_object&amp; gto, fc::time_point deadline, uint32_t billed_cpu_time_us )</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="stringliteral">   { try {</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="stringliteral">      auto undo_session = db.start_undo_session(true);</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="stringliteral">      fc::datastream&lt;const char*&gt; ds( gto.packed_trx.data(), gto.packed_trx.size() );</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="stringliteral">      auto remove_retained_state = fc::make_scoped_exit([&amp;, this](){</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="stringliteral">         remove_scheduled_transaction(gto);</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="stringliteral">      });</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="stringliteral">      FC_ASSERT( gto.delay_until &lt;= self.pending_block_time(), &quot;this transaction isn&#39;</span>t ready<span class="stringliteral">&quot;,</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="stringliteral">                 (&quot;</span>gto.delay_until<span class="stringliteral">&quot;,gto.delay_until)(&quot;</span>pbt<span class="stringliteral">&quot;,self.pending_block_time())          );</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="stringliteral">      if( gto.expiration &lt; self.pending_block_time() ) {</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="stringliteral">         auto trace = std::make_shared&lt;transaction_trace&gt;();</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="stringliteral">         trace-&gt;id = gto.trx_id;</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="stringliteral">         trace-&gt;scheduled = false;</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="stringliteral">         trace-&gt;receipt = push_receipt( gto.trx_id, transaction_receipt::expired, billed_cpu_time_us, 0 ); // expire the transaction</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="stringliteral">         undo_session.squash();</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="stringliteral">         return trace;</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="stringliteral">      }</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="stringliteral">      signed_transaction dtrx;</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="stringliteral">      fc::raw::unpack(ds,static_cast&lt;transaction&amp;&gt;(dtrx) );</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="stringliteral">      transaction_context trx_context( self, dtrx, gto.trx_id );</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="stringliteral">      trx_context.deadline = deadline;</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="stringliteral">      trx_context.billed_cpu_time_us = billed_cpu_time_us;</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="stringliteral">      transaction_trace_ptr trace = trx_context.trace;</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="stringliteral">      flat_set&lt;account_name&gt;  bill_to_accounts;</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="stringliteral">      try {</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="stringliteral">         trx_context.init_for_deferred_trx( gto.published );</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="stringliteral">         bill_to_accounts = trx_context.bill_to_accounts;</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="stringliteral">         trx_context.exec();</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="stringliteral">         trx_context.finalize(); // Automatically rounds up network and CPU usage in trace and bills payers if successful</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="stringliteral">         auto restore = make_block_restore_point();</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="stringliteral">         trace-&gt;receipt = push_receipt( gto.trx_id,</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="stringliteral">                                        transaction_receipt::executed,</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="stringliteral">                                        trx_context.billed_cpu_time_us,</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="stringliteral">                                        trace-&gt;net_usage );</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="stringliteral">         fc::move_append( pending-&gt;_actions, move(trx_context.executed) );</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="stringliteral">         emit( self.applied_transaction, trace );</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="stringliteral">         trx_context.squash();</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="stringliteral">         undo_session.squash();</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="stringliteral">         restore.cancel();</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="stringliteral">         return trace;</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="stringliteral">      } catch( const fc::exception&amp; e ) {</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="stringliteral">         trace-&gt;except = e;</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="stringliteral">         trace-&gt;except_ptr = std::current_exception();</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="stringliteral">         trace-&gt;elapsed = fc::time_point::now() - trx_context.start;</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="stringliteral">      }</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="stringliteral">      trx_context.undo_session.undo();</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="stringliteral">      // Only soft or hard failure logic below:</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="stringliteral">      if( gto.sender != account_name() &amp;&amp; !failure_is_subjective(*trace-&gt;except)) {</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="stringliteral">         // Attempt error handling for the generated transaction.</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="stringliteral">         edump((trace-&gt;except-&gt;to_detail_string()));</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="stringliteral">         auto error_trace = apply_onerror( gto, deadline, trx_context.start, trx_context.billed_cpu_time_us );</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="stringliteral">         error_trace-&gt;failed_dtrx_trace = trace;</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="stringliteral">         trace = error_trace;</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="stringliteral">         if( !trace-&gt;except_ptr ) {</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="stringliteral">            undo_session.squash();</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="stringliteral">            return trace;</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="stringliteral">         }</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="stringliteral">      }</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="stringliteral">      // Only hard failure OR subjective failure logic below:</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="stringliteral">      trace-&gt;elapsed = fc::time_point::now() - trx_context.start;</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="stringliteral">      resource_limits.add_transaction_usage( bill_to_accounts, trx_context.billed_cpu_time_us, 0,</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="stringliteral">                                             block_timestamp_type(self.pending_block_time()).slot ); // Should never fail</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="stringliteral">      if (failure_is_subjective(*trace-&gt;except)) {</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="stringliteral">         // this is a subjective failure, don&#39;t remove the retained state so it can be</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="stringliteral">         // retried at a later time and don&#39;t include any artifact of the transaction in the pending block</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="stringliteral">         remove_retained_state.cancel();</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="stringliteral">      } else {</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="stringliteral">         trace-&gt;receipt = push_receipt(gto.trx_id, transaction_receipt::hard_fail, trx_context.billed_cpu_time_us, 0);</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="stringliteral">         emit( self.applied_transaction, trace );</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="stringliteral">         undo_session.squash();</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="stringliteral">      }</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="stringliteral">      return trace;</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="stringliteral">   } FC_CAPTURE_AND_RETHROW() } /// push_scheduled_transaction</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="stringliteral">   template&lt;typename T&gt;</span></div><div class="line"><a name="l00603"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_ae6ff60a769c2afe595f7a165062d1636.html#ae6ff60a769c2afe595f7a165062d1636">  603</a></span>&#160;<span class="stringliteral">   const transaction_receipt&amp; push_receipt( const T&amp; trx, transaction_receipt_header::status_enum status,</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="stringliteral">                                            uint64_t cpu_usage_us, uint64_t net_usage ) {</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="stringliteral">      uint64_t net_usage_words = net_usage / 8;</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="stringliteral">      FC_ASSERT( net_usage_words*8 == net_usage, &quot;</span>net_usage is not divisible by 8<span class="stringliteral">&quot; );</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="stringliteral">      pending-&gt;_pending_block_state-&gt;block-&gt;transactions.emplace_back( trx );</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="stringliteral">      transaction_receipt&amp; r = pending-&gt;_pending_block_state-&gt;block-&gt;transactions.back();</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="stringliteral">      r.cpu_usage_us         = cpu_usage_us;</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="stringliteral">      r.net_usage_words      = net_usage_words;</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="stringliteral">      r.status               = status;</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="stringliteral">      return r;</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00620"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_aac51b235fe996e5515581663e586a889.html#aac51b235fe996e5515581663e586a889">  620</a></span>&#160;<span class="stringliteral">   transaction_trace_ptr push_transaction( const transaction_metadata_ptr&amp; trx,</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="stringliteral">                                           fc::time_point deadline,</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="stringliteral">                                           bool implicit,</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="stringliteral">                                           uint32_t billed_cpu_time_us  )</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="stringliteral">   {</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="stringliteral">      FC_ASSERT(deadline != fc::time_point(), &quot;</span>deadline cannot be uninitialized<span class="stringliteral">&quot;);</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="stringliteral">      transaction_trace_ptr trace;</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="stringliteral">      try {</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="stringliteral">         transaction_context trx_context(self, trx-&gt;trx, trx-&gt;id);</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="stringliteral">         trx_context.deadline = deadline;</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="stringliteral">         trx_context.billed_cpu_time_us = billed_cpu_time_us;</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="stringliteral">         trace = trx_context.trace;</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="stringliteral">         try {</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="stringliteral">            if( implicit ) {</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="stringliteral">               trx_context.init_for_implicit_trx();</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="stringliteral">            } else {</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="stringliteral">               trx_context.init_for_input_trx( trx-&gt;packed_trx.get_unprunable_size(),</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="stringliteral">                                               trx-&gt;packed_trx.get_prunable_size(),</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="stringliteral">                                               trx-&gt;trx.signatures.size() );</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="stringliteral">            }</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="stringliteral">            if( !implicit &amp;&amp; pending-&gt;_block_status == controller::block_status::incomplete ) {</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="stringliteral">               check_actor_list( trx_context.bill_to_accounts ); // Assumes bill_to_accounts is the set of actors authorizing the transaction</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="stringliteral">            }</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="stringliteral">            trx_context.delay = fc::seconds(trx-&gt;trx.delay_sec);</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="stringliteral">            if( !self.skip_auth_check() &amp;&amp; !implicit ) {</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="stringliteral">               authorization.check_authorization(</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="stringliteral">                       trx-&gt;trx.actions,</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="stringliteral">                       trx-&gt;recover_keys( chain_id ),</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="stringliteral">                       {},</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="stringliteral">                       trx_context.delay,</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="stringliteral">                       [](){}</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="stringliteral">                       /*std::bind(&amp;transaction_context::add_cpu_usage_and_check_time, &amp;trx_context,</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="stringliteral">                                 std::placeholders::_1)*/,</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="stringliteral">                       false</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="stringliteral">               );</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="stringliteral">            }</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="stringliteral">            trx_context.exec();</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="stringliteral">            trx_context.finalize(); // Automatically rounds up network and CPU usage in trace and bills payers if successful</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="stringliteral">            auto restore = make_block_restore_point();</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="stringliteral">            if (!implicit) {</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="stringliteral">               transaction_receipt::status_enum s = (trx_context.delay == fc::seconds(0))</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="stringliteral">                                                    ? transaction_receipt::executed</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="stringliteral">                                                    : transaction_receipt::delayed;</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="stringliteral">               trace-&gt;receipt = push_receipt(trx-&gt;packed_trx, s, trx_context.billed_cpu_time_us, trace-&gt;net_usage);</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="stringliteral">               pending-&gt;_pending_block_state-&gt;trxs.emplace_back(trx);</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="stringliteral">            } else {</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="stringliteral">               transaction_receipt_header r;</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="stringliteral">               r.status = transaction_receipt::executed;</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="stringliteral">               r.cpu_usage_us = trx_context.billed_cpu_time_us;</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="stringliteral">               r.net_usage_words = trace-&gt;net_usage / 8;</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="stringliteral">               trace-&gt;receipt = r;</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="stringliteral">            }</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="stringliteral">            fc::move_append(pending-&gt;_actions, move(trx_context.executed));</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="stringliteral">            // call the accept signal but only once for this transaction</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="stringliteral">            if (!trx-&gt;accepted) {</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="stringliteral">               emit( self.accepted_transaction, trx);</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="stringliteral">               trx-&gt;accepted = true;</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="stringliteral">            }</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="stringliteral">            emit(self.applied_transaction, trace);</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="stringliteral">            trx_context.squash();</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="stringliteral">            restore.cancel();</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="stringliteral">            if (!implicit) {</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="stringliteral">               unapplied_transactions.erase( trx-&gt;signed_id );</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="stringliteral">            }</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="stringliteral">            return trace;</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="stringliteral">         } catch (const fc::exception&amp; e) {</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="stringliteral">            trace-&gt;except = e;</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="stringliteral">            trace-&gt;except_ptr = std::current_exception();</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="stringliteral">         }</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="stringliteral">         if (!failure_is_subjective(*trace-&gt;except)) {</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="stringliteral">            unapplied_transactions.erase( trx-&gt;signed_id );</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="stringliteral">         }</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="stringliteral">         return trace;</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="stringliteral">      } FC_CAPTURE_AND_RETHROW((trace))</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="stringliteral">   } /// push_transaction</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00712"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_acf78b6cdf68a1f3a7c5eba204ca7db0c.html#acf78b6cdf68a1f3a7c5eba204ca7db0c">  712</a></span>&#160;<span class="stringliteral">   void start_block( block_timestamp_type when, uint16_t confirm_block_count, controller::block_status s ) {</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="stringliteral">      FC_ASSERT( !pending );</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="stringliteral">      FC_ASSERT( db.revision() == head-&gt;block_num, &quot;</span><span class="stringliteral">&quot;,</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="stringliteral">                (&quot;</span><a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>.revision()<span class="stringliteral">&quot;, db.revision())(&quot;</span>controller_head_block<span class="stringliteral">&quot;, head-&gt;block_num)(&quot;</span>fork_db_head_block<span class="stringliteral">&quot;, fork_db.head()-&gt;block_num) );</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="stringliteral">      auto guard_pending = fc::make_scoped_exit([this](){</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="stringliteral">         pending.reset();</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="stringliteral">      });</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="stringliteral">      pending = db.start_undo_session(true);</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="stringliteral">      pending-&gt;_block_status = s;</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="stringliteral">      pending-&gt;_pending_block_state = std::make_shared&lt;block_state&gt;( *head, when ); // promotes pending schedule (if any) to active</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="stringliteral">      pending-&gt;_pending_block_state-&gt;in_current_chain = true;</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="stringliteral">      pending-&gt;_pending_block_state-&gt;set_confirmed(confirm_block_count);</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="stringliteral">      auto was_pending_promoted = pending-&gt;_pending_block_state-&gt;maybe_promote_pending();</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="stringliteral">      const auto&amp; gpo = db.get&lt;global_property_object&gt;();</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="stringliteral">      if( gpo.proposed_schedule_block_num.valid() &amp;&amp; // if there is a proposed schedule that was proposed in a block ...</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="stringliteral">          ( *gpo.proposed_schedule_block_num &lt;= pending-&gt;_pending_block_state-&gt;dpos_irreversible_blocknum ) &amp;&amp; // ... that has now become irreversible ...</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="stringliteral">          pending-&gt;_pending_block_state-&gt;pending_schedule.producers.size() == 0 &amp;&amp; // ... and there is room for a new pending schedule ...</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="stringliteral">          !was_pending_promoted // ... and not just because it was promoted to active at the start of this block, then:</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="stringliteral">        )</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="stringliteral">      {</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="stringliteral">         // Promote proposed schedule to pending schedule.</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="stringliteral">         if( !replaying ) {</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="stringliteral">            ilog( &quot;</span>promoting proposed schedule (<span class="keyword">set</span> in block ${proposed_num}) to <a class="code" href="structeosio_1_1chain_1_1controller__impl_a59302140653329127e39e4bb54bd0ba8.html#a59302140653329127e39e4bb54bd0ba8">pending</a>; current block: ${n} lib: ${lib} schedule: ${schedule} <span class="stringliteral">&quot;,</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="stringliteral">                  (&quot;</span>proposed_num<span class="stringliteral">&quot;, *gpo.proposed_schedule_block_num)(&quot;</span>n<span class="stringliteral">&quot;, pending-&gt;_pending_block_state-&gt;block_num)</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="stringliteral">                  (&quot;</span>lib<span class="stringliteral">&quot;, pending-&gt;_pending_block_state-&gt;dpos_irreversible_blocknum)</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="stringliteral">                  (&quot;</span>schedule<span class="stringliteral">&quot;, static_cast&lt;producer_schedule_type&gt;(gpo.proposed_schedule) ) );</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="stringliteral">         }</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="stringliteral">         pending-&gt;_pending_block_state-&gt;set_new_producers( gpo.proposed_schedule );</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="stringliteral">         db.modify( gpo, [&amp;]( auto&amp; gp ) {</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="stringliteral">            gp.proposed_schedule_block_num = optional&lt;block_num_type&gt;();</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="stringliteral">            gp.proposed_schedule.clear();</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="stringliteral">         });</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="stringliteral">      }</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="stringliteral">      try {</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="stringliteral">         auto onbtrx = std::make_shared&lt;transaction_metadata&gt;( get_on_block_transaction() );</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="stringliteral">         push_transaction( onbtrx, fc::time_point::maximum(), true, self.get_global_properties().configuration.min_transaction_cpu_usage );</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="stringliteral">      } catch( const boost::interprocess::bad_alloc&amp; e  ) {</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="stringliteral">         elog( &quot;</span>on block transaction failed due to a bad allocation<span class="stringliteral">&quot; );</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="stringliteral">         throw;</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="stringliteral">      } catch( const fc::exception&amp; e ) {</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="stringliteral">         wlog( &quot;</span>on block transaction failed, but shouldn<span class="stringliteral">&#39;t impact block generation, system contract needs update&quot; );</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="stringliteral">         edump((e.to_detail_string()));</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="stringliteral">      } catch( ... ) {</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="stringliteral">         wlog( &quot;on block transaction failed, but shouldn&#39;</span>t impact block generation, system contract needs update<span class="stringliteral">&quot; );</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="stringliteral">      }</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="stringliteral">      clear_expired_input_transactions();</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="stringliteral">      update_producers_authority();</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="stringliteral">      guard_pending.cancel();</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="stringliteral">   } // start_block</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00776"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_aeef69a524c82ed830fde7a6c5688cec0.html#aeef69a524c82ed830fde7a6c5688cec0">  776</a></span>&#160;<span class="stringliteral">   void sign_block( const std::function&lt;signature_type( const digest_type&amp; )&gt;&amp; signer_callback, bool trust  ) {</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="stringliteral">      auto p = pending-&gt;_pending_block_state;</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="stringliteral">      try {</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="stringliteral">         p-&gt;sign( signer_callback, false); //trust );</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="stringliteral">      } catch ( ... ) {</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="stringliteral">         edump(( fc::json::to_pretty_string( p-&gt;header ) ) );</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="stringliteral">         throw;</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="stringliteral">      }</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="stringliteral">      static_cast&lt;signed_block_header&amp;&gt;(*p-&gt;block) = p-&gt;header;</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="stringliteral">   } /// sign_block</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00789"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a9d7057be860b8f7e21980e2f284eebc8.html#a9d7057be860b8f7e21980e2f284eebc8">  789</a></span>&#160;<span class="stringliteral">   void apply_block( const signed_block_ptr&amp; b, controller::block_status s ) { try {</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="stringliteral">      try {</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="stringliteral">         FC_ASSERT( b-&gt;block_extensions.size() == 0, &quot;</span>no supported extensions<span class="stringliteral">&quot; );</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="stringliteral">         start_block( b-&gt;timestamp, b-&gt;confirmed, s );</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="stringliteral">         for( const auto&amp; receipt : b-&gt;transactions ) {</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="stringliteral">            if( receipt.trx.contains&lt;packed_transaction&gt;() ) {</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="stringliteral">               auto&amp; pt = receipt.trx.get&lt;packed_transaction&gt;();</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="stringliteral">               auto mtrx = std::make_shared&lt;transaction_metadata&gt;(pt);</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="stringliteral">               push_transaction( mtrx, fc::time_point::maximum(), false, receipt.cpu_usage_us );</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="stringliteral">            }</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="stringliteral">            else if( receipt.trx.contains&lt;transaction_id_type&gt;() ) {</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="stringliteral">               push_scheduled_transaction( receipt.trx.get&lt;transaction_id_type&gt;(), fc::time_point::maximum(), receipt.cpu_usage_us );</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="stringliteral">            }</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="stringliteral">         }</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="stringliteral">         finalize_block();</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="stringliteral">         sign_block( [&amp;]( const auto&amp; ){ return b-&gt;producer_signature; }, false ); //trust );</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="stringliteral">         // this is implied by the signature passing</span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="stringliteral">         //FC_ASSERT( b-&gt;id() == pending-&gt;_pending_block_state-&gt;block-&gt;id(),</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="stringliteral">         //           &quot;</span>applying block didn<span class="stringliteral">&#39;t produce expected block id&quot; );</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="stringliteral">         commit_block(false);</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="stringliteral">         return;</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="stringliteral">      } catch ( const fc::exception&amp; e ) {</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="stringliteral">         edump((e.to_detail_string()));</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="stringliteral">         abort_block();</span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="stringliteral">         throw;</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="stringliteral">      }</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="stringliteral">   } FC_CAPTURE_AND_RETHROW() } /// apply_block</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00822"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a1f70be89988f853c841f9c62f518ed20.html#a1f70be89988f853c841f9c62f518ed20">  822</a></span>&#160;<span class="stringliteral">   void push_block( const signed_block_ptr&amp; b, controller::block_status s ) {</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="stringliteral">    //  idump((fc::json::to_pretty_string(*b)));</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="stringliteral">      FC_ASSERT(!pending, &quot;it is not valid to push a block when there is a pending block&quot;);</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="stringliteral">      try {</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="stringliteral">         FC_ASSERT( b );</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="stringliteral">         FC_ASSERT( s != controller::block_status::incomplete, &quot;invalid block status for a completed block&quot; );</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="stringliteral">         bool trust = !conf.force_all_checks &amp;&amp; (s == controller::block_status::irreversible || s == controller::block_status::validated);</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="stringliteral">         auto new_header_state = fork_db.add( b, trust );</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="stringliteral">         emit( self.accepted_block_header, new_header_state );</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="stringliteral">         maybe_switch_forks( s );</span></div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="stringliteral">      } FC_LOG_AND_RETHROW( )</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00835"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a4a8e321baa243224464f1e34b9fafa33.html#a4a8e321baa243224464f1e34b9fafa33">  835</a></span>&#160;<span class="stringliteral">   void push_confirmation( const header_confirmation&amp; c ) {</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="stringliteral">      FC_ASSERT(!pending, &quot;it is not valid to push a confirmation when there is a pending block&quot;);</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="stringliteral">      fork_db.add( c );</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="stringliteral">      emit( self.accepted_confirmation, c );</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="stringliteral">      maybe_switch_forks();</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00842"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a81237d80e9dbb846999570912671bee4.html#a81237d80e9dbb846999570912671bee4">  842</a></span>&#160;<span class="stringliteral">   void maybe_switch_forks( controller::block_status s = controller::block_status::complete ) {</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="stringliteral">      auto new_head = fork_db.head();</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="stringliteral">      if( new_head-&gt;header.previous == head-&gt;id ) {</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="stringliteral">         try {</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="stringliteral">            apply_block( new_head-&gt;block, s );</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="stringliteral">            fork_db.mark_in_current_chain( new_head, true );</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="stringliteral">            fork_db.set_validity( new_head, true );</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="stringliteral">            head = new_head;</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="stringliteral">         } catch ( const fc::exception&amp; e ) {</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="stringliteral">            fork_db.set_validity( new_head, false ); // Removes new_head from fork_db index, so no need to mark it as not in the current chain.</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="stringliteral">            throw;</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="stringliteral">         }</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="stringliteral">      } else if( new_head-&gt;id != head-&gt;id ) {</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="stringliteral">         ilog(&quot;switching forks from ${current_head_id} (block number ${current_head_num}) to ${new_head_id} (block number ${new_head_num})&quot;,</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="stringliteral">              (&quot;current_head_id&quot;, head-&gt;id)(&quot;current_head_num&quot;, head-&gt;block_num)(&quot;new_head_id&quot;, new_head-&gt;id)(&quot;new_head_num&quot;, new_head-&gt;block_num) );</span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="stringliteral">         auto branches = fork_db.fetch_branch_from( new_head-&gt;id, head-&gt;id );</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="stringliteral">         for( auto itr = branches.second.begin(); itr != branches.second.end(); ++itr ) {</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="stringliteral">            fork_db.mark_in_current_chain( *itr , false );</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="stringliteral">            pop_block();</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="stringliteral">         }</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="stringliteral">         FC_ASSERT( self.head_block_id() == branches.second.back()-&gt;header.previous,</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="stringliteral">                    &quot;loss of sync between fork_db and chainbase during fork switch&quot; ); // _should_ never fail</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="stringliteral">         for( auto ritr = branches.first.rbegin(); ritr != branches.first.rend(); ++ritr) {</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="stringliteral">            optional&lt;fc::exception&gt; except;</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="stringliteral">            try {</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="stringliteral">               apply_block( (*ritr)-&gt;block, (*ritr)-&gt;validated ? controller::block_status::validated : controller::block_status::complete );</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="stringliteral">               head = *ritr;</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="stringliteral">               fork_db.mark_in_current_chain( *ritr, true );</span></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="stringliteral">               (*ritr)-&gt;validated = true;</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="stringliteral">            }</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="stringliteral">            catch (const fc::exception&amp; e) { except = e; }</span></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="stringliteral">            if (except) {</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="stringliteral">               elog(&quot;exception thrown while switching forks ${e}&quot;, (&quot;e&quot;,except-&gt;to_detail_string()));</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="stringliteral">               while (ritr != branches.first.rend() ) {</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="stringliteral">                  fork_db.set_validity( *ritr, false );</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="stringliteral">                  ++ritr;</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="stringliteral">               }</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="stringliteral">               // pop all blocks from the bad fork</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="stringliteral">               for( auto itr = (ritr + 1).base(); itr != branches.second.end(); ++itr ) {</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="stringliteral">                  fork_db.mark_in_current_chain( *itr , false );</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="stringliteral">                  pop_block();</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="stringliteral">               }</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="stringliteral">               FC_ASSERT( self.head_block_id() == branches.second.back()-&gt;header.previous,</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="stringliteral">                          &quot;loss of sync between fork_db and chainbase during fork switch reversal&quot; ); // _should_ never fail</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="stringliteral">               // re-apply good blocks</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="stringliteral">               for( auto ritr = branches.second.rbegin(); ritr != branches.second.rend(); ++ritr ) {</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="stringliteral">                  apply_block( (*ritr)-&gt;block, controller::block_status::validated /* we previously validated these blocks*/ );</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="stringliteral">                  head = *ritr;</span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="stringliteral">                  fork_db.mark_in_current_chain( *ritr, true );</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="stringliteral">               }</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="stringliteral">               throw *except;</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="stringliteral">            } // end if exception</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="stringliteral">         } /// end for each block in branch</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="stringliteral">         ilog(&quot;successfully switched fork to new head ${new_head_id}&quot;, (&quot;new_head_id&quot;, new_head-&gt;id));</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="stringliteral">      }</span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="stringliteral">   } /// push_block</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00905"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a28db6161c9347abfffee068e2c0a6152.html#a28db6161c9347abfffee068e2c0a6152">  905</a></span>&#160;<span class="stringliteral">   void abort_block() {</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="stringliteral">      if( pending ) {</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="stringliteral">         for( const auto&amp; t : pending-&gt;_pending_block_state-&gt;trxs )</span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="stringliteral">            unapplied_transactions[t-&gt;signed_id] = t;</span></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="stringliteral">         pending.reset();</span></div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="stringliteral">      }</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00914"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a997116728b405cbb9e3205cae8bf0866.html#a997116728b405cbb9e3205cae8bf0866">  914</a></span>&#160;<span class="stringliteral">   bool should_enforce_runtime_limits()const {</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="stringliteral">      return false;</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00918"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a484f20d1ce302e7b2ae7095e1544803f.html#a484f20d1ce302e7b2ae7095e1544803f">  918</a></span>&#160;<span class="stringliteral">   void set_action_merkle() {</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="stringliteral">      vector&lt;digest_type&gt; action_digests;</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="stringliteral">      action_digests.reserve( pending-&gt;_actions.size() );</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="stringliteral">      for( const auto&amp; a : pending-&gt;_actions )</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="stringliteral">         action_digests.emplace_back( a.digest() );</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="stringliteral">      pending-&gt;_pending_block_state-&gt;header.action_mroot = merkle( move(action_digests) );</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00927"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a8d24e81318fb03d7200cdff1560665ef.html#a8d24e81318fb03d7200cdff1560665ef">  927</a></span>&#160;<span class="stringliteral">   void set_trx_merkle() {</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="stringliteral">      vector&lt;digest_type&gt; trx_digests;</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="stringliteral">      const auto&amp; trxs = pending-&gt;_pending_block_state-&gt;block-&gt;transactions;</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="stringliteral">      trx_digests.reserve( trxs.size() );</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="stringliteral">      for( const auto&amp; a : trxs )</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="stringliteral">         trx_digests.emplace_back( a.digest() );</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="stringliteral">      pending-&gt;_pending_block_state-&gt;header.transaction_mroot = merkle( move(trx_digests) );</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00938"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a0ab77adaab6c3fb487e8ce03ec59f2b1.html#a0ab77adaab6c3fb487e8ce03ec59f2b1">  938</a></span>&#160;<span class="stringliteral">   void finalize_block()</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="stringliteral">   {</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="stringliteral">      FC_ASSERT(pending, &quot;it is not valid to finalize when there is no pending block&quot;);</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="stringliteral">      try {</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="stringliteral">      /*</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="stringliteral">      ilog( &quot;finalize block ${n} (${id}) at ${t} by ${p} (${signing_key}); schedule_version: ${v} lib: ${lib} #dtrxs: ${ndtrxs} ${np}&quot;,</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="stringliteral">            (&quot;n&quot;,pending-&gt;_pending_block_state-&gt;block_num)</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="stringliteral">            (&quot;id&quot;,pending-&gt;_pending_block_state-&gt;header.id())</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="stringliteral">            (&quot;t&quot;,pending-&gt;_pending_block_state-&gt;header.timestamp)</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="stringliteral">            (&quot;p&quot;,pending-&gt;_pending_block_state-&gt;header.producer)</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="stringliteral">            (&quot;signing_key&quot;, pending-&gt;_pending_block_state-&gt;block_signing_key)</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="stringliteral">            (&quot;v&quot;,pending-&gt;_pending_block_state-&gt;header.schedule_version)</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="stringliteral">            (&quot;lib&quot;,pending-&gt;_pending_block_state-&gt;dpos_irreversible_blocknum)</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="stringliteral">            (&quot;ndtrxs&quot;,db.get_index&lt;generated_transaction_multi_index,by_trx_id&gt;().size())</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="stringliteral">            (&quot;np&quot;,pending-&gt;_pending_block_state-&gt;header.new_producers)</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="stringliteral">            );</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="stringliteral">      */</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="stringliteral">      // Update resource limits:</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="stringliteral">      resource_limits.process_account_limit_updates();</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="stringliteral">      const auto&amp; chain_config = self.get_global_properties().configuration;</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="stringliteral">      uint32_t max_virtual_mult = 1000;</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="stringliteral">      uint64_t CPU_TARGET = EOS_PERCENT(chain_config.max_block_cpu_usage, chain_config.target_block_cpu_usage_pct);</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="stringliteral">      resource_limits.set_block_parameters(</span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="stringliteral">         { CPU_TARGET, chain_config.max_block_cpu_usage, config::block_cpu_usage_average_window_ms / config::block_interval_ms, max_virtual_mult, {99, 100}, {1000, 999}},</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="stringliteral">         {EOS_PERCENT(chain_config.max_block_net_usage, chain_config.target_block_net_usage_pct), chain_config.max_block_net_usage, config::block_size_average_window_ms / config::block_interval_ms, max_virtual_mult, {99, 100}, {1000, 999}}</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="stringliteral">      );</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="stringliteral">      resource_limits.process_block_usage(pending-&gt;_pending_block_state-&gt;block_num);</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="stringliteral">      set_action_merkle();</span></div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="stringliteral">      set_trx_merkle();</span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="stringliteral">      auto p = pending-&gt;_pending_block_state;</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="stringliteral">      p-&gt;id = p-&gt;header.id();</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="stringliteral">      create_block_summary(p-&gt;id);</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="stringliteral">   } FC_CAPTURE_AND_RETHROW() }</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00979"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a9c4ce47afdc4bee6fa7b8156c5f738ea.html#a9c4ce47afdc4bee6fa7b8156c5f738ea">  979</a></span>&#160;<span class="stringliteral">   void update_producers_authority() {</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="stringliteral">      const auto&amp; producers = pending-&gt;_pending_block_state-&gt;active_schedule.producers;</span></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="stringliteral">      auto update_permission = [&amp;]( auto&amp; permission, auto threshold ) {</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="stringliteral">         auto auth = authority( threshold, {}, {});</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="stringliteral">         for( auto&amp; p : producers ) {</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="stringliteral">            auth.accounts.push_back({{p.producer_name, config::active_name}, 1});</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="stringliteral">         }</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="stringliteral">         if( static_cast&lt;authority&gt;(permission.auth) != auth ) { // TODO: use a more efficient way to check that authority has not changed</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="stringliteral">            db.modify(permission, [&amp;]( auto&amp; po ) {</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="stringliteral">               po.auth = auth;</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="stringliteral">            });</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="stringliteral">         }</span></div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="stringliteral">      };</span></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="stringliteral">      uint32_t num_producers = producers.size();</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="stringliteral">      auto calculate_threshold = [=]( uint32_t numerator, uint32_t denominator ) {</span></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="stringliteral">         return ( (num_producers * numerator) / denominator ) + 1;</span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="stringliteral">      };</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="stringliteral">      update_permission( authorization.get_permission({config::producers_account_name,</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="stringliteral">                                                       config::active_name}),</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="stringliteral">                         calculate_threshold( 2, 3 ) /* more than two-thirds */                      );</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="stringliteral">      update_permission( authorization.get_permission({config::producers_account_name,</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="stringliteral">                                                       config::majority_producers_permission_name}),</span></div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="stringliteral">                         calculate_threshold( 1, 2 ) /* more than one-half */                        );</span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="stringliteral">      update_permission( authorization.get_permission({config::producers_account_name,</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="stringliteral">                                                       config::minority_producers_permission_name}),</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="stringliteral">                         calculate_threshold( 1, 3 ) /* more than one-third */                       );</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="stringliteral">      //TODO: Add tests</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01015"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a5c6fc161f395db1e6ad1a6c0aba26c96.html#a5c6fc161f395db1e6ad1a6c0aba26c96"> 1015</a></span>&#160;<span class="stringliteral">   void create_block_summary(const block_id_type&amp; id) {</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="stringliteral">      auto block_num = block_header::num_from_id(id);</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="stringliteral">      auto sid = block_num &amp; 0xffff;</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="stringliteral">      db.modify( db.get&lt;block_summary_object,by_id&gt;(sid), [&amp;](block_summary_object&amp; bso ) {</span></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="stringliteral">          bso.block_id = id;</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="stringliteral">      });</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01024"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a828054f755bc29bbe54a14342fd8475c.html#a828054f755bc29bbe54a14342fd8475c"> 1024</a></span>&#160;<span class="stringliteral">   void clear_expired_input_transactions() {</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="stringliteral">      //Look for expired transactions in the deduplication list, and remove them.</span></div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="stringliteral">      auto&amp; transaction_idx = db.get_mutable_index&lt;transaction_multi_index&gt;();</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="stringliteral">      const auto&amp; dedupe_index = transaction_idx.indices().get&lt;by_expiration&gt;();</span></div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="stringliteral">      auto now = self.pending_block_time();</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="stringliteral">      while( (!dedupe_index.empty()) &amp;&amp; ( now &gt; fc::time_point(dedupe_index.begin()-&gt;expiration) ) ) {</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="stringliteral">         transaction_idx.remove(*dedupe_index.begin());</span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="stringliteral">      }</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01035"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a37ef5d577ca998240d7315454ae1eaeb.html#a37ef5d577ca998240d7315454ae1eaeb"> 1035</a></span>&#160;<span class="stringliteral">   void check_actor_list( const flat_set&lt;account_name&gt;&amp; actors )const {</span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="stringliteral">      if( conf.actor_whitelist.size() &gt; 0 ) {</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="stringliteral">         vector&lt;account_name&gt; excluded;</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="stringliteral">         excluded.reserve( actors.size() );</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="stringliteral">         set_difference( actors.begin(), actors.end(),</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="stringliteral">                         conf.actor_whitelist.begin(), conf.actor_whitelist.end(),</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="stringliteral">                         std::back_inserter(excluded) );</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="stringliteral">         EOS_ASSERT( excluded.size() == 0, actor_whitelist_exception,</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="stringliteral">                     &quot;authorizing actor(s) in transaction are not on the actor whitelist: ${actors}&quot;,</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="stringliteral">                     (&quot;actors&quot;, excluded)</span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="stringliteral">                   );</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="stringliteral">      } else if( conf.actor_blacklist.size() &gt; 0 ) {</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="stringliteral">         vector&lt;account_name&gt; blacklisted;</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="stringliteral">         blacklisted.reserve( actors.size() );</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="stringliteral">         set_intersection( actors.begin(), actors.end(),</span></div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="stringliteral">                           conf.actor_blacklist.begin(), conf.actor_whitelist.end(),</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="stringliteral">                           std::back_inserter(blacklisted)</span></div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="stringliteral">                         );</span></div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="stringliteral">         EOS_ASSERT( blacklisted.size() == 0, actor_blacklist_exception,</span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="stringliteral">                     &quot;authorizing actor(s) in transaction are on the actor blacklist: ${actors}&quot;,</span></div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="stringliteral">                     (&quot;actors&quot;, blacklisted)</span></div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="stringliteral">                   );</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="stringliteral">      }</span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01060"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_af7a5f0844111ce4f975233ec53556e32.html#af7a5f0844111ce4f975233ec53556e32"> 1060</a></span>&#160;<span class="stringliteral">   void check_contract_list( account_name code )const {</span></div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="stringliteral">      if( conf.contract_whitelist.size() &gt; 0 ) {</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="stringliteral">         EOS_ASSERT( conf.contract_whitelist.find( code ) != conf.contract_whitelist.end(),</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="stringliteral">                     contract_whitelist_exception,</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="stringliteral">                     &quot;account &#39;</span>${<a class="code" href="namespaceeosio_1_1chain_1_1wasm__ops_a4eff4c3a5ad1e8e813e0087e2f72c17b.html#a4eff4c3a5ad1e8e813e0087e2f72c17b">code</a>}<span class="stringliteral">&#39; is not on the contract whitelist&quot;, (&quot;code&quot;, code)</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="stringliteral">                   );</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="stringliteral">      } else if( conf.contract_blacklist.size() &gt; 0 ) {</span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="stringliteral">         EOS_ASSERT( conf.contract_blacklist.find( code ) == conf.contract_blacklist.end(),</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="stringliteral">                     contract_blacklist_exception,</span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="stringliteral">                     &quot;account &#39;</span>${<a class="code" href="namespaceeosio_1_1chain_1_1wasm__ops_a4eff4c3a5ad1e8e813e0087e2f72c17b.html#a4eff4c3a5ad1e8e813e0087e2f72c17b">code</a>}<span class="stringliteral">&#39; is on the contract blacklist&quot;, (&quot;code&quot;, code)</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="stringliteral">                   );</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="stringliteral">      }</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="stringliteral">   /*</span></div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="stringliteral">   bool should_check_tapos()const { return true; }</span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="stringliteral">   void validate_tapos( const transaction&amp; trx )const {</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="stringliteral">      if( !should_check_tapos() ) return;</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="stringliteral">      const auto&amp; tapos_block_summary = db.get&lt;block_summary_object&gt;((uint16_t)trx.ref_block_num);</span></div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="stringliteral">      //Verify TaPoS block summary has correct ID prefix, and that this block&#39;</span>s time is not past the expiration</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;      <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>(trx.verify_reference_block(tapos_block_summary.block_id), invalid_ref_block_exception,</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                 <span class="stringliteral">&quot;Transaction&#39;s reference block did not match. Is this transaction from a different fork?&quot;</span>,</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                 (<span class="stringliteral">&quot;tapos_summary&quot;</span>, tapos_block_summary));</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;   }</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;   */</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;</div><div class="line"><a name="l01094"></a><span class="lineno"><a class="line" href="structeosio_1_1chain_1_1controller__impl_a5bb158405154fc0e794668b8b841c31b.html#a5bb158405154fc0e794668b8b841c31b"> 1094</a></span>&#160;   <a class="code" href="structeosio_1_1chain_1_1signed__transaction.html">signed_transaction</a> <a class="code" href="structeosio_1_1chain_1_1controller__impl_a5bb158405154fc0e794668b8b841c31b.html#a5bb158405154fc0e794668b8b841c31b">get_on_block_transaction</a>()</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;   {</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1action.html">action</a> on_block_act;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;      on_block_act.<a class="code" href="structeosio_1_1chain_1_1action_adb73e3a236a3c11c104c6dd6ebad9429.html#adb73e3a236a3c11c104c6dd6ebad9429">account</a> = config::system_account_name;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;      on_block_act.<a class="code" href="structeosio_1_1chain_1_1action_a902d64826c6d06f1ccb4be01bb7353a2.html#a902d64826c6d06f1ccb4be01bb7353a2">name</a> = <a class="code" href="name_8hpp_af9c1edb0e0da55ec6ba09f32f6839529.html#af9c1edb0e0da55ec6ba09f32f6839529">N</a>(onblock);</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;      on_block_act.<a class="code" href="structeosio_1_1chain_1_1action_a41392a69085f8138021b914c83e6ed9a.html#a41392a69085f8138021b914c83e6ed9a">authorization</a> = vector&lt;permission_level&gt;{{config::system_account_name, config::active_name}};</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;      on_block_act.<a class="code" href="structeosio_1_1chain_1_1action_abbcfcaf717dfd03c1dc0f359754e4ac0.html#abbcfcaf717dfd03c1dc0f359754e4ac0">data</a> = <a class="code" href="namespaceeosio_1_1chain_1_1wasm__ops_a46b5a83fe49f18aeefa8d583086395e1.html#a46b5a83fe49f18aeefa8d583086395e1">fc::raw::pack</a>(<span class="keyword">self</span>.head_block_header());</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;      <a class="code" href="structeosio_1_1chain_1_1signed__transaction.html">signed_transaction</a> trx;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;      trx.<a class="code" href="structeosio_1_1chain_1_1transaction_a768465b5929ca1291b303294f353b1c5.html#a768465b5929ca1291b303294f353b1c5">actions</a>.emplace_back(std::move(on_block_act));</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;      trx.<a class="code" href="structeosio_1_1chain_1_1transaction__header_aad917528c8e713d3fc042210864cef53.html#aad917528c8e713d3fc042210864cef53">set_reference_block</a>(<span class="keyword">self</span>.head_block_id());</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;      trx.<a class="code" href="structeosio_1_1chain_1_1transaction__header_acb8d4b05d574db9550dda7ae24f62d3e.html#acb8d4b05d574db9550dda7ae24f62d3e">expiration</a> = <span class="keyword">self</span>.pending_block_time() + fc::microseconds(999<span class="stringliteral">&#39;999); // Round up to nearest second to avoid appearing expired</span></div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="stringliteral">      return trx;</span></div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="stringliteral">}; /// controller_impl</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01111"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_ac69f0cbb8c3241c60cb0a299effad96f.html#ac69f0cbb8c3241c60cb0a299effad96f"> 1111</a></span>&#160;<span class="stringliteral">const resource_limits_manager&amp;   controller::get_resource_limits_manager()const</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="stringliteral">{</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="stringliteral">   return my-&gt;resource_limits;</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="stringliteral">}</span></div><div class="line"><a name="l01115"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_a64c47d6803dd1d2068de4da5efe04b8b.html#a64c47d6803dd1d2068de4da5efe04b8b"> 1115</a></span>&#160;<span class="stringliteral">resource_limits_manager&amp;         controller::get_mutable_resource_limits_manager()</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;<span class="stringliteral">{</span></div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="stringliteral">   return my-&gt;resource_limits;</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="stringliteral">}</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01120"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_a639302daa7f85438f8df5a8fbe952160.html#a639302daa7f85438f8df5a8fbe952160"> 1120</a></span>&#160;<span class="stringliteral">const authorization_manager&amp;   controller::get_authorization_manager()const</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="stringliteral">{</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="stringliteral">   return my-&gt;authorization;</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="stringliteral">}</span></div><div class="line"><a name="l01124"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_afd0cfc2a2e5adc0964d3591073931d30.html#afd0cfc2a2e5adc0964d3591073931d30"> 1124</a></span>&#160;<span class="stringliteral">authorization_manager&amp;         controller::get_mutable_authorization_manager()</span></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="stringliteral">{</span></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="stringliteral">   return my-&gt;authorization;</span></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="stringliteral">}</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01129"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_a8c45d6ce50f73fd1de60b0447a17ba8a.html#a8c45d6ce50f73fd1de60b0447a17ba8a"> 1129</a></span>&#160;<span class="stringliteral">controller::controller( const controller::config&amp; cfg )</span></div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="stringliteral">:my( new controller_impl( cfg, *this ) )</span></div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="stringliteral">{</span></div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="stringliteral">}</span></div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01134"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_ab4c9c071f2f118ffa3303659039848e7.html#ab4c9c071f2f118ffa3303659039848e7"> 1134</a></span>&#160;<span class="stringliteral">controller::~controller() {</span></div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="stringliteral">   my-&gt;abort_block();</span></div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="stringliteral">}</span></div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01139"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_af5d0917214b8a30ac5c06ac65d31f96a.html#af5d0917214b8a30ac5c06ac65d31f96a"> 1139</a></span>&#160;<span class="stringliteral">void controller::startup() {</span></div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="stringliteral">   // ilog( &quot;${c}&quot;, (&quot;c&quot;,fc::json::to_pretty_string(cfg)) );</span></div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="stringliteral">   my-&gt;add_indices();</span></div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="stringliteral">   my-&gt;head = my-&gt;fork_db.head();</span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="stringliteral">   if( !my-&gt;head ) {</span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="stringliteral">      elog( &quot;No head block in fork db, perhaps we need to replay&quot; );</span></div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="stringliteral">   my-&gt;init();</span></div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="stringliteral">}</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01151"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_a5fa53b350eec65b6a826d039d0286440.html#a5fa53b350eec65b6a826d039d0286440"> 1151</a></span>&#160;<span class="stringliteral">chainbase::database&amp; controller::db()const { return my-&gt;db; }</span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01153"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_addba486fd7b1950664ec7291678fad90.html#addba486fd7b1950664ec7291678fad90"> 1153</a></span>&#160;<span class="stringliteral">fork_database&amp; controller::fork_db()const { return my-&gt;fork_db; }</span></div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01156"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_adcd0d204be28372206474c4e782cb47a.html#adcd0d204be28372206474c4e782cb47a"> 1156</a></span>&#160;<span class="stringliteral">void controller::start_block( block_timestamp_type when, uint16_t confirm_block_count) {</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="stringliteral">   my-&gt;start_block(when, confirm_block_count, block_status::incomplete );</span></div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="stringliteral">}</span></div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01160"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_a81136c7f7bda0f903069fb5186140340.html#a81136c7f7bda0f903069fb5186140340"> 1160</a></span>&#160;<span class="stringliteral">void controller::finalize_block() {</span></div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="stringliteral">   my-&gt;finalize_block();</span></div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="stringliteral">}</span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01164"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_a0c32305d5b9574f37c162c7249b706eb.html#a0c32305d5b9574f37c162c7249b706eb"> 1164</a></span>&#160;<span class="stringliteral">void controller::sign_block( const std::function&lt;signature_type( const digest_type&amp; )&gt;&amp; signer_callback ) {</span></div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="stringliteral">   my-&gt;sign_block( signer_callback, false /* don&#39;</span>t trust */);</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;}</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;</div><div class="line"><a name="l01168"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_a228b725ef94d2c3ac58adb8dde5529ac.html#a228b725ef94d2c3ac58adb8dde5529ac"> 1168</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classeosio_1_1chain_1_1controller_a228b725ef94d2c3ac58adb8dde5529ac.html#a228b725ef94d2c3ac58adb8dde5529ac">controller::commit_block</a>() {</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;   my-&gt;commit_block(<span class="keyword">true</span>);</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;}</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;</div><div class="line"><a name="l01172"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_abb36a4cdea263625153b6f5627b56508.html#abb36a4cdea263625153b6f5627b56508"> 1172</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classeosio_1_1chain_1_1controller_abb36a4cdea263625153b6f5627b56508.html#abb36a4cdea263625153b6f5627b56508">controller::abort_block</a>() {</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;   my-&gt;abort_block();</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;}</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;</div><div class="line"><a name="l01176"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_aec85d64adb4800da30db8bc314cb3843.html#aec85d64adb4800da30db8bc314cb3843"> 1176</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classeosio_1_1chain_1_1controller_aec85d64adb4800da30db8bc314cb3843.html#aec85d64adb4800da30db8bc314cb3843">controller::push_block</a>( <span class="keyword">const</span> <a class="code" href="namespaceeosio_1_1chain_aab529d0705068032cf285096bd8a911b.html#aab529d0705068032cf285096bd8a911b">signed_block_ptr</a>&amp; b, <a class="code" href="classeosio_1_1chain_1_1controller_aefc14531638f18365926345eb19fa2e6.html#aefc14531638f18365926345eb19fa2e6">block_status</a> s ) {</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;   my-&gt;push_block( b, s );</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;}</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;</div><div class="line"><a name="l01180"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_af74b99ec7d2d67db061645b316541a15.html#af74b99ec7d2d67db061645b316541a15"> 1180</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classeosio_1_1chain_1_1controller_af74b99ec7d2d67db061645b316541a15.html#af74b99ec7d2d67db061645b316541a15">controller::push_confirmation</a>( <span class="keyword">const</span> <a class="code" href="structeosio_1_1chain_1_1header__confirmation.html">header_confirmation</a>&amp; c ) {</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;   my-&gt;push_confirmation( c );</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;}</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;</div><div class="line"><a name="l01184"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_aebe63c1592e75a9c9582b18edc695f17.html#aebe63c1592e75a9c9582b18edc695f17"> 1184</a></span>&#160;<a class="code" href="namespaceeosio_1_1chain_a8fd103739c49a43cea9f4ad9633a6fa7.html#a8fd103739c49a43cea9f4ad9633a6fa7">transaction_trace_ptr</a> <a class="code" href="classeosio_1_1chain_1_1controller_aebe63c1592e75a9c9582b18edc695f17.html#aebe63c1592e75a9c9582b18edc695f17">controller::push_transaction</a>( <span class="keyword">const</span> <a class="code" href="namespaceeosio_1_1chain_a2af3155c69a0faecfb5adc06480d3078.html#a2af3155c69a0faecfb5adc06480d3078">transaction_metadata_ptr</a>&amp; trx, fc::time_point deadline, uint32_t billed_cpu_time_us ) {</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;   <span class="keywordflow">return</span> my-&gt;push_transaction(trx, deadline, <span class="keyword">false</span>, billed_cpu_time_us);</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;}</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;</div><div class="line"><a name="l01188"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_acbf89eb28239a61e433cecb1abb1cfcd.html#acbf89eb28239a61e433cecb1abb1cfcd"> 1188</a></span>&#160;<a class="code" href="namespaceeosio_1_1chain_a8fd103739c49a43cea9f4ad9633a6fa7.html#a8fd103739c49a43cea9f4ad9633a6fa7">transaction_trace_ptr</a> <a class="code" href="classeosio_1_1chain_1_1controller_acbf89eb28239a61e433cecb1abb1cfcd.html#acbf89eb28239a61e433cecb1abb1cfcd">controller::push_scheduled_transaction</a>( <span class="keyword">const</span> <a class="code" href="namespaceeosio_1_1chain_ac19fb56771d15ea996c2806a46eeaf25.html#ac19fb56771d15ea996c2806a46eeaf25">transaction_id_type</a>&amp; trxid, fc::time_point deadline, uint32_t billed_cpu_time_us )</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;{</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;   <span class="keywordflow">return</span> my-&gt;push_scheduled_transaction( trxid, deadline, billed_cpu_time_us );</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;}</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;</div><div class="line"><a name="l01193"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_ad4e44163991ff7b3ffbbc3d257007f42.html#ad4e44163991ff7b3ffbbc3d257007f42"> 1193</a></span>&#160;uint32_t <a class="code" href="classeosio_1_1chain_1_1controller_ad4e44163991ff7b3ffbbc3d257007f42.html#ad4e44163991ff7b3ffbbc3d257007f42">controller::head_block_num</a>()<span class="keyword">const </span>{</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;   <span class="keywordflow">return</span> my-&gt;head-&gt;block_num;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;}</div><div class="line"><a name="l01196"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_acff9fd37a1180bbae38d1d4c03ff59e7.html#acff9fd37a1180bbae38d1d4c03ff59e7"> 1196</a></span>&#160;time_point <a class="code" href="classeosio_1_1chain_1_1controller_acff9fd37a1180bbae38d1d4c03ff59e7.html#acff9fd37a1180bbae38d1d4c03ff59e7">controller::head_block_time</a>()<span class="keyword">const </span>{</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;   <span class="keywordflow">return</span> my-&gt;head-&gt;header.timestamp;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;}</div><div class="line"><a name="l01199"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_adcccc8516a37dbd5d37def1aadfe4a82.html#adcccc8516a37dbd5d37def1aadfe4a82"> 1199</a></span>&#160;<a class="code" href="namespaceeosio_1_1chain_afe40963e3dd209e6457f7e482844466f.html#afe40963e3dd209e6457f7e482844466f">block_id_type</a> <a class="code" href="classeosio_1_1chain_1_1controller_adcccc8516a37dbd5d37def1aadfe4a82.html#adcccc8516a37dbd5d37def1aadfe4a82">controller::head_block_id</a>()<span class="keyword">const </span>{</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;   <span class="keywordflow">return</span> my-&gt;head-&gt;id;</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;}</div><div class="line"><a name="l01202"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_ac484cce0ca8770cc52b847e3238a946b.html#ac484cce0ca8770cc52b847e3238a946b"> 1202</a></span>&#160;<a class="code" href="structeosio_1_1chain_1_1name.html">account_name</a>  <a class="code" href="classeosio_1_1chain_1_1controller_ac484cce0ca8770cc52b847e3238a946b.html#ac484cce0ca8770cc52b847e3238a946b">controller::head_block_producer</a>()<span class="keyword">const </span>{</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;   <span class="keywordflow">return</span> my-&gt;head-&gt;header.producer;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;}</div><div class="line"><a name="l01205"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_a95061eb5d26dd7a18c756f4707eb847b.html#a95061eb5d26dd7a18c756f4707eb847b"> 1205</a></span>&#160;<span class="keyword">const</span> <a class="code" href="structeosio_1_1chain_1_1block__header.html">block_header</a>&amp; <a class="code" href="classeosio_1_1chain_1_1controller_a95061eb5d26dd7a18c756f4707eb847b.html#a95061eb5d26dd7a18c756f4707eb847b">controller::head_block_header</a>()<span class="keyword">const </span>{</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;   <span class="keywordflow">return</span> my-&gt;head-&gt;header;</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;}</div><div class="line"><a name="l01208"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_af07f4641c4b3c0bf17b30ff312401d7f.html#af07f4641c4b3c0bf17b30ff312401d7f"> 1208</a></span>&#160;<a class="code" href="namespaceeosio_1_1chain_ae6d914f3a3962e565e36b7c967990d65.html#ae6d914f3a3962e565e36b7c967990d65">block_state_ptr</a> <a class="code" href="classeosio_1_1chain_1_1controller_af07f4641c4b3c0bf17b30ff312401d7f.html#af07f4641c4b3c0bf17b30ff312401d7f">controller::head_block_state</a>()<span class="keyword">const </span>{</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;   <span class="keywordflow">return</span> my-&gt;head;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;}</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;</div><div class="line"><a name="l01212"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_ab1bd65df491557845e333ba71af75c59.html#ab1bd65df491557845e333ba71af75c59"> 1212</a></span>&#160;<a class="code" href="namespaceeosio_1_1chain_ae6d914f3a3962e565e36b7c967990d65.html#ae6d914f3a3962e565e36b7c967990d65">block_state_ptr</a> <a class="code" href="classeosio_1_1chain_1_1controller_ab1bd65df491557845e333ba71af75c59.html#ab1bd65df491557845e333ba71af75c59">controller::pending_block_state</a>()<span class="keyword">const </span>{</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;   <span class="keywordflow">if</span>( my-&gt;pending ) <span class="keywordflow">return</span> my-&gt;pending-&gt;_pending_block_state;</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="namespaceeosio_1_1chain_ae6d914f3a3962e565e36b7c967990d65.html#ae6d914f3a3962e565e36b7c967990d65">block_state_ptr</a>();</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;}</div><div class="line"><a name="l01216"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_a675086138c644442ef3a084e027a7d5a.html#a675086138c644442ef3a084e027a7d5a"> 1216</a></span>&#160;time_point <a class="code" href="classeosio_1_1chain_1_1controller_a675086138c644442ef3a084e027a7d5a.html#a675086138c644442ef3a084e027a7d5a">controller::pending_block_time</a>()<span class="keyword">const </span>{</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;   FC_ASSERT( my-&gt;pending, <span class="stringliteral">&quot;no pending block&quot;</span> );</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;   <span class="keywordflow">return</span> my-&gt;pending-&gt;_pending_block_state-&gt;header.timestamp;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;}</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;</div><div class="line"><a name="l01221"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_a63347225cf63d4789a5edd7b35c8c35d.html#a63347225cf63d4789a5edd7b35c8c35d"> 1221</a></span>&#160;uint32_t <a class="code" href="classeosio_1_1chain_1_1controller_a63347225cf63d4789a5edd7b35c8c35d.html#a63347225cf63d4789a5edd7b35c8c35d">controller::last_irreversible_block_num</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;   <span class="keywordflow">return</span> std::max(my-&gt;head-&gt;bft_irreversible_blocknum, my-&gt;head-&gt;dpos_irreversible_blocknum);</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;}</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;</div><div class="line"><a name="l01225"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_a111d77f0d2612865e9de37f1633cf14f.html#a111d77f0d2612865e9de37f1633cf14f"> 1225</a></span>&#160;<a class="code" href="namespaceeosio_1_1chain_afe40963e3dd209e6457f7e482844466f.html#afe40963e3dd209e6457f7e482844466f">block_id_type</a> <a class="code" href="classeosio_1_1chain_1_1controller_a111d77f0d2612865e9de37f1633cf14f.html#a111d77f0d2612865e9de37f1633cf14f">controller::last_irreversible_block_id</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;   <span class="keyword">auto</span> lib_num = last_irreversible_block_num();</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; tapos_block_summary = <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>().get&lt;<a class="code" href="classeosio_1_1chain_1_1block__summary__object.html">block_summary_object</a>&gt;((uint16_t)lib_num);</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;   <span class="keywordflow">if</span>( <a class="code" href="structeosio_1_1chain_1_1block__header_a290b6c71de8b72e68f6c8d35013dc9aa.html#a290b6c71de8b72e68f6c8d35013dc9aa">block_header::num_from_id</a>(tapos_block_summary.block_id) == lib_num )</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      <span class="keywordflow">return</span> tapos_block_summary.block_id;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;   <span class="keywordflow">return</span> fetch_block_by_number(lib_num)-&gt;id();</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;}</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;</div><div class="line"><a name="l01236"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_a5f3cb69b19dc32404a9263702d89e875.html#a5f3cb69b19dc32404a9263702d89e875"> 1236</a></span>&#160;<span class="keyword">const</span> <a class="code" href="classeosio_1_1chain_1_1dynamic__global__property__object.html">dynamic_global_property_object</a>&amp; <a class="code" href="classeosio_1_1chain_1_1controller_a5f3cb69b19dc32404a9263702d89e875.html#a5f3cb69b19dc32404a9263702d89e875">controller::get_dynamic_global_properties</a>()<span class="keyword">const </span>{</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;  <span class="keywordflow">return</span> my-&gt;db.get&lt;<a class="code" href="classeosio_1_1chain_1_1dynamic__global__property__object.html">dynamic_global_property_object</a>&gt;();</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;}</div><div class="line"><a name="l01239"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_a826f8feab4d745ad1ae6ce3daff85774.html#a826f8feab4d745ad1ae6ce3daff85774"> 1239</a></span>&#160;<span class="keyword">const</span> <a class="code" href="classeosio_1_1chain_1_1global__property__object.html">global_property_object</a>&amp; <a class="code" href="classeosio_1_1chain_1_1controller_a826f8feab4d745ad1ae6ce3daff85774.html#a826f8feab4d745ad1ae6ce3daff85774">controller::get_global_properties</a>()<span class="keyword">const </span>{</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  <span class="keywordflow">return</span> my-&gt;db.get&lt;<a class="code" href="classeosio_1_1chain_1_1global__property__object.html">global_property_object</a>&gt;();</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;}</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;</div><div class="line"><a name="l01243"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_ad13b01f7b0aad220af8e9dffa98641f4.html#ad13b01f7b0aad220af8e9dffa98641f4"> 1243</a></span>&#160;<a class="code" href="namespaceeosio_1_1chain_aab529d0705068032cf285096bd8a911b.html#aab529d0705068032cf285096bd8a911b">signed_block_ptr</a> <a class="code" href="classeosio_1_1chain_1_1controller_ad13b01f7b0aad220af8e9dffa98641f4.html#ad13b01f7b0aad220af8e9dffa98641f4">controller::fetch_block_by_id</a>( <a class="code" href="namespaceeosio_1_1chain_afe40963e3dd209e6457f7e482844466f.html#afe40963e3dd209e6457f7e482844466f">block_id_type</a> <span class="keywordtype">id</span> )<span class="keyword">const </span>{</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;   <span class="keyword">auto</span> state = my-&gt;fork_db.get_block(<span class="keywordtype">id</span>);</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;   <span class="keywordflow">if</span>( state ) <span class="keywordflow">return</span> state-&gt;block;</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;   <span class="keyword">auto</span> bptr = fetch_block_by_number( <a class="code" href="structeosio_1_1chain_1_1block__header_a290b6c71de8b72e68f6c8d35013dc9aa.html#a290b6c71de8b72e68f6c8d35013dc9aa">block_header::num_from_id</a>(<span class="keywordtype">id</span>) );</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;   <span class="keywordflow">if</span>( bptr &amp;&amp; bptr-&gt;id() == id ) <span class="keywordflow">return</span> bptr;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="namespaceeosio_1_1chain_aab529d0705068032cf285096bd8a911b.html#aab529d0705068032cf285096bd8a911b">signed_block_ptr</a>();</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;}</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;</div><div class="line"><a name="l01251"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_a110373007d0883c8065373719fdbdd5f.html#a110373007d0883c8065373719fdbdd5f"> 1251</a></span>&#160;<a class="code" href="namespaceeosio_1_1chain_aab529d0705068032cf285096bd8a911b.html#aab529d0705068032cf285096bd8a911b">signed_block_ptr</a> <a class="code" href="classeosio_1_1chain_1_1controller_a110373007d0883c8065373719fdbdd5f.html#a110373007d0883c8065373719fdbdd5f">controller::fetch_block_by_number</a>( uint32_t block_num )<span class="keyword">const  </span>{ <span class="keywordflow">try</span> {</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;   <span class="keyword">auto</span> blk_state = my-&gt;fork_db.get_block_in_current_chain_by_num( block_num );</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;   <span class="keywordflow">if</span>( blk_state ) {</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;      <span class="keywordflow">return</span> blk_state-&gt;block;</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;   }</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;   <span class="keywordflow">return</span> my-&gt;blog.read_block_by_num(block_num);</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;} FC_CAPTURE_AND_RETHROW( (block_num) ) }</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;</div><div class="line"><a name="l01260"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_acba3f443f4c230c24aac1fe9ef6560c9.html#acba3f443f4c230c24aac1fe9ef6560c9"> 1260</a></span>&#160;<a class="code" href="namespaceeosio_1_1chain_afe40963e3dd209e6457f7e482844466f.html#afe40963e3dd209e6457f7e482844466f">block_id_type</a> <a class="code" href="classeosio_1_1chain_1_1controller_acba3f443f4c230c24aac1fe9ef6560c9.html#acba3f443f4c230c24aac1fe9ef6560c9">controller::get_block_id_for_num</a>( uint32_t block_num )<span class="keyword">const </span>{ <span class="keywordflow">try</span> {</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;   <span class="keyword">auto</span> blk_state = my-&gt;fork_db.get_block_in_current_chain_by_num( block_num );</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;   <span class="keywordflow">if</span>( blk_state ) {</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;      <span class="keywordflow">return</span> blk_state-&gt;id;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;   }</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;   <span class="keyword">auto</span> signed_blk = my-&gt;blog.read_block_by_num(block_num);</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;   <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( BOOST_LIKELY( signed_blk != <span class="keyword">nullptr</span> ), unknown_block_exception,</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;               <span class="stringliteral">&quot;Could not find block: ${block}&quot;</span>, (<span class="stringliteral">&quot;block&quot;</span>, block_num) );</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;   <span class="keywordflow">return</span> signed_blk-&gt;id();</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;} FC_CAPTURE_AND_RETHROW( (block_num) ) }</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;</div><div class="line"><a name="l01274"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_a24edd3b1a472139646fa4ae4ac43f71d.html#a24edd3b1a472139646fa4ae4ac43f71d"> 1274</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classeosio_1_1chain_1_1controller_a24edd3b1a472139646fa4ae4ac43f71d.html#a24edd3b1a472139646fa4ae4ac43f71d">controller::pop_block</a>() {</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;   my-&gt;pop_block();</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;}</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;</div><div class="line"><a name="l01278"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_a799fd724bdbd33b45a292845a7e6d0e5.html#a799fd724bdbd33b45a292845a7e6d0e5"> 1278</a></span>&#160;int64_t <a class="code" href="classeosio_1_1chain_1_1controller_a799fd724bdbd33b45a292845a7e6d0e5.html#a799fd724bdbd33b45a292845a7e6d0e5">controller::set_proposed_producers</a>( vector&lt;producer_key&gt; producers ) {</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; gpo = get_global_properties();</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;   <span class="keyword">auto</span> cur_block_num = head_block_num() + 1;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;   <span class="keywordflow">if</span>( gpo.proposed_schedule_block_num.valid() ) {</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;      <span class="keywordflow">if</span>( *gpo.proposed_schedule_block_num != cur_block_num )</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;         <span class="keywordflow">return</span> -1; <span class="comment">// there is already a proposed schedule set in a previous block, wait for it to become pending</span></div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;      <span class="keywordflow">if</span>( std::equal( producers.begin(), producers.end(),</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                      gpo.proposed_schedule.producers.begin(), gpo.proposed_schedule.producers.end() ) )</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;         <span class="keywordflow">return</span> -1; <span class="comment">// the proposed producer schedule does not change</span></div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;   }</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;   <a class="code" href="structeosio_1_1chain_1_1producer__schedule__type.html">producer_schedule_type</a> sch;</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;   decltype(sch.<a class="code" href="structeosio_1_1chain_1_1producer__schedule__type_a63ef7dfb4a0677ed816b5ac2803b6d03.html#a63ef7dfb4a0677ed816b5ac2803b6d03">producers</a>.cend()) end;</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;   decltype(end)                  begin;</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;   <span class="keywordflow">if</span>( my-&gt;pending-&gt;_pending_block_state-&gt;pending_schedule.producers.size() == 0 ) {</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; active_sch = my-&gt;pending-&gt;_pending_block_state-&gt;active_schedule;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;      begin = active_sch.<a class="code" href="structeosio_1_1chain_1_1producer__schedule__type_a63ef7dfb4a0677ed816b5ac2803b6d03.html#a63ef7dfb4a0677ed816b5ac2803b6d03">producers</a>.begin();</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;      end   = active_sch.producers.end();</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;      sch.<a class="code" href="structeosio_1_1chain_1_1producer__schedule__type_a5c583841f43a04a1bc981885e79bf6d4.html#a5c583841f43a04a1bc981885e79bf6d4">version</a> = active_sch.version + 1;</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; pending_sch = my-&gt;pending-&gt;_pending_block_state-&gt;pending_schedule;</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;      begin = pending_sch.producers.begin();</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;      end   = pending_sch.producers.end();</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;      sch.<a class="code" href="structeosio_1_1chain_1_1producer__schedule__type_a5c583841f43a04a1bc981885e79bf6d4.html#a5c583841f43a04a1bc981885e79bf6d4">version</a> = pending_sch.version + 1;</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;   }</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;   <span class="keywordflow">if</span>( std::equal( producers.begin(), producers.end(), begin, end ) )</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;      <span class="keywordflow">return</span> -1; <span class="comment">// the producer schedule would not change</span></div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;   sch.<a class="code" href="structeosio_1_1chain_1_1producer__schedule__type_a63ef7dfb4a0677ed816b5ac2803b6d03.html#a63ef7dfb4a0677ed816b5ac2803b6d03">producers</a> = std::move(producers);</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;   int64_t version = sch.<a class="code" href="structeosio_1_1chain_1_1producer__schedule__type_a5c583841f43a04a1bc981885e79bf6d4.html#a5c583841f43a04a1bc981885e79bf6d4">version</a>;</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;   my-&gt;db.modify( gpo, [&amp;]( <span class="keyword">auto</span>&amp; gp ) {</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;      gp.proposed_schedule_block_num = cur_block_num;</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;      gp.proposed_schedule = std::move(sch);</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;   });</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;   <span class="keywordflow">return</span> version;</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;}</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;</div><div class="line"><a name="l01322"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_a45489fbdb8b64b0c9e0dcdc1a71b35af.html#a45489fbdb8b64b0c9e0dcdc1a71b35af"> 1322</a></span>&#160;<span class="keyword">const</span> <a class="code" href="structeosio_1_1chain_1_1producer__schedule__type.html">producer_schedule_type</a>&amp;    <a class="code" href="classeosio_1_1chain_1_1controller_a45489fbdb8b64b0c9e0dcdc1a71b35af.html#a45489fbdb8b64b0c9e0dcdc1a71b35af">controller::active_producers</a>()<span class="keyword">const </span>{</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;   <span class="keywordflow">if</span> ( !(my-&gt;pending) )</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;      <span class="keywordflow">return</span>  my-&gt;head-&gt;active_schedule;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;   <span class="keywordflow">return</span> my-&gt;pending-&gt;_pending_block_state-&gt;active_schedule;</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;}</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;</div><div class="line"><a name="l01328"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_a57274fa2f7d8683ca77841e81c70010e.html#a57274fa2f7d8683ca77841e81c70010e"> 1328</a></span>&#160;<span class="keyword">const</span> <a class="code" href="structeosio_1_1chain_1_1producer__schedule__type.html">producer_schedule_type</a>&amp;    <a class="code" href="classeosio_1_1chain_1_1controller_a57274fa2f7d8683ca77841e81c70010e.html#a57274fa2f7d8683ca77841e81c70010e">controller::pending_producers</a>()<span class="keyword">const </span>{</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;   <span class="keywordflow">if</span> ( !(my-&gt;pending) )</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;      <span class="keywordflow">return</span>  my-&gt;head-&gt;pending_schedule;</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;   <span class="keywordflow">return</span> my-&gt;pending-&gt;_pending_block_state-&gt;pending_schedule;</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;}</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;</div><div class="line"><a name="l01334"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_aef66534b7230e01e1be95a6eac29b40a.html#aef66534b7230e01e1be95a6eac29b40a"> 1334</a></span>&#160;optional&lt;producer_schedule_type&gt; <a class="code" href="classeosio_1_1chain_1_1controller_aef66534b7230e01e1be95a6eac29b40a.html#aef66534b7230e01e1be95a6eac29b40a">controller::proposed_producers</a>()<span class="keyword">const </span>{</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; gpo = get_global_properties();</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;   <span class="keywordflow">if</span>( !gpo.proposed_schedule_block_num.valid() )</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;      <span class="keywordflow">return</span> optional&lt;producer_schedule_type&gt;();</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;   <span class="keywordflow">return</span> gpo.proposed_schedule;</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;}</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;</div><div class="line"><a name="l01342"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_a81444eacf323dd782c2215967931af3d.html#a81444eacf323dd782c2215967931af3d"> 1342</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classeosio_1_1chain_1_1controller_a81444eacf323dd782c2215967931af3d.html#a81444eacf323dd782c2215967931af3d">controller::skip_auth_check</a>()<span class="keyword">const </span>{</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;   <span class="keywordflow">return</span> my-&gt;replaying &amp;&amp; !my-&gt;conf.force_all_checks;</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;}</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;</div><div class="line"><a name="l01346"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_ac44cfb3fa2ece7d456d9159f4afd9fe0.html#ac44cfb3fa2ece7d456d9159f4afd9fe0"> 1346</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classeosio_1_1chain_1_1controller_ac44cfb3fa2ece7d456d9159f4afd9fe0.html#ac44cfb3fa2ece7d456d9159f4afd9fe0">controller::contracts_console</a>()<span class="keyword">const </span>{</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;   <span class="keywordflow">return</span> my-&gt;conf.contracts_console;</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;}</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;</div><div class="line"><a name="l01350"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_a2fcaeb618b6d93ef2025847764c8543f.html#a2fcaeb618b6d93ef2025847764c8543f"> 1350</a></span>&#160;<a class="code" href="structeosio_1_1chain_1_1chain__id__type.html">chain_id_type</a> <a class="code" href="classeosio_1_1chain_1_1controller_a2fcaeb618b6d93ef2025847764c8543f.html#a2fcaeb618b6d93ef2025847764c8543f">controller::get_chain_id</a>()<span class="keyword">const </span>{</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;   <span class="keywordflow">return</span> my-&gt;chain_id;</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;}</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;</div><div class="line"><a name="l01354"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_a00f6845fc8587da5f9b4b1aa5e0d4115.html#a00f6845fc8587da5f9b4b1aa5e0d4115"> 1354</a></span>&#160;<span class="keyword">const</span> <a class="code" href="namespaceeosio_1_1chain_a411a7151b8bf3be332abd8f3670dfdf2.html#a411a7151b8bf3be332abd8f3670dfdf2">apply_handler</a>* <a class="code" href="classeosio_1_1chain_1_1controller_a00f6845fc8587da5f9b4b1aa5e0d4115.html#a00f6845fc8587da5f9b4b1aa5e0d4115">controller::find_apply_handler</a>( <a class="code" href="structeosio_1_1chain_1_1name.html">account_name</a> receiver, <a class="code" href="structeosio_1_1chain_1_1name.html">account_name</a> scope, <a class="code" href="namespaceeosio_1_1chain_afb4a1df1715a88764f246867c5d32796.html#afb4a1df1715a88764f246867c5d32796">action_name</a> act )<span class="keyword"> const</span></div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;   <span class="keyword">auto</span> native_handler_scope = my-&gt;apply_handlers.find( receiver );</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;   <span class="keywordflow">if</span>( native_handler_scope != my-&gt;apply_handlers.end() ) {</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;      <span class="keyword">auto</span> handler = native_handler_scope-&gt;second.find( make_pair( scope, act ) );</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;      <span class="keywordflow">if</span>( handler != native_handler_scope-&gt;second.end() )</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;         <span class="keywordflow">return</span> &amp;handler-&gt;second;</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;   }</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;   <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;}</div><div class="line"><a name="l01364"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_a5783134f223585dfc187a56716b5da22.html#a5783134f223585dfc187a56716b5da22"> 1364</a></span>&#160;<a class="code" href="classeosio_1_1chain_1_1wasm__interface.html">wasm_interface</a>&amp; <a class="code" href="classeosio_1_1chain_1_1controller_a5783134f223585dfc187a56716b5da22.html#a5783134f223585dfc187a56716b5da22">controller::get_wasm_interface</a>() {</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;   <span class="keywordflow">return</span> my-&gt;wasmif;</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;}</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;</div><div class="line"><a name="l01368"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_ad290d6b9a4d003ee22086695a92a1667.html#ad290d6b9a4d003ee22086695a92a1667"> 1368</a></span>&#160;<span class="keyword">const</span> <a class="code" href="classeosio_1_1chain_1_1account__object.html">account_object</a>&amp; <a class="code" href="classeosio_1_1chain_1_1controller_ad290d6b9a4d003ee22086695a92a1667.html#ad290d6b9a4d003ee22086695a92a1667">controller::get_account</a>( <a class="code" href="structeosio_1_1chain_1_1name.html">account_name</a> <a class="code" href="structeosio_1_1chain_1_1name.html">name</a> )<span class="keyword">const</span></div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;<span class="keyword"></span>{ <span class="keywordflow">try</span> {</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;   <span class="keywordflow">return</span> my-&gt;db.get&lt;<a class="code" href="classeosio_1_1chain_1_1account__object.html">account_object</a>, by_name&gt;(<a class="code" href="structeosio_1_1chain_1_1name.html">name</a>);</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;} FC_CAPTURE_AND_RETHROW( (<a class="code" href="structeosio_1_1chain_1_1name.html">name</a>) ) }</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;</div><div class="line"><a name="l01373"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_ade09ae48b91403772a989be0ba9ab324.html#ade09ae48b91403772a989be0ba9ab324"> 1373</a></span>&#160;vector&lt;transaction_metadata_ptr&gt; <a class="code" href="classeosio_1_1chain_1_1controller_ade09ae48b91403772a989be0ba9ab324.html#ade09ae48b91403772a989be0ba9ab324">controller::get_unapplied_transactions</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;   vector&lt;transaction_metadata_ptr&gt; result;</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;   result.reserve(my-&gt;unapplied_transactions.size());</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;   <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; entry: my-&gt;unapplied_transactions ) {</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;      result.emplace_back(entry.second);</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;   }</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;   <span class="keywordflow">return</span> result;</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;}</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;</div><div class="line"><a name="l01382"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_abbdb82d5f3168addacc408988c59bcef.html#abbdb82d5f3168addacc408988c59bcef"> 1382</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classeosio_1_1chain_1_1controller_abbdb82d5f3168addacc408988c59bcef.html#abbdb82d5f3168addacc408988c59bcef">controller::drop_unapplied_transaction</a>(<span class="keyword">const</span> <a class="code" href="namespaceeosio_1_1chain_a2af3155c69a0faecfb5adc06480d3078.html#a2af3155c69a0faecfb5adc06480d3078">transaction_metadata_ptr</a>&amp; trx) {</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;   my-&gt;unapplied_transactions.erase(trx-&gt;signed_id);</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;}</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;</div><div class="line"><a name="l01386"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_a14fbd4c9b2573d856047acbf17b4f2c9.html#a14fbd4c9b2573d856047acbf17b4f2c9"> 1386</a></span>&#160;vector&lt;transaction_id_type&gt; <a class="code" href="classeosio_1_1chain_1_1controller_a14fbd4c9b2573d856047acbf17b4f2c9.html#a14fbd4c9b2573d856047acbf17b4f2c9">controller::get_scheduled_transactions</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; idx = <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>().get_index&lt;<a class="code" href="namespaceeosio_1_1chain_a113a4fa08534159756415238097d0b2b.html#a113a4fa08534159756415238097d0b2b">generated_transaction_multi_index</a>,by_delay&gt;();</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;   vector&lt;transaction_id_type&gt; result;</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> max_reserve = 64;</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;   result.reserve(std::min(idx.size(), max_reserve));</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;   <span class="keyword">auto</span> itr = idx.begin();</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;   <span class="keywordflow">while</span>( itr != idx.end() &amp;&amp; itr-&gt;delay_until &lt;= pending_block_time() ) {</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;      result.emplace_back(itr-&gt;trx_id);</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;      ++itr;</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;   }</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;   <span class="keywordflow">return</span> result;</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;}</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;</div><div class="line"><a name="l01402"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_af6aa9a5bcc592ae08c47d4f27a1a026c.html#af6aa9a5bcc592ae08c47d4f27a1a026c"> 1402</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classeosio_1_1chain_1_1controller_af6aa9a5bcc592ae08c47d4f27a1a026c.html#af6aa9a5bcc592ae08c47d4f27a1a026c">controller::check_contract_list</a>( <a class="code" href="structeosio_1_1chain_1_1name.html">account_name</a> <a class="code" href="namespaceeosio_1_1chain_1_1wasm__ops_a4eff4c3a5ad1e8e813e0087e2f72c17b.html#a4eff4c3a5ad1e8e813e0087e2f72c17b">code</a> )<span class="keyword">const </span>{</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;   my-&gt;check_contract_list( <a class="code" href="namespaceeosio_1_1chain_1_1wasm__ops_a4eff4c3a5ad1e8e813e0087e2f72c17b.html#a4eff4c3a5ad1e8e813e0087e2f72c17b">code</a> );</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;}</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;</div><div class="line"><a name="l01406"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_aa21275c4089a29d9b84c30a95fab0efe.html#aa21275c4089a29d9b84c30a95fab0efe"> 1406</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classeosio_1_1chain_1_1controller_aa21275c4089a29d9b84c30a95fab0efe.html#aa21275c4089a29d9b84c30a95fab0efe">controller::is_producing_block</a>()<span class="keyword">const </span>{</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;   <span class="keywordflow">if</span>( !my-&gt;pending ) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;   <span class="keywordflow">return</span> (my-&gt;pending-&gt;_block_status == block_status::incomplete);</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;}</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;</div><div class="line"><a name="l01412"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_af046b9bd6a679a4a28cab4a3f46f2d8c.html#af046b9bd6a679a4a28cab4a3f46f2d8c"> 1412</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classeosio_1_1chain_1_1controller_af046b9bd6a679a4a28cab4a3f46f2d8c.html#af046b9bd6a679a4a28cab4a3f46f2d8c">controller::validate_referenced_accounts</a>( <span class="keyword">const</span> <a class="code" href="structeosio_1_1chain_1_1transaction.html">transaction</a>&amp; trx )<span class="keyword">const </span>{</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;   <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; a : trx.<a class="code" href="structeosio_1_1chain_1_1transaction_a72659cea5d663a72934976c95ef151bc.html#a72659cea5d663a72934976c95ef151bc">context_free_actions</a> ) {</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      <span class="keyword">auto</span>* <a class="code" href="namespaceeosio_1_1chain_1_1wasm__ops_a4eff4c3a5ad1e8e813e0087e2f72c17b.html#a4eff4c3a5ad1e8e813e0087e2f72c17b">code</a> = my-&gt;db.find&lt;<a class="code" href="classeosio_1_1chain_1_1account__object.html">account_object</a>, by_name&gt;(a.account);</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;      <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( <a class="code" href="namespaceeosio_1_1chain_1_1wasm__ops_a4eff4c3a5ad1e8e813e0087e2f72c17b.html#a4eff4c3a5ad1e8e813e0087e2f72c17b">code</a> != <span class="keyword">nullptr</span>, <a class="code" href="namespaceeosio_1_1chain_ad6e015097a10f08028a3e3df3b17ecdf.html#ad6e015097a10f08028a3e3df3b17ecdf">transaction_exception</a>,</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                  <span class="stringliteral">&quot;action&#39;s code account &#39;${account}&#39; does not exist&quot;</span>, (<span class="stringliteral">&quot;account&quot;</span>, a.account) );</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;      <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( a.authorization.size() == 0, <a class="code" href="namespaceeosio_1_1chain_ad6e015097a10f08028a3e3df3b17ecdf.html#ad6e015097a10f08028a3e3df3b17ecdf">transaction_exception</a>,</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                  <span class="stringliteral">&quot;context-free actions cannot have authorizations&quot;</span> );</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;   }</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;   <span class="keywordtype">bool</span> one_auth = <span class="keyword">false</span>;</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;   <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; a : trx.<a class="code" href="structeosio_1_1chain_1_1transaction_a768465b5929ca1291b303294f353b1c5.html#a768465b5929ca1291b303294f353b1c5">actions</a> ) {</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;      <span class="keyword">auto</span>* <a class="code" href="namespaceeosio_1_1chain_1_1wasm__ops_a4eff4c3a5ad1e8e813e0087e2f72c17b.html#a4eff4c3a5ad1e8e813e0087e2f72c17b">code</a> = my-&gt;db.find&lt;<a class="code" href="classeosio_1_1chain_1_1account__object.html">account_object</a>, by_name&gt;(a.account);</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;      <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( <a class="code" href="namespaceeosio_1_1chain_1_1wasm__ops_a4eff4c3a5ad1e8e813e0087e2f72c17b.html#a4eff4c3a5ad1e8e813e0087e2f72c17b">code</a> != <span class="keyword">nullptr</span>, <a class="code" href="namespaceeosio_1_1chain_ad6e015097a10f08028a3e3df3b17ecdf.html#ad6e015097a10f08028a3e3df3b17ecdf">transaction_exception</a>,</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                  <span class="stringliteral">&quot;action&#39;s code account &#39;${account}&#39; does not exist&quot;</span>, (<span class="stringliteral">&quot;account&quot;</span>, a.account) );</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;      <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; auth : a.authorization ) {</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;         one_auth = <span class="keyword">true</span>;</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;         <span class="keyword">auto</span>* actor = my-&gt;db.find&lt;<a class="code" href="classeosio_1_1chain_1_1account__object.html">account_object</a>, by_name&gt;(auth.actor);</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;         <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( actor  != <span class="keyword">nullptr</span>, <a class="code" href="namespaceeosio_1_1chain_ad6e015097a10f08028a3e3df3b17ecdf.html#ad6e015097a10f08028a3e3df3b17ecdf">transaction_exception</a>,</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;                     <span class="stringliteral">&quot;action&#39;s authorizing actor &#39;${account}&#39; does not exist&quot;</span>, (<span class="stringliteral">&quot;account&quot;</span>, auth.actor) );</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;         <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( my-&gt;authorization.find_permission(auth) != <span class="keyword">nullptr</span>, <a class="code" href="namespaceeosio_1_1chain_ad6e015097a10f08028a3e3df3b17ecdf.html#ad6e015097a10f08028a3e3df3b17ecdf">transaction_exception</a>,</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                     <span class="stringliteral">&quot;action&#39;s authorizations include a non-existent permission: {permission}&quot;</span>,</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;                     (<span class="stringliteral">&quot;permission&quot;</span>, auth) );</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;      }</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;   }</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;   <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( one_auth, tx_no_auths, <span class="stringliteral">&quot;transaction must have at least one authorization&quot;</span> );</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;}</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;</div><div class="line"><a name="l01438"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_a50ff8d45254fc4e3464fda2b87b78847.html#a50ff8d45254fc4e3464fda2b87b78847"> 1438</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classeosio_1_1chain_1_1controller_a50ff8d45254fc4e3464fda2b87b78847.html#a50ff8d45254fc4e3464fda2b87b78847">controller::validate_expiration</a>( <span class="keyword">const</span> <a class="code" href="structeosio_1_1chain_1_1transaction.html">transaction</a>&amp; trx )<span class="keyword">const </span>{ <span class="keywordflow">try</span> {</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; chain_configuration = get_global_properties().configuration;</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;   <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( time_point(trx.<a class="code" href="structeosio_1_1chain_1_1transaction__header_acb8d4b05d574db9550dda7ae24f62d3e.html#acb8d4b05d574db9550dda7ae24f62d3e">expiration</a>) &gt;= pending_block_time(),</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;               expired_tx_exception,</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;               <span class="stringliteral">&quot;transaction has expired, &quot;</span></div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;               <span class="stringliteral">&quot;expiration is ${trx.expiration} and pending block time is ${pending_block_time}&quot;</span>,</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;               (<span class="stringliteral">&quot;trx.expiration&quot;</span>,trx.<a class="code" href="structeosio_1_1chain_1_1transaction__header_acb8d4b05d574db9550dda7ae24f62d3e.html#acb8d4b05d574db9550dda7ae24f62d3e">expiration</a>)(<span class="stringliteral">&quot;pending_block_time&quot;</span>,pending_block_time()));</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;   <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>( time_point(trx.<a class="code" href="structeosio_1_1chain_1_1transaction__header_acb8d4b05d574db9550dda7ae24f62d3e.html#acb8d4b05d574db9550dda7ae24f62d3e">expiration</a>) &lt;= pending_block_time() + fc::seconds(chain_configuration.max_transaction_lifetime),</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;               tx_exp_too_far_exception,</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;               <span class="stringliteral">&quot;Transaction expiration is too far in the future relative to the reference time of ${reference_time}, &quot;</span></div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;               <span class="stringliteral">&quot;expiration is ${trx.expiration} and the maximum transaction lifetime is ${max_til_exp} seconds&quot;</span>,</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;               (<span class="stringliteral">&quot;trx.expiration&quot;</span>,trx.<a class="code" href="structeosio_1_1chain_1_1transaction__header_acb8d4b05d574db9550dda7ae24f62d3e.html#acb8d4b05d574db9550dda7ae24f62d3e">expiration</a>)(<span class="stringliteral">&quot;reference_time&quot;</span>,pending_block_time())</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;               (<span class="stringliteral">&quot;max_til_exp&quot;</span>,chain_configuration.max_transaction_lifetime) );</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;} FC_CAPTURE_AND_RETHROW((trx)) }</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;</div><div class="line"><a name="l01454"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_aa247bdb7f6be53fd85d960c18972d972.html#aa247bdb7f6be53fd85d960c18972d972"> 1454</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classeosio_1_1chain_1_1controller_aa247bdb7f6be53fd85d960c18972d972.html#aa247bdb7f6be53fd85d960c18972d972">controller::validate_tapos</a>( <span class="keyword">const</span> <a class="code" href="structeosio_1_1chain_1_1transaction.html">transaction</a>&amp; trx )<span class="keyword">const </span>{ <span class="keywordflow">try</span> {</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;   <span class="keyword">const</span> <span class="keyword">auto</span>&amp; tapos_block_summary = <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>().get&lt;<a class="code" href="classeosio_1_1chain_1_1block__summary__object.html">block_summary_object</a>&gt;((uint16_t)trx.<a class="code" href="structeosio_1_1chain_1_1transaction__header_a30597dae13f5178c2359e40fd083db5c.html#a30597dae13f5178c2359e40fd083db5c">ref_block_num</a>);</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;   <span class="comment">//Verify TaPoS block summary has correct ID prefix, and that this block&#39;s time is not past the expiration</span></div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;   <a class="code" href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a>(trx.<a class="code" href="structeosio_1_1chain_1_1transaction__header_a57735f251563cf3b6f1205333b1b6135.html#a57735f251563cf3b6f1205333b1b6135">verify_reference_block</a>(tapos_block_summary.block_id), invalid_ref_block_exception,</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;              <span class="stringliteral">&quot;Transaction&#39;s reference block did not match. Is this transaction from a different fork?&quot;</span>,</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;              (<span class="stringliteral">&quot;tapos_summary&quot;</span>, tapos_block_summary));</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;} FC_CAPTURE_AND_RETHROW() }</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;</div><div class="line"><a name="l01463"></a><span class="lineno"><a class="line" href="classeosio_1_1chain_1_1controller_a26d9e0eb5813aec9ba7fd212dab171c7.html#a26d9e0eb5813aec9ba7fd212dab171c7"> 1463</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classeosio_1_1chain_1_1controller_a26d9e0eb5813aec9ba7fd212dab171c7.html#a26d9e0eb5813aec9ba7fd212dab171c7">controller::is_known_unexpired_transaction</a>( <span class="keyword">const</span> <a class="code" href="namespaceeosio_1_1chain_ac19fb56771d15ea996c2806a46eeaf25.html#ac19fb56771d15ea996c2806a46eeaf25">transaction_id_type</a>&amp; <span class="keywordtype">id</span>)<span class="keyword"> const </span>{</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">db</a>().find&lt;<a class="code" href="classeosio_1_1chain_1_1transaction__object.html">transaction_object</a>, by_trx_id&gt;(id);</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;}</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;} } </div><div class="ttc" id="structeosio_1_1chain_1_1producer__schedule__type_a63ef7dfb4a0677ed816b5ac2803b6d03_html_a63ef7dfb4a0677ed816b5ac2803b6d03"><div class="ttname"><a href="structeosio_1_1chain_1_1producer__schedule__type_a63ef7dfb4a0677ed816b5ac2803b6d03.html#a63ef7dfb4a0677ed816b5ac2803b6d03">eosio::chain::producer_schedule_type::producers</a></div><div class="ttdeci">vector&lt; producer_key &gt; producers</div><div class="ttdef"><b>Definition:</b> <a href="producer__schedule_8hpp_source.html#l00027">producer_schedule.hpp:27</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_a50ff8d45254fc4e3464fda2b87b78847_html_a50ff8d45254fc4e3464fda2b87b78847"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_a50ff8d45254fc4e3464fda2b87b78847.html#a50ff8d45254fc4e3464fda2b87b78847">eosio::chain::controller::validate_expiration</a></div><div class="ttdeci">void validate_expiration(const transaction &amp;t) const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01438">controller.cpp:1438</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_abbdb82d5f3168addacc408988c59bcef_html_abbdb82d5f3168addacc408988c59bcef"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_abbdb82d5f3168addacc408988c59bcef.html#abbdb82d5f3168addacc408988c59bcef">eosio::chain::controller::drop_unapplied_transaction</a></div><div class="ttdeci">void drop_unapplied_transaction(const transaction_metadata_ptr &amp;trx)</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01382">controller.cpp:1382</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1block__log_a60726f7fe12c0918e4973aac125201d9_html_a60726f7fe12c0918e4973aac125201d9"><div class="ttname"><a href="classeosio_1_1chain_1_1block__log_a60726f7fe12c0918e4973aac125201d9.html#a60726f7fe12c0918e4973aac125201d9">eosio::chain::block_log::append</a></div><div class="ttdeci">uint64_t append(const signed_block_ptr &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="block__log_8cpp_source.html#l00171">block_log.cpp:171</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1authorization__manager_ad1f330edc0e8067d0118657da09f5994_html_ad1f330edc0e8067d0118657da09f5994"><div class="ttname"><a href="classeosio_1_1chain_1_1authorization__manager_ad1f330edc0e8067d0118657da09f5994.html#ad1f330edc0e8067d0118657da09f5994">eosio::chain::authorization_manager::initialize_database</a></div><div class="ttdeci">void initialize_database()</div><div class="ttdef"><b>Definition:</b> <a href="authorization__manager_8cpp_source.html#l00027">authorization_manager.cpp:27</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_html"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl.html">eosio::chain::controller_impl</a></div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00046">controller.cpp:46</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1pending__state_a537316e4e8178e8d8c19976e33a7e40e_html_a537316e4e8178e8d8c19976e33a7e40e"><div class="ttname"><a href="structeosio_1_1chain_1_1pending__state_a537316e4e8178e8d8c19976e33a7e40e.html#a537316e4e8178e8d8c19976e33a7e40e">eosio::chain::pending_state::_db_session</a></div><div class="ttdeci">database::session _db_session</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00033">controller.cpp:33</a></div></div>
<div class="ttc" id="namespaceeosio_html"><div class="ttname"><a href="namespaceeosio.html">eosio</a></div><div class="ttdef"><b>Definition:</b> <a href="abi__serializer_8cpp_source.html#l00017">abi_serializer.cpp:17</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1block__header__state_abd0c02b8959779786d000c2510ec500d_html_abd0c02b8959779786d000c2510ec500d"><div class="ttname"><a href="structeosio_1_1chain_1_1block__header__state_abd0c02b8959779786d000c2510ec500d.html#abd0c02b8959779786d000c2510ec500d">eosio::chain::block_header_state::pending_schedule</a></div><div class="ttdeci">producer_schedule_type pending_schedule</div><div class="ttdef"><b>Definition:</b> <a href="block__header__state_8hpp_source.html#l00020">block_header_state.hpp:20</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_ab169c7a71ffe3673cfedfab745ae7ccd_html_ab169c7a71ffe3673cfedfab745ae7ccd"><div class="ttname"><a href="namespaceeosio_1_1chain_ab169c7a71ffe3673cfedfab745ae7ccd.html#ab169c7a71ffe3673cfedfab745ae7ccd">eosio::chain::block_summary_multi_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; block_summary_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, BOOST_MULTI_INDEX_MEMBER(block_summary_object, block_summary_object::id_type, id)&gt; &gt; &gt; block_summary_multi_index</div><div class="ttdef"><b>Definition:</b> <a href="block__summary__object_8hpp_source.html#l00035">block_summary_object.hpp:35</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1block__header__state_ac8906d526bf9072f098e3f9f8cbb15c9_html_ac8906d526bf9072f098e3f9f8cbb15c9"><div class="ttname"><a href="structeosio_1_1chain_1_1block__header__state_ac8906d526bf9072f098e3f9f8cbb15c9.html#ac8906d526bf9072f098e3f9f8cbb15c9">eosio::chain::block_header_state::id</a></div><div class="ttdeci">block_id_type id</div><div class="ttdef"><b>Definition:</b> <a href="block__header__state_8hpp_source.html#l00012">block_header_state.hpp:12</a></div></div>
<div class="ttc" id="eosio__contract_8hpp_html"><div class="ttname"><a href="eosio__contract_8hpp.html">eosio_contract.hpp</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_a110373007d0883c8065373719fdbdd5f_html_a110373007d0883c8065373719fdbdd5f"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_a110373007d0883c8065373719fdbdd5f.html#a110373007d0883c8065373719fdbdd5f">eosio::chain::controller::fetch_block_by_number</a></div><div class="ttdeci">signed_block_ptr fetch_block_by_number(uint32_t block_num) const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01251">controller.cpp:1251</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1global__property__object_html"><div class="ttname"><a href="classeosio_1_1chain_1_1global__property__object.html">eosio::chain::global_property_object</a></div><div class="ttdoc">Maintains global state information (committee_member list, current fees)This is an implementation det...</div><div class="ttdef"><b>Definition:</b> <a href="global__property__object_8hpp_source.html#l00027">global_property_object.hpp:27</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1block__header__state_a3e3f59359928472ef235acb057987bf5_html_a3e3f59359928472ef235acb057987bf5"><div class="ttname"><a href="structeosio_1_1chain_1_1block__header__state_a3e3f59359928472ef235acb057987bf5.html#a3e3f59359928472ef235acb057987bf5">eosio::chain::block_header_state::block_num</a></div><div class="ttdeci">uint32_t block_num</div><div class="ttdef"><b>Definition:</b> <a href="block__header__state_8hpp_source.html#l00013">block_header_state.hpp:13</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_abb36a4cdea263625153b6f5627b56508_html_abb36a4cdea263625153b6f5627b56508"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_abb36a4cdea263625153b6f5627b56508.html#abb36a4cdea263625153b6f5627b56508">eosio::chain::controller::abort_block</a></div><div class="ttdeci">void abort_block()</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01172">controller.cpp:1172</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1account__object_html"><div class="ttname"><a href="classeosio_1_1chain_1_1account__object.html">eosio::chain::account_object</a></div><div class="ttdef"><b>Definition:</b> <a href="account__object_8hpp_source.html#l00015">account_object.hpp:15</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller_1_1config_html"><div class="ttname"><a href="structeosio_1_1chain_1_1controller_1_1config.html">eosio::chain::controller::config</a></div><div class="ttdef"><b>Definition:</b> <a href="controller_8hpp_source.html#l00038">controller.hpp:38</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_aebe63c1592e75a9c9582b18edc695f17_html_aebe63c1592e75a9c9582b18edc695f17"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_aebe63c1592e75a9c9582b18edc695f17.html#aebe63c1592e75a9c9582b18edc695f17">eosio::chain::controller::push_transaction</a></div><div class="ttdeci">transaction_trace_ptr push_transaction(const transaction_metadata_ptr &amp;trx, fc::time_point deadline, uint32_t billed_cpu_time_us=0)</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01184">controller.cpp:1184</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_afb4a1df1715a88764f246867c5d32796_html_afb4a1df1715a88764f246867c5d32796"><div class="ttname"><a href="namespaceeosio_1_1chain_afb4a1df1715a88764f246867c5d32796.html#afb4a1df1715a88764f246867c5d32796">eosio::chain::action_name</a></div><div class="ttdeci">eosio::chain::action_name action_name</div><div class="ttdef"><b>Definition:</b> <a href="contract__types_8hpp_source.html#l00010">contract_types.hpp:10</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_aefc14531638f18365926345eb19fa2e6_html_aefc14531638f18365926345eb19fa2e6"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_aefc14531638f18365926345eb19fa2e6.html#aefc14531638f18365926345eb19fa2e6">eosio::chain::controller::block_status</a></div><div class="ttdeci">block_status</div><div class="ttdef"><b>Definition:</b> <a href="controller_8hpp_source.html#l00055">controller.hpp:55</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_a59302140653329127e39e4bb54bd0ba8_html_a59302140653329127e39e4bb54bd0ba8"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_a59302140653329127e39e4bb54bd0ba8.html#a59302140653329127e39e4bb54bd0ba8">eosio::chain::controller_impl::pending</a></div><div class="ttdeci">optional&lt; pending_state &gt; pending</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00051">controller.cpp:51</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_ade09ae48b91403772a989be0ba9ab324_html_ade09ae48b91403772a989be0ba9ab324"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_ade09ae48b91403772a989be0ba9ab324.html#ade09ae48b91403772a989be0ba9ab324">eosio::chain::controller::get_unapplied_transactions</a></div><div class="ttdeci">vector&lt; transaction_metadata_ptr &gt; get_unapplied_transactions() const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01373">controller.cpp:1373</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_a344c7895a93edd0d2af298a0cd69d720_html_a344c7895a93edd0d2af298a0cd69d720"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_a344c7895a93edd0d2af298a0cd69d720.html#a344c7895a93edd0d2af298a0cd69d720">eosio::chain::controller_impl::commit_block</a></div><div class="ttdeci">void commit_block(bool add_to_fork_db)</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00400">controller.cpp:400</a></div></div>
<div class="ttc" id="transaction__object_8hpp_html"><div class="ttname"><a href="transaction__object_8hpp.html">transaction_object.hpp</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1block__log_a0f249b7ed0343f32d022c7a1e16d97cb_html_a0f249b7ed0343f32d022c7a1e16d97cb"><div class="ttname"><a href="classeosio_1_1chain_1_1block__log_a0f249b7ed0343f32d022c7a1e16d97cb.html#a0f249b7ed0343f32d022c7a1e16d97cb">eosio::chain::block_log::read_block_by_num</a></div><div class="ttdeci">signed_block_ptr read_block_by_num(uint32_t block_num) const</div><div class="ttdef"><b>Definition:</b> <a href="block__log_8cpp_source.html#l00253">block_log.cpp:253</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_a7872719d533c96482bda49179dc79f42_html_a7872719d533c96482bda49179dc79f42"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_a7872719d533c96482bda49179dc79f42.html#a7872719d533c96482bda49179dc79f42">eosio::chain::controller_impl::authorization</a></div><div class="ttdeci">authorization_manager authorization</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00056">controller.cpp:56</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_ac7e099b137d6edfd2ae97b91b8fc8a80_html_ac7e099b137d6edfd2ae97b91b8fc8a80"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_ac7e099b137d6edfd2ae97b91b8fc8a80.html#ac7e099b137d6edfd2ae97b91b8fc8a80">eosio::chain::controller_impl::unapplied_transactions</a></div><div class="ttdeci">map&lt; digest_type, transaction_metadata_ptr &gt; unapplied_transactions</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00069">controller.cpp:69</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_acff9fd37a1180bbae38d1d4c03ff59e7_html_acff9fd37a1180bbae38d1d4c03ff59e7"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_acff9fd37a1180bbae38d1d4c03ff59e7.html#acff9fd37a1180bbae38d1d4c03ff59e7">eosio::chain::controller::head_block_time</a></div><div class="ttdeci">time_point head_block_time() const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01196">controller.cpp:1196</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1dynamic__global__property__object_html"><div class="ttname"><a href="classeosio_1_1chain_1_1dynamic__global__property__object.html">eosio::chain::dynamic_global_property_object</a></div><div class="ttdoc">Maintains global state information (committee_member list, current fees)This is an implementation det...</div><div class="ttdef"><b>Definition:</b> <a href="global__property__object_8hpp_source.html#l00048">global_property_object.hpp:48</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_a228b725ef94d2c3ac58adb8dde5529ac_html_a228b725ef94d2c3ac58adb8dde5529ac"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_a228b725ef94d2c3ac58adb8dde5529ac.html#a228b725ef94d2c3ac58adb8dde5529ac">eosio::chain::controller::commit_block</a></div><div class="ttdeci">void commit_block()</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01168">controller.cpp:1168</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1unlinkauth_html"><div class="ttname"><a href="structeosio_1_1chain_1_1unlinkauth.html">eosio::chain::unlinkauth</a></div><div class="ttdef"><b>Definition:</b> <a href="contract__types_8hpp_source.html#l00109">contract_types.hpp:109</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_a7b01c847954f3c105dc2df798636c2a7_html_a7b01c847954f3c105dc2df798636c2a7"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_a7b01c847954f3c105dc2df798636c2a7.html#a7b01c847954f3c105dc2df798636c2a7">eosio::chain::controller_impl::pop_block</a></div><div class="ttdeci">void pop_block()</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00071">controller.cpp:71</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1fork__database_af12004b2f63091cfcf76dae31197f324_html_af12004b2f63091cfcf76dae31197f324"><div class="ttname"><a href="classeosio_1_1chain_1_1fork__database_af12004b2f63091cfcf76dae31197f324.html#af12004b2f63091cfcf76dae31197f324">eosio::chain::fork_database::get_block</a></div><div class="ttdeci">block_state_ptr get_block(const block_id_type &amp;id) const</div><div class="ttdef"><b>Definition:</b> <a href="fork__database_8cpp_source.html#l00272">fork_database.cpp:272</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_ac44cfb3fa2ece7d456d9159f4afd9fe0_html_ac44cfb3fa2ece7d456d9159f4afd9fe0"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_ac44cfb3fa2ece7d456d9159f4afd9fe0.html#ac44cfb3fa2ece7d456d9159f4afd9fe0">eosio::chain::controller::contracts_console</a></div><div class="ttdeci">bool contracts_console() const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01346">controller.cpp:1346</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_a2af3155c69a0faecfb5adc06480d3078_html_a2af3155c69a0faecfb5adc06480d3078"><div class="ttname"><a href="namespaceeosio_1_1chain_a2af3155c69a0faecfb5adc06480d3078.html#a2af3155c69a0faecfb5adc06480d3078">eosio::chain::transaction_metadata_ptr</a></div><div class="ttdeci">std::shared_ptr&lt; transaction_metadata &gt; transaction_metadata_ptr</div><div class="ttdef"><b>Definition:</b> <a href="transaction__metadata_8hpp_source.html#l00048">transaction_metadata.hpp:48</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1chain__id__type_html"><div class="ttname"><a href="structeosio_1_1chain_1_1chain__id__type.html">eosio::chain::chain_id_type</a></div><div class="ttdef"><b>Definition:</b> <a href="chain__id__type_8hpp_source.html#l00022">chain_id_type.hpp:22</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_a14fbd4c9b2573d856047acbf17b4f2c9_html_a14fbd4c9b2573d856047acbf17b4f2c9"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_a14fbd4c9b2573d856047acbf17b4f2c9.html#a14fbd4c9b2573d856047acbf17b4f2c9">eosio::chain::controller::get_scheduled_transactions</a></div><div class="ttdeci">vector&lt; transaction_id_type &gt; get_scheduled_transactions() const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01386">controller.cpp:1386</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1action_a41392a69085f8138021b914c83e6ed9a_html_a41392a69085f8138021b914c83e6ed9a"><div class="ttname"><a href="structeosio_1_1chain_1_1action_a41392a69085f8138021b914c83e6ed9a.html#a41392a69085f8138021b914c83e6ed9a">eosio::chain::action::authorization</a></div><div class="ttdeci">vector&lt; permission_level &gt; authorization</div><div class="ttdef"><b>Definition:</b> <a href="action_8hpp_source.html#l00062">action.hpp:62</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1resource__limits_1_1resource__limits__manager_html"><div class="ttname"><a href="classeosio_1_1chain_1_1resource__limits_1_1resource__limits__manager.html">eosio::chain::resource_limits::resource_limits_manager</a></div><div class="ttdef"><b>Definition:</b> <a href="resource__limits_8hpp_source.html#l00035">resource_limits.hpp:35</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1block__header__state_a49fa283af011bd3e7ebbea4cac9dd24b_html_a49fa283af011bd3e7ebbea4cac9dd24b"><div class="ttname"><a href="structeosio_1_1chain_1_1block__header__state_a49fa283af011bd3e7ebbea4cac9dd24b.html#a49fa283af011bd3e7ebbea4cac9dd24b">eosio::chain::block_header_state::header</a></div><div class="ttdeci">signed_block_header header</div><div class="ttdef"><b>Definition:</b> <a href="block__header__state_8hpp_source.html#l00014">block_header_state.hpp:14</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1block__summary__object_html"><div class="ttname"><a href="classeosio_1_1chain_1_1block__summary__object.html">eosio::chain::block_summary_object</a></div><div class="ttdoc">tracks minimal information about past blocks to implement TaPOSWhen attempting to calculate the valid...</div><div class="ttdef"><b>Definition:</b> <a href="block__summary__object_8hpp_source.html#l00020">block_summary_object.hpp:20</a></div></div>
<div class="ttc" id="contract__table__objects_8hpp_html"><div class="ttname"><a href="contract__table__objects_8hpp.html">contract_table_objects.hpp</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1pending__state_a423b424b888f3ed111faddbcc5169c5b_html_a423b424b888f3ed111faddbcc5169c5b"><div class="ttname"><a href="structeosio_1_1chain_1_1pending__state_a423b424b888f3ed111faddbcc5169c5b.html#a423b424b888f3ed111faddbcc5169c5b">eosio::chain::pending_state::pending_state</a></div><div class="ttdeci">pending_state(database::session &amp;&amp;s)</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00030">controller.cpp:30</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_aefc14531638f18365926345eb19fa2e6_html_aefc14531638f18365926345eb19fa2e6a7e6e4eb3ff27864637756cb4d2a2a45d"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_aefc14531638f18365926345eb19fa2e6.html#aefc14531638f18365926345eb19fa2e6a7e6e4eb3ff27864637756cb4d2a2a45d">eosio::chain::controller::block_status::irreversible</a></div><div class="ttdoc">this block has already been applied before by this node and is considered irreversible ...</div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_a5f3cb69b19dc32404a9263702d89e875_html_a5f3cb69b19dc32404a9263702d89e875"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_a5f3cb69b19dc32404a9263702d89e875.html#a5f3cb69b19dc32404a9263702d89e875">eosio::chain::controller::get_dynamic_global_properties</a></div><div class="ttdeci">const dynamic_global_property_object &amp; get_dynamic_global_properties() const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01236">controller.cpp:1236</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_a24edd3b1a472139646fa4ae4ac43f71d_html_a24edd3b1a472139646fa4ae4ac43f71d"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_a24edd3b1a472139646fa4ae4ac43f71d.html#a24edd3b1a472139646fa4ae4ac43f71d">eosio::chain::controller::pop_block</a></div><div class="ttdeci">void pop_block()</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01274">controller.cpp:1274</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1genesis__state_a4f41d002ea3a0736293498c178a34a28_html_a4f41d002ea3a0736293498c178a34a28"><div class="ttname"><a href="structeosio_1_1chain_1_1genesis__state_a4f41d002ea3a0736293498c178a34a28.html#a4f41d002ea3a0736293498c178a34a28">eosio::chain::genesis_state::initial_key</a></div><div class="ttdeci">public_key_type initial_key</div><div class="ttdef"><b>Definition:</b> <a href="genesis__state_8hpp_source.html#l00046">genesis_state.hpp:46</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_a2593b2f5863eb130ff4d4fc9ce2574ab_html_a2593b2f5863eb130ff4d4fc9ce2574ab"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_a2593b2f5863eb130ff4d4fc9ce2574ab.html#a2593b2f5863eb130ff4d4fc9ce2574ab">eosio::chain::controller_impl::set_apply_handler</a></div><div class="ttdeci">void set_apply_handler(account_name receiver, account_name contract, action_name action, apply_handler v)</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00088">controller.cpp:88</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1generated__transaction__object_html"><div class="ttname"><a href="classeosio_1_1chain_1_1generated__transaction__object.html">eosio::chain::generated_transaction_object</a></div><div class="ttdef"><b>Definition:</b> <a href="generated__transaction__object_8hpp_source.html#l00025">generated_transaction_object.hpp:25</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1resource__limits_1_1resource__limits__manager_a221e58d79e2b684714cb1acc19da5492_html_a221e58d79e2b684714cb1acc19da5492"><div class="ttname"><a href="classeosio_1_1chain_1_1resource__limits_1_1resource__limits__manager_a221e58d79e2b684714cb1acc19da5492.html#a221e58d79e2b684714cb1acc19da5492">eosio::chain::resource_limits::resource_limits_manager::add_pending_ram_usage</a></div><div class="ttdeci">void add_pending_ram_usage(const account_name account, int64_t ram_delta)</div><div class="ttdef"><b>Definition:</b> <a href="resource__limits_8cpp_source.html#l00160">resource_limits.cpp:160</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_a5e1cd636c73b6f40e125abcfd0703451_html_a5e1cd636c73b6f40e125abcfd0703451"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_a5e1cd636c73b6f40e125abcfd0703451.html#a5e1cd636c73b6f40e125abcfd0703451">eosio::chain::controller_impl::emit</a></div><div class="ttdeci">void emit(const Signal &amp;s, Arg &amp;&amp;a)</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00143">controller.cpp:143</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1transaction_a768465b5929ca1291b303294f353b1c5_html_a768465b5929ca1291b303294f353b1c5"><div class="ttname"><a href="structeosio_1_1chain_1_1transaction_a768465b5929ca1291b303294f353b1c5.html#a768465b5929ca1291b303294f353b1c5">eosio::chain::transaction::actions</a></div><div class="ttdeci">vector&lt; action &gt; actions</div><div class="ttdef"><b>Definition:</b> <a href="transaction_8hpp_source.html#l00056">transaction.hpp:56</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_aefc14531638f18365926345eb19fa2e6_html_aefc14531638f18365926345eb19fa2e6a5ed4e9858ad8d239145ef285b6210a00"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_aefc14531638f18365926345eb19fa2e6.html#aefc14531638f18365926345eb19fa2e6a5ed4e9858ad8d239145ef285b6210a00">eosio::chain::controller::block_status::incomplete</a></div><div class="ttdoc">this is an incomplete block (either being produced by a producer or speculatively produced by a node)...</div></div>
<div class="ttc" id="structeosio_1_1chain_1_1pending__state_html"><div class="ttname"><a href="structeosio_1_1chain_1_1pending__state.html">eosio::chain::pending_state</a></div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00029">controller.cpp:29</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_1_1wasm__ops_a4eff4c3a5ad1e8e813e0087e2f72c17b_html_a4eff4c3a5ad1e8e813e0087e2f72c17b"><div class="ttname"><a href="namespaceeosio_1_1chain_1_1wasm__ops_a4eff4c3a5ad1e8e813e0087e2f72c17b.html#a4eff4c3a5ad1e8e813e0087e2f72c17b">eosio::chain::wasm_ops::code</a></div><div class="ttdeci">code</div><div class="ttdef"><b>Definition:</b> <a href="wasm__eosio__binary__ops_8hpp_source.html#l00349">wasm_eosio_binary_ops.hpp:349</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1fork__database_ae3d07c1d16a79bb7f9d47ef0e972656b_html_ae3d07c1d16a79bb7f9d47ef0e972656b"><div class="ttname"><a href="classeosio_1_1chain_1_1fork__database_ae3d07c1d16a79bb7f9d47ef0e972656b.html#ae3d07c1d16a79bb7f9d47ef0e972656b">eosio::chain::fork_database::close</a></div><div class="ttdeci">void close()</div><div class="ttdef"><b>Definition:</b> <a href="fork__database_8cpp_source.html#l00079">fork_database.cpp:79</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_a432018c55e824a3056b823dee7c67f8d_html_a432018c55e824a3056b823dee7c67f8d"><div class="ttname"><a href="namespaceeosio_1_1chain_a432018c55e824a3056b823dee7c67f8d.html#a432018c55e824a3056b823dee7c67f8d">eosio::chain::eosio_contract_abi</a></div><div class="ttdeci">abi_def eosio_contract_abi(const abi_def &amp;eosio_system_abi)</div><div class="ttdef"><b>Definition:</b> <a href="eosio__contract__abi_8cpp_source.html#l00020">eosio_contract_abi.cpp:20</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1block__log_a3afac3abf8906f2491c58110fca00155_html_a3afac3abf8906f2491c58110fca00155"><div class="ttname"><a href="classeosio_1_1chain_1_1block__log_a3afac3abf8906f2491c58110fca00155.html#a3afac3abf8906f2491c58110fca00155">eosio::chain::block_log::read_head</a></div><div class="ttdeci">signed_block_ptr read_head() const</div><div class="ttdef"><b>Definition:</b> <a href="block__log_8cpp_source.html#l00277">block_log.cpp:277</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_ac19fb56771d15ea996c2806a46eeaf25_html_ac19fb56771d15ea996c2806a46eeaf25"><div class="ttname"><a href="namespaceeosio_1_1chain_ac19fb56771d15ea996c2806a46eeaf25.html#ac19fb56771d15ea996c2806a46eeaf25">eosio::chain::transaction_id_type</a></div><div class="ttdeci">checksum_type transaction_id_type</div><div class="ttdef"><b>Definition:</b> <a href="types_8hpp_source.html#l00164">types.hpp:164</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_a111d77f0d2612865e9de37f1633cf14f_html_a111d77f0d2612865e9de37f1633cf14f"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_a111d77f0d2612865e9de37f1633cf14f.html#a111d77f0d2612865e9de37f1633cf14f">eosio::chain::controller::last_irreversible_block_id</a></div><div class="ttdeci">block_id_type last_irreversible_block_id() const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01225">controller.cpp:1225</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_a2fcaeb618b6d93ef2025847764c8543f_html_a2fcaeb618b6d93ef2025847764c8543f"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_a2fcaeb618b6d93ef2025847764c8543f.html#a2fcaeb618b6d93ef2025847764c8543f">eosio::chain::controller::get_chain_id</a></div><div class="ttdeci">chain_id_type get_chain_id() const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01350">controller.cpp:1350</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_a675086138c644442ef3a084e027a7d5a_html_a675086138c644442ef3a084e027a7d5a"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_a675086138c644442ef3a084e027a7d5a.html#a675086138c644442ef3a084e027a7d5a">eosio::chain::controller::pending_block_time</a></div><div class="ttdeci">time_point pending_block_time() const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01216">controller.cpp:1216</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1canceldelay_html"><div class="ttname"><a href="structeosio_1_1chain_1_1canceldelay.html">eosio::chain::canceldelay</a></div><div class="ttdef"><b>Definition:</b> <a href="contract__types_8hpp_source.html#l00128">contract_types.hpp:128</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_adbe569ad52efdaa687486381712d5121_html_adbe569ad52efdaa687486381712d5121"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_adbe569ad52efdaa687486381712d5121.html#adbe569ad52efdaa687486381712d5121">eosio::chain::controller_impl::chain_id</a></div><div class="ttdeci">chain_id_type chain_id</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00058">controller.cpp:58</a></div></div>
<div class="ttc" id="global__property__object_8hpp_html"><div class="ttname"><a href="global__property__object_8hpp.html">global_property_object.hpp</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1producer__schedule__type_html"><div class="ttname"><a href="structeosio_1_1chain_1_1producer__schedule__type.html">eosio::chain::producer_schedule_type</a></div><div class="ttdef"><b>Definition:</b> <a href="producer__schedule_8hpp_source.html#l00025">producer_schedule.hpp:25</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1block__header_html"><div class="ttname"><a href="structeosio_1_1chain_1_1block__header.html">eosio::chain::block_header</a></div><div class="ttdef"><b>Definition:</b> <a href="block__header_8hpp_source.html#l00007">block_header.hpp:7</a></div></div>
<div class="ttc" id="transaction__context_8hpp_html"><div class="ttname"><a href="transaction__context_8hpp.html">transaction_context.hpp</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_aeb54dc422fa3fcbf3f8c2df1793da46f_html_aeb54dc422fa3fcbf3f8c2df1793da46f"><div class="ttname"><a href="namespaceeosio_1_1chain_aeb54dc422fa3fcbf3f8c2df1793da46f.html#aeb54dc422fa3fcbf3f8c2df1793da46f">eosio::chain::key_value_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; key_value_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, member&lt; key_value_object, key_value_object::id_type, &amp;key_value_object::id &gt; &gt;, ordered_unique&lt; tag&lt; by_scope_primary &gt;, composite_key&lt; key_value_object, member&lt; key_value_object, table_id, &amp;key_value_object::t_id &gt;, member&lt; key_value_object, uint64_t, &amp;key_value_object::primary_key &gt; &gt;, composite_key_compare&lt; std::less&lt; table_id &gt;, std::less&lt; uint64_t &gt; &gt; &gt; &gt; &gt; key_value_index</div><div class="ttdef"><b>Definition:</b> <a href="contract__table__objects_8hpp_source.html#l00082">contract_table_objects.hpp:82</a></div></div>
<div class="ttc" id="resource__limits_8hpp_html"><div class="ttname"><a href="resource__limits_8hpp.html">resource_limits.hpp</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_adf4d23d76329a7feb6669ff6c00c8f76_html_adf4d23d76329a7feb6669ff6c00c8f76"><div class="ttname"><a href="namespaceeosio_1_1chain_adf4d23d76329a7feb6669ff6c00c8f76.html#adf4d23d76329a7feb6669ff6c00c8f76">eosio::chain::index_double_index</a></div><div class="ttdeci">secondary_index&lt; float64_t, index_double_object_type, soft_double_less &gt;::index_index index_double_index</div><div class="ttdef"><b>Definition:</b> <a href="contract__table__objects_8hpp_source.html#l00153">contract_table_objects.hpp:153</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_acba3f443f4c230c24aac1fe9ef6560c9_html_acba3f443f4c230c24aac1fe9ef6560c9"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_acba3f443f4c230c24aac1fe9ef6560c9.html#acba3f443f4c230c24aac1fe9ef6560c9">eosio::chain::controller::get_block_id_for_num</a></div><div class="ttdeci">block_id_type get_block_id_for_num(uint32_t block_num) const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01260">controller.cpp:1260</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1newaccount_html"><div class="ttname"><a href="structeosio_1_1chain_1_1newaccount.html">eosio::chain::newaccount</a></div><div class="ttdef"><b>Definition:</b> <a href="contract__types_8hpp_source.html#l00012">contract_types.hpp:12</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_aab529d0705068032cf285096bd8a911b_html_aab529d0705068032cf285096bd8a911b"><div class="ttname"><a href="namespaceeosio_1_1chain_aab529d0705068032cf285096bd8a911b.html#aab529d0705068032cf285096bd8a911b">eosio::chain::signed_block_ptr</a></div><div class="ttdeci">std::shared_ptr&lt; signed_block &gt; signed_block_ptr</div><div class="ttdef"><b>Definition:</b> <a href="block_8hpp_source.html#l00061">block.hpp:61</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1pending__state_af0d6debfaef54e452f92d73179de98af_html_af0d6debfaef54e452f92d73179de98af"><div class="ttname"><a href="structeosio_1_1chain_1_1pending__state_af0d6debfaef54e452f92d73179de98af.html#af0d6debfaef54e452f92d73179de98af">eosio::chain::pending_state::_pending_block_state</a></div><div class="ttdeci">block_state_ptr _pending_block_state</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00035">controller.cpp:35</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_a1bad8b23919a2869f2a4638b0cccda87_html_a1bad8b23919a2869f2a4638b0cccda87"><div class="ttname"><a href="namespaceeosio_1_1chain_a1bad8b23919a2869f2a4638b0cccda87.html#a1bad8b23919a2869f2a4638b0cccda87">eosio::chain::table_id_multi_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; table_id_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, member&lt; table_id_object, table_id_object::id_type, &amp;table_id_object::id &gt; &gt;, ordered_unique&lt; tag&lt; by_code_scope_table &gt;, composite_key&lt; table_id_object, member&lt; table_id_object, account_name, &amp;table_id_object::code &gt;, member&lt; table_id_object, scope_name, &amp;table_id_object::scope &gt;, member&lt; table_id_object, table_name, &amp;table_id_object::table &gt; &gt; &gt; &gt; &gt; table_id_multi_index</div><div class="ttdef"><b>Definition:</b> <a href="contract__table__objects_8hpp_source.html#l00048">contract_table_objects.hpp:48</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1action_html"><div class="ttname"><a href="structeosio_1_1chain_1_1action.html">eosio::chain::action</a></div><div class="ttdef"><b>Definition:</b> <a href="action_8hpp_source.html#l00059">action.hpp:59</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_aa247bdb7f6be53fd85d960c18972d972_html_aa247bdb7f6be53fd85d960c18972d972"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_aa247bdb7f6be53fd85d960c18972d972.html#aa247bdb7f6be53fd85d960c18972d972">eosio::chain::controller::validate_tapos</a></div><div class="ttdeci">void validate_tapos(const transaction &amp;t) const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01454">controller.cpp:1454</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_a8f54c478a172bdd2d3fa523fdb30d144_html_a8f54c478a172bdd2d3fa523fdb30d144"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_a8f54c478a172bdd2d3fa523fdb30d144.html#a8f54c478a172bdd2d3fa523fdb30d144">eosio::chain::controller_impl::~controller_impl</a></div><div class="ttdeci">~controller_impl()</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00256">controller.cpp:256</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1chain__config_a57ec7cb5cdb3e6f1f63132f2f51b3ffb_html_a57ec7cb5cdb3e6f1f63132f2f51b3ffb"><div class="ttname"><a href="structeosio_1_1chain_1_1chain__config_a57ec7cb5cdb3e6f1f63132f2f51b3ffb.html#a57ec7cb5cdb3e6f1f63132f2f51b3ffb">eosio::chain::chain_config::validate</a></div><div class="ttdeci">void validate() const</div><div class="ttdef"><b>Definition:</b> <a href="chain__config_8cpp_source.html#l00011">chain_config.cpp:11</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_ad4e44163991ff7b3ffbbc3d257007f42_html_ad4e44163991ff7b3ffbbc3d257007f42"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_ad4e44163991ff7b3ffbbc3d257007f42.html#ad4e44163991ff7b3ffbbc3d257007f42">eosio::chain::controller::head_block_num</a></div><div class="ttdeci">uint32_t head_block_num() const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01193">controller.cpp:1193</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1signed__transaction_html"><div class="ttname"><a href="structeosio_1_1chain_1_1signed__transaction.html">eosio::chain::signed_transaction</a></div><div class="ttdef"><b>Definition:</b> <a href="transaction_8hpp_source.html#l00077">transaction.hpp:77</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_ae5391da2367f807ec2faa52a276cfeab_html_ae5391da2367f807ec2faa52a276cfeab"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_ae5391da2367f807ec2faa52a276cfeab.html#ae5391da2367f807ec2faa52a276cfeab">eosio::chain::controller_impl::init</a></div><div class="ttdeci">void init()</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00185">controller.cpp:185</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1authorization__manager_ae85e228f0e9419b747f1c592e6d422b1_html_ae85e228f0e9419b747f1c592e6d422b1"><div class="ttname"><a href="classeosio_1_1chain_1_1authorization__manager_ae85e228f0e9419b747f1c592e6d422b1.html#ae85e228f0e9419b747f1c592e6d422b1">eosio::chain::authorization_manager::get_permission</a></div><div class="ttdeci">const permission_object &amp; get_permission(const permission_level &amp;level) const</div><div class="ttdef"><b>Definition:</b> <a href="authorization__manager_8cpp_source.html#l00119">authorization_manager.cpp:119</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_aec85d64adb4800da30db8bc314cb3843_html_aec85d64adb4800da30db8bc314cb3843"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_aec85d64adb4800da30db8bc314cb3843.html#aec85d64adb4800da30db8bc314cb3843">eosio::chain::controller::push_block</a></div><div class="ttdeci">void push_block(const signed_block_ptr &amp;b, block_status s=block_status::complete)</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01176">controller.cpp:1176</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_a589cc4ccddcc2325401bc7114b2e0f2d_html_a589cc4ccddcc2325401bc7114b2e0f2d"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_a589cc4ccddcc2325401bc7114b2e0f2d.html#a589cc4ccddcc2325401bc7114b2e0f2d">eosio::chain::controller_impl::reversible_blocks</a></div><div class="ttdeci">chainbase::database reversible_blocks</div><div class="ttdoc">a special database to persist blocks that have successfully been applied but are still reversible ...</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00049">controller.cpp:49</a></div></div>
<div class="ttc" id="account__object_8hpp_html"><div class="ttname"><a href="account__object_8hpp.html">account_object.hpp</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1pending__state_a3aaa36e814d0dda471485780ce3f039a_html_a3aaa36e814d0dda471485780ce3f039a"><div class="ttname"><a href="structeosio_1_1chain_1_1pending__state_a3aaa36e814d0dda471485780ce3f039a.html#a3aaa36e814d0dda471485780ce3f039a">eosio::chain::pending_state::_actions</a></div><div class="ttdeci">vector&lt; action_receipt &gt; _actions</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00037">controller.cpp:37</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1abi__def_html"><div class="ttname"><a href="structeosio_1_1chain_1_1abi__def.html">eosio::chain::abi_def</a></div><div class="ttdef"><b>Definition:</b> <a href="abi__def_8hpp_source.html#l00097">abi_def.hpp:97</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_a5cdb950f1640260acf38ed7ac6e9d6f7_html_a5cdb950f1640260acf38ed7ac6e9d6f7"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_a5cdb950f1640260acf38ed7ac6e9d6f7.html#a5cdb950f1640260acf38ed7ac6e9d6f7">eosio::chain::controller_impl::on_irreversible</a></div><div class="ttdeci">void on_irreversible(const block_state_ptr &amp;s)</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00156">controller.cpp:156</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1authorization__manager_af81cfb509b0a2317a79f69d170dbadb3_html_af81cfb509b0a2317a79f69d170dbadb3"><div class="ttname"><a href="classeosio_1_1chain_1_1authorization__manager_af81cfb509b0a2317a79f69d170dbadb3.html#af81cfb509b0a2317a79f69d170dbadb3">eosio::chain::authorization_manager::add_indices</a></div><div class="ttdeci">void add_indices()</div><div class="ttdef"><b>Definition:</b> <a href="authorization__manager_8cpp_source.html#l00021">authorization_manager.cpp:21</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_af07f4641c4b3c0bf17b30ff312401d7f_html_af07f4641c4b3c0bf17b30ff312401d7f"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_af07f4641c4b3c0bf17b30ff312401d7f.html#af07f4641c4b3c0bf17b30ff312401d7f">eosio::chain::controller::head_block_state</a></div><div class="ttdeci">block_state_ptr head_block_state() const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01208">controller.cpp:1208</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1producer__schedule__type_a5c583841f43a04a1bc981885e79bf6d4_html_a5c583841f43a04a1bc981885e79bf6d4"><div class="ttname"><a href="structeosio_1_1chain_1_1producer__schedule__type_a5c583841f43a04a1bc981885e79bf6d4.html#a5c583841f43a04a1bc981885e79bf6d4">eosio::chain::producer_schedule_type::version</a></div><div class="ttdeci">uint32_t version</div><div class="ttdoc">sequentially incrementing version number </div><div class="ttdef"><b>Definition:</b> <a href="producer__schedule_8hpp_source.html#l00026">producer_schedule.hpp:26</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1genesis__state_a1a52eef6a3a907b99a7539991200f03d_html_a1a52eef6a3a907b99a7539991200f03d"><div class="ttname"><a href="structeosio_1_1chain_1_1genesis__state_a1a52eef6a3a907b99a7539991200f03d.html#a1a52eef6a3a907b99a7539991200f03d">eosio::chain::genesis_state::initial_configuration</a></div><div class="ttdeci">chain_config initial_configuration</div><div class="ttdef"><b>Definition:</b> <a href="genesis__state_8hpp_source.html#l00023">genesis_state.hpp:23</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1linkauth_html"><div class="ttname"><a href="structeosio_1_1chain_1_1linkauth.html">eosio::chain::linkauth</a></div><div class="ttdef"><b>Definition:</b> <a href="contract__types_8hpp_source.html#l00089">contract_types.hpp:89</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1block__log_af65701d8271b67983f14a7161aac12aa_html_af65701d8271b67983f14a7161aac12aa"><div class="ttname"><a href="classeosio_1_1chain_1_1block__log_af65701d8271b67983f14a7161aac12aa.html#af65701d8271b67983f14a7161aac12aa">eosio::chain::block_log::head</a></div><div class="ttdeci">const signed_block_ptr &amp; head() const</div><div class="ttdef"><b>Definition:</b> <a href="block__log_8cpp_source.html#l00292">block_log.cpp:292</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1resource__limits_1_1resource__limits__manager_a20d3da9fa3e3c322db28670d4f2e589b_html_a20d3da9fa3e3c322db28670d4f2e589b"><div class="ttname"><a href="classeosio_1_1chain_1_1resource__limits_1_1resource__limits__manager_a20d3da9fa3e3c322db28670d4f2e589b.html#a20d3da9fa3e3c322db28670d4f2e589b">eosio::chain::resource_limits::resource_limits_manager::initialize_database</a></div><div class="ttdeci">void initialize_database()</div><div class="ttdef"><b>Definition:</b> <a href="resource__limits_8cpp_source.html#l00048">resource_limits.cpp:48</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1fork__database_acca8c09eb357d95a2fc2e989a40ffc89_html_acca8c09eb357d95a2fc2e989a40ffc89"><div class="ttname"><a href="classeosio_1_1chain_1_1fork__database_acca8c09eb357d95a2fc2e989a40ffc89.html#acca8c09eb357d95a2fc2e989a40ffc89">eosio::chain::fork_database::set</a></div><div class="ttdeci">void set(block_state_ptr s)</div><div class="ttdef"><b>Definition:</b> <a href="fork__database_8cpp_source.html#l00115">fork_database.cpp:115</a></div></div>
<div class="ttc" id="controller_8cpp_a903c4d2c725a565b423b8c7978ba252c_html_a903c4d2c725a565b423b8c7978ba252c"><div class="ttname"><a href="controller_8cpp_a903c4d2c725a565b423b8c7978ba252c.html#a903c4d2c725a565b423b8c7978ba252c">SET_APP_HANDLER</a></div><div class="ttdeci">#define SET_APP_HANDLER(receiver, contract, action)</div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_a4be8b9052764dd73e4a710293d3b876e_html_a4be8b9052764dd73e4a710293d3b876e"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_a4be8b9052764dd73e4a710293d3b876e.html#a4be8b9052764dd73e4a710293d3b876e">eosio::chain::controller_impl::controller_impl</a></div><div class="ttdeci">controller_impl(const controller::config &amp;cfg, controller &amp;s)</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00092">controller.cpp:92</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_adcccc8516a37dbd5d37def1aadfe4a82_html_adcccc8516a37dbd5d37def1aadfe4a82"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_adcccc8516a37dbd5d37def1aadfe4a82.html#adcccc8516a37dbd5d37def1aadfe4a82">eosio::chain::controller::head_block_id</a></div><div class="ttdeci">block_id_type head_block_id() const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01199">controller.cpp:1199</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1transaction__header_acb8d4b05d574db9550dda7ae24f62d3e_html_acb8d4b05d574db9550dda7ae24f62d3e"><div class="ttname"><a href="structeosio_1_1chain_1_1transaction__header_acb8d4b05d574db9550dda7ae24f62d3e.html#acb8d4b05d574db9550dda7ae24f62d3e">eosio::chain::transaction_header::expiration</a></div><div class="ttdeci">time_point_sec expiration</div><div class="ttdoc">the time at which a transaction expires </div><div class="ttdef"><b>Definition:</b> <a href="transaction_8hpp_source.html#l00031">transaction.hpp:31</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_af5042e3b6e189bfd9d666ba6e4e6b00b_html_af5042e3b6e189bfd9d666ba6e4e6b00b"><div class="ttname"><a href="namespaceeosio_1_1chain_af5042e3b6e189bfd9d666ba6e4e6b00b.html#af5042e3b6e189bfd9d666ba6e4e6b00b">eosio::chain::reversible_block_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; reversible_block_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, member&lt; reversible_block_object, reversible_block_object::id_type, &amp;reversible_block_object::id &gt; &gt;, ordered_unique&lt; tag&lt; by_num &gt;, member&lt; reversible_block_object, uint32_t, &amp;reversible_block_object::blocknum &gt; &gt; &gt; &gt; reversible_block_index</div><div class="ttdef"><b>Definition:</b> <a href="reversible__block__object_8hpp_source.html#l00044">reversible_block_object.hpp:44</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_a00f6845fc8587da5f9b4b1aa5e0d4115_html_a00f6845fc8587da5f9b4b1aa5e0d4115"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_a00f6845fc8587da5f9b4b1aa5e0d4115.html#a00f6845fc8587da5f9b4b1aa5e0d4115">eosio::chain::controller::find_apply_handler</a></div><div class="ttdeci">const apply_handler * find_apply_handler(account_name contract, scope_name scope, action_name act) const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01354">controller.cpp:1354</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1action_a902d64826c6d06f1ccb4be01bb7353a2_html_a902d64826c6d06f1ccb4be01bb7353a2"><div class="ttname"><a href="structeosio_1_1chain_1_1action_a902d64826c6d06f1ccb4be01bb7353a2.html#a902d64826c6d06f1ccb4be01bb7353a2">eosio::chain::action::name</a></div><div class="ttdeci">action_name name</div><div class="ttdef"><b>Definition:</b> <a href="action_8hpp_source.html#l00061">action.hpp:61</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_ac7ee942bcbf5a7b5bea07cb651db697e_html_ac7ee942bcbf5a7b5bea07cb651db697e"><div class="ttname"><a href="namespaceeosio_1_1chain_ac7ee942bcbf5a7b5bea07cb651db697e.html#ac7ee942bcbf5a7b5bea07cb651db697e">eosio::chain::index_long_double_index</a></div><div class="ttdeci">secondary_index&lt; float128_t, index_long_double_object_type, soft_long_double_less &gt;::index_index index_long_double_index</div><div class="ttdef"><b>Definition:</b> <a href="contract__table__objects_8hpp_source.html#l00161">contract_table_objects.hpp:161</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1setabi_html"><div class="ttname"><a href="structeosio_1_1chain_1_1setabi.html">eosio::chain::setabi</a></div><div class="ttdef"><b>Definition:</b> <a href="contract__types_8hpp_source.html#l00042">contract_types.hpp:42</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1action_adb73e3a236a3c11c104c6dd6ebad9429_html_adb73e3a236a3c11c104c6dd6ebad9429"><div class="ttname"><a href="structeosio_1_1chain_1_1action_adb73e3a236a3c11c104c6dd6ebad9429.html#adb73e3a236a3c11c104c6dd6ebad9429">eosio::chain::action::account</a></div><div class="ttdeci">account_name account</div><div class="ttdef"><b>Definition:</b> <a href="action_8hpp_source.html#l00060">action.hpp:60</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller_1_1config_a11b0f8fdb59a89d306fd8f75eeb734a2_html_a11b0f8fdb59a89d306fd8f75eeb734a2"><div class="ttname"><a href="structeosio_1_1chain_1_1controller_1_1config_a11b0f8fdb59a89d306fd8f75eeb734a2.html#a11b0f8fdb59a89d306fd8f75eeb734a2">eosio::chain::controller::config::genesis</a></div><div class="ttdeci">genesis_state genesis</div><div class="ttdef"><b>Definition:</b> <a href="controller_8hpp_source.html#l00051">controller.hpp:51</a></div></div>
<div class="ttc" id="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16_html_a2cb5d7112457a24df46ffcd923270e16"><div class="ttname"><a href="exceptions_8hpp_a2cb5d7112457a24df46ffcd923270e16.html#a2cb5d7112457a24df46ffcd923270e16">EOS_ASSERT</a></div><div class="ttdeci">#define EOS_ASSERT(expr, exc_type, FORMAT,...)</div><div class="ttdef"><b>Definition:</b> <a href="exceptions_8hpp_source.html#l00012">exceptions.hpp:12</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1header__confirmation_html"><div class="ttname"><a href="structeosio_1_1chain_1_1header__confirmation.html">eosio::chain::header_confirmation</a></div><div class="ttdef"><b>Definition:</b> <a href="block__header_8hpp_source.html#l00050">block_header.hpp:50</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_afe40963e3dd209e6457f7e482844466f_html_afe40963e3dd209e6457f7e482844466f"><div class="ttname"><a href="namespaceeosio_1_1chain_afe40963e3dd209e6457f7e482844466f.html#afe40963e3dd209e6457f7e482844466f">eosio::chain::block_id_type</a></div><div class="ttdeci">fc::sha256 block_id_type</div><div class="ttdef"><b>Definition:</b> <a href="types_8hpp_source.html#l00159">types.hpp:159</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_a826f8feab4d745ad1ae6ce3daff85774_html_a826f8feab4d745ad1ae6ce3daff85774"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_a826f8feab4d745ad1ae6ce3daff85774.html#a826f8feab4d745ad1ae6ce3daff85774">eosio::chain::controller::get_global_properties</a></div><div class="ttdeci">const global_property_object &amp; get_global_properties() const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01239">controller.cpp:1239</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_abda1ad5506d3b359cad3db85da70cff6_html_abda1ad5506d3b359cad3db85da70cff6"><div class="ttname"><a href="namespaceeosio_1_1chain_abda1ad5506d3b359cad3db85da70cff6.html#abda1ad5506d3b359cad3db85da70cff6">eosio::chain::index64_index</a></div><div class="ttdeci">secondary_index&lt; uint64_t, index64_object_type &gt;::index_index index64_index</div><div class="ttdef"><b>Definition:</b> <a href="contract__table__objects_8hpp_source.html#l00126">contract_table_objects.hpp:126</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1block__header__state_a1df750fdfdca0431b971cada82a68174_html_a1df750fdfdca0431b971cada82a68174"><div class="ttname"><a href="structeosio_1_1chain_1_1block__header__state_a1df750fdfdca0431b971cada82a68174.html#a1df750fdfdca0431b971cada82a68174">eosio::chain::block_header_state::pending_schedule_hash</a></div><div class="ttdeci">digest_type pending_schedule_hash</div><div class="ttdoc">last irr block num </div><div class="ttdef"><b>Definition:</b> <a href="block__header__state_8hpp_source.html#l00019">block_header_state.hpp:19</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_ad6e015097a10f08028a3e3df3b17ecdf_html_ad6e015097a10f08028a3e3df3b17ecdf"><div class="ttname"><a href="namespaceeosio_1_1chain_ad6e015097a10f08028a3e3df3b17ecdf.html#ad6e015097a10f08028a3e3df3b17ecdf">eosio::chain::transaction_exception</a></div><div class="ttdeci">chain type exception Invalid public key Invalid authority Invalid transaction No ABI found Invalid transaction ID Invalid asset unlinkable block transaction outputs in block do not match transaction outputs from applying block shard locks in block are incorrect or mal formed block is too old to push transaction_exception</div><div class="ttdef"><b>Definition:</b> <a href="exceptions_8hpp_source.html#l00145">exceptions.hpp:145</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1account__sequence__object_html"><div class="ttname"><a href="classeosio_1_1chain_1_1account__sequence__object.html">eosio::chain::account_sequence_object</a></div><div class="ttdef"><b>Definition:</b> <a href="account__object_8hpp_source.html#l00057">account_object.hpp:57</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_ab1bd65df491557845e333ba71af75c59_html_ab1bd65df491557845e333ba71af75c59"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_ab1bd65df491557845e333ba71af75c59.html#ab1bd65df491557845e333ba71af75c59">eosio::chain::controller::pending_block_state</a></div><div class="ttdeci">block_state_ptr pending_block_state() const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01212">controller.cpp:1212</a></div></div>
<div class="ttc" id="authorization__manager_8hpp_html"><div class="ttname"><a href="authorization__manager_8hpp.html">authorization_manager.hpp</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1transaction_a72659cea5d663a72934976c95ef151bc_html_a72659cea5d663a72934976c95ef151bc"><div class="ttname"><a href="structeosio_1_1chain_1_1transaction_a72659cea5d663a72934976c95ef151bc.html#a72659cea5d663a72934976c95ef151bc">eosio::chain::transaction::context_free_actions</a></div><div class="ttdeci">vector&lt; action &gt; context_free_actions</div><div class="ttdef"><b>Definition:</b> <a href="transaction_8hpp_source.html#l00055">transaction.hpp:55</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_ac484cce0ca8770cc52b847e3238a946b_html_ac484cce0ca8770cc52b847e3238a946b"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_ac484cce0ca8770cc52b847e3238a946b.html#ac484cce0ca8770cc52b847e3238a946b">eosio::chain::controller::head_block_producer</a></div><div class="ttdeci">account_name head_block_producer() const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01202">controller.cpp:1202</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1pending__state_a5a3481dd5961e2a18a916b95facfee45_html_a5a3481dd5961e2a18a916b95facfee45"><div class="ttname"><a href="structeosio_1_1chain_1_1pending__state_a5a3481dd5961e2a18a916b95facfee45.html#a5a3481dd5961e2a18a916b95facfee45">eosio::chain::pending_state::_block_status</a></div><div class="ttdeci">controller::block_status _block_status</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00039">controller.cpp:39</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_af99ca68873873e4f928250e0a52741fb_html_af99ca68873873e4f928250e0a52741fb"><div class="ttname"><a href="namespaceeosio_1_1chain_af99ca68873873e4f928250e0a52741fb.html#af99ca68873873e4f928250e0a52741fb">eosio::chain::account_sequence_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; account_sequence_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, member&lt; account_sequence_object, account_sequence_object::id_type, &amp;account_sequence_object::id &gt; &gt;, ordered_unique&lt; tag&lt; by_name &gt;, member&lt; account_sequence_object, account_name, &amp;account_sequence_object::name &gt; &gt; &gt; &gt; account_sequence_index</div><div class="ttdef"><b>Definition:</b> <a href="account__object_8hpp_source.html#l00076">account_object.hpp:76</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_aa21275c4089a29d9b84c30a95fab0efe_html_aa21275c4089a29d9b84c30a95fab0efe"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_aa21275c4089a29d9b84c30a95fab0efe.html#aa21275c4089a29d9b84c30a95fab0efe">eosio::chain::controller::is_producing_block</a></div><div class="ttdeci">bool is_producing_block() const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01406">controller.cpp:1406</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1block__header_a290b6c71de8b72e68f6c8d35013dc9aa_html_a290b6c71de8b72e68f6c8d35013dc9aa"><div class="ttname"><a href="structeosio_1_1chain_1_1block__header_a290b6c71de8b72e68f6c8d35013dc9aa.html#a290b6c71de8b72e68f6c8d35013dc9aa">eosio::chain::block_header::num_from_id</a></div><div class="ttdeci">static uint32_t num_from_id(const block_id_type &amp;id)</div><div class="ttdef"><b>Definition:</b> <a href="block__header_8cpp_source.html#l00017">block_header.cpp:17</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1fork__database_ae7998230cf13cc4476de64f77ce0d820_html_ae7998230cf13cc4476de64f77ce0d820"><div class="ttname"><a href="classeosio_1_1chain_1_1fork__database_ae7998230cf13cc4476de64f77ce0d820.html#ae7998230cf13cc4476de64f77ce0d820">eosio::chain::fork_database::irreversible</a></div><div class="ttdeci">signal&lt; void(block_state_ptr)&gt; irreversible</div><div class="ttdef"><b>Definition:</b> <a href="fork__database_8hpp_source.html#l00071">fork_database.hpp:71</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_a411a7151b8bf3be332abd8f3670dfdf2_html_a411a7151b8bf3be332abd8f3670dfdf2"><div class="ttname"><a href="namespaceeosio_1_1chain_a411a7151b8bf3be332abd8f3670dfdf2.html#a411a7151b8bf3be332abd8f3670dfdf2">eosio::chain::apply_handler</a></div><div class="ttdeci">std::function&lt; void(apply_context &amp;)&gt; apply_handler</div><div class="ttdef"><b>Definition:</b> <a href="apply__context_8hpp_source.html#l00614">apply_context.hpp:614</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1onerror_html"><div class="ttname"><a href="structeosio_1_1chain_1_1onerror.html">eosio::chain::onerror</a></div><div class="ttdef"><b>Definition:</b> <a href="contract__types_8hpp_source.html#l00141">contract_types.hpp:141</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_a4f6e1b734639b1892be2a63414655e0a_html_a4f6e1b734639b1892be2a63414655e0a"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_a4f6e1b734639b1892be2a63414655e0a.html#a4f6e1b734639b1892be2a63414655e0a">eosio::chain::controller_impl::handler_key</a></div><div class="ttdeci">pair&lt; scope_name, action_name &gt; handler_key</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00061">controller.cpp:61</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_aef66534b7230e01e1be95a6eac29b40a_html_aef66534b7230e01e1be95a6eac29b40a"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_aef66534b7230e01e1be95a6eac29b40a.html#aef66534b7230e01e1be95a6eac29b40a">eosio::chain::controller::proposed_producers</a></div><div class="ttdeci">optional&lt; producer_schedule_type &gt; proposed_producers() const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01334">controller.cpp:1334</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1block__header_a02c9f27bf281917a1caf468e229e9c58_html_a02c9f27bf281917a1caf468e229e9c58"><div class="ttname"><a href="structeosio_1_1chain_1_1block__header_a02c9f27bf281917a1caf468e229e9c58.html#a02c9f27bf281917a1caf468e229e9c58">eosio::chain::block_header::id</a></div><div class="ttdeci">block_id_type id() const</div><div class="ttdef"><b>Definition:</b> <a href="block__header_8cpp_source.html#l00022">block_header.cpp:22</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_a20cdc5f2d77f983c95cdf9fea027099d_html_a20cdc5f2d77f983c95cdf9fea027099d"><div class="ttname"><a href="namespaceeosio_1_1chain_a20cdc5f2d77f983c95cdf9fea027099d.html#a20cdc5f2d77f983c95cdf9fea027099d">eosio::chain::account_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; account_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, member&lt; account_object, account_object::id_type, &amp;account_object::id &gt; &gt;, ordered_unique&lt; tag&lt; by_name &gt;, member&lt; account_object, account_name, &amp;account_object::name &gt; &gt; &gt; &gt; account_index</div><div class="ttdef"><b>Definition:</b> <a href="account__object_8hpp_source.html#l00055">account_object.hpp:55</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_a95061eb5d26dd7a18c756f4707eb847b_html_a95061eb5d26dd7a18c756f4707eb847b"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_a95061eb5d26dd7a18c756f4707eb847b.html#a95061eb5d26dd7a18c756f4707eb847b">eosio::chain::controller::head_block_header</a></div><div class="ttdeci">const block_header &amp; head_block_header() const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01205">controller.cpp:1205</a></div></div>
<div class="ttc" id="block__log_8hpp_html"><div class="ttname"><a href="block__log_8hpp.html">block_log.hpp</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_ac54e313144a65a354a663fe6d5cd508a_html_ac54e313144a65a354a663fe6d5cd508a"><div class="ttname"><a href="namespaceeosio_1_1chain_ac54e313144a65a354a663fe6d5cd508a.html#ac54e313144a65a354a663fe6d5cd508a">eosio::chain::dynamic_global_property_multi_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; dynamic_global_property_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, &gt; &gt; &gt; dynamic_global_property_multi_index</div><div class="ttdef"><b>Definition:</b> <a href="global__property__object_8hpp_source.html#l00072">global_property_object.hpp:72</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1resource__limits_1_1resource__limits__manager_a0e777aedcff5772d317ff6b56c7b655b_html_a0e777aedcff5772d317ff6b56c7b655b"><div class="ttname"><a href="classeosio_1_1chain_1_1resource__limits_1_1resource__limits__manager_a0e777aedcff5772d317ff6b56c7b655b.html#a0e777aedcff5772d317ff6b56c7b655b">eosio::chain::resource_limits::resource_limits_manager::verify_account_ram_usage</a></div><div class="ttdeci">void verify_account_ram_usage(const account_name accunt) const</div><div class="ttdef"><b>Definition:</b> <a href="resource__limits_8cpp_source.html#l00177">resource_limits.cpp:177</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_ad290d6b9a4d003ee22086695a92a1667_html_ad290d6b9a4d003ee22086695a92a1667"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_ad290d6b9a4d003ee22086695a92a1667.html#ad290d6b9a4d003ee22086695a92a1667">eosio::chain::controller::get_account</a></div><div class="ttdeci">const account_object &amp; get_account(account_name n) const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01368">controller.cpp:1368</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_a94b666c1656f9b21fc2d01e3dfaf4fb9_html_a94b666c1656f9b21fc2d01e3dfaf4fb9"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_a94b666c1656f9b21fc2d01e3dfaf4fb9.html#a94b666c1656f9b21fc2d01e3dfaf4fb9">eosio::chain::controller_impl::conf</a></div><div class="ttdeci">controller::config conf</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00057">controller.cpp:57</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1genesis__state_a3face836985a26fcbee5c5f69012d16a_html_a3face836985a26fcbee5c5f69012d16a"><div class="ttname"><a href="structeosio_1_1chain_1_1genesis__state_a3face836985a26fcbee5c5f69012d16a.html#a3face836985a26fcbee5c5f69012d16a">eosio::chain::genesis_state::compute_chain_id</a></div><div class="ttdeci">chain_id_type compute_chain_id() const</div><div class="ttdef"><b>Definition:</b> <a href="genesis__state_8cpp_source.html#l00018">genesis_state.cpp:18</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_a8fd103739c49a43cea9f4ad9633a6fa7_html_a8fd103739c49a43cea9f4ad9633a6fa7"><div class="ttname"><a href="namespaceeosio_1_1chain_a8fd103739c49a43cea9f4ad9633a6fa7.html#a8fd103739c49a43cea9f4ad9633a6fa7">eosio::chain::transaction_trace_ptr</a></div><div class="ttdeci">std::shared_ptr&lt; transaction_trace &gt; transaction_trace_ptr</div><div class="ttdef"><b>Definition:</b> <a href="trace_8hpp_source.html#l00034">trace.hpp:34</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_a63347225cf63d4789a5edd7b35c8c35d_html_a63347225cf63d4789a5edd7b35c8c35d"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_a63347225cf63d4789a5edd7b35c8c35d.html#a63347225cf63d4789a5edd7b35c8c35d">eosio::chain::controller::last_irreversible_block_num</a></div><div class="ttdeci">uint32_t last_irreversible_block_num() const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01221">controller.cpp:1221</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023_html_a9f4158583cd1c15ac6a5972f3223e023"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_a9f4158583cd1c15ac6a5972f3223e023.html#a9f4158583cd1c15ac6a5972f3223e023">eosio::chain::controller_impl::db</a></div><div class="ttdeci">chainbase::database db</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00048">controller.cpp:48</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_a3714f7d86e74d48807be7a70a16462e2_html_a3714f7d86e74d48807be7a70a16462e2"><div class="ttname"><a href="namespaceeosio_1_1chain_a3714f7d86e74d48807be7a70a16462e2.html#a3714f7d86e74d48807be7a70a16462e2">eosio::chain::transaction_multi_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; transaction_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, BOOST_MULTI_INDEX_MEMBER(transaction_object, transaction_object::id_type, id)&gt;, ordered_unique&lt; tag&lt; by_trx_id &gt;, BOOST_MULTI_INDEX_MEMBER(transaction_object, transaction_id_type, trx_id)&gt;, ordered_unique&lt; tag&lt; by_expiration &gt;, composite_key&lt; transaction_object, BOOST_MULTI_INDEX_MEMBER(transaction_object, time_point_sec, expiration), &gt; &gt; &gt; &gt; transaction_multi_index</div><div class="ttdef"><b>Definition:</b> <a href="transaction__object_8hpp_source.html#l00047">transaction_object.hpp:47</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_ae31257e06eed13d1fceba7a5851c8e82_html_ae31257e06eed13d1fceba7a5851c8e82"><div class="ttname"><a href="namespaceeosio_1_1chain_ae31257e06eed13d1fceba7a5851c8e82.html#ae31257e06eed13d1fceba7a5851c8e82">eosio::chain::index128_index</a></div><div class="ttdeci">secondary_index&lt; uint128_t, index128_object_type &gt;::index_index index128_index</div><div class="ttdef"><b>Definition:</b> <a href="contract__table__objects_8hpp_source.html#l00129">contract_table_objects.hpp:129</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_a32412d6102d6e878aaec56ae64cb523e_html_a32412d6102d6e878aaec56ae64cb523e"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_a32412d6102d6e878aaec56ae64cb523e.html#a32412d6102d6e878aaec56ae64cb523e">eosio::chain::controller_impl::apply_onerror</a></div><div class="ttdeci">transaction_trace_ptr apply_onerror(const generated_transaction_object &amp;gto, fc::time_point deadline, fc::time_point start, uint32_t billed_cpu_time_us)</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00444">controller.cpp:444</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1genesis__state_ad0bd1ed62be48cca99af294838c38742_html_ad0bd1ed62be48cca99af294838c38742"><div class="ttname"><a href="structeosio_1_1chain_1_1genesis__state_ad0bd1ed62be48cca99af294838c38742.html#ad0bd1ed62be48cca99af294838c38742">eosio::chain::genesis_state::initial_timestamp</a></div><div class="ttdeci">time_point initial_timestamp</div><div class="ttdef"><b>Definition:</b> <a href="genesis__state_8hpp_source.html#l00045">genesis_state.hpp:45</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_a81444eacf323dd782c2215967931af3d_html_a81444eacf323dd782c2215967931af3d"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_a81444eacf323dd782c2215967931af3d.html#a81444eacf323dd782c2215967931af3d">eosio::chain::controller::skip_auth_check</a></div><div class="ttdeci">bool skip_auth_check() const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01342">controller.cpp:1342</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1name_html"><div class="ttname"><a href="structeosio_1_1chain_1_1name.html">eosio::chain::name</a></div><div class="ttdef"><b>Definition:</b> <a href="name_8hpp_source.html#l00042">name.hpp:42</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_a8ae80d1fa16cf1d2f5f04d54f265fcff_html_a8ae80d1fa16cf1d2f5f04d54f265fcff"><div class="ttname"><a href="namespaceeosio_1_1chain_a8ae80d1fa16cf1d2f5f04d54f265fcff.html#a8ae80d1fa16cf1d2f5f04d54f265fcff">eosio::chain::index256_index</a></div><div class="ttdeci">secondary_index&lt; key256_t, index256_object_type &gt;::index_index index256_index</div><div class="ttdef"><b>Definition:</b> <a href="contract__table__objects_8hpp_source.html#l00133">contract_table_objects.hpp:133</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1fork__database_a6c741acfeaa00a41fb5bd3b76b8408dd_html_a6c741acfeaa00a41fb5bd3b76b8408dd"><div class="ttname"><a href="classeosio_1_1chain_1_1fork__database_a6c741acfeaa00a41fb5bd3b76b8408dd.html#a6c741acfeaa00a41fb5bd3b76b8408dd">eosio::chain::fork_database::head</a></div><div class="ttdeci">const block_state_ptr &amp; head() const</div><div class="ttdef"><b>Definition:</b> <a href="fork__database_8cpp_source.html#l00161">fork_database.cpp:161</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1transaction_html"><div class="ttname"><a href="structeosio_1_1chain_1_1transaction.html">eosio::chain::transaction</a></div><div class="ttdef"><b>Definition:</b> <a href="transaction_8hpp_source.html#l00054">transaction.hpp:54</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_ad3716fa18dac5439c8d0dd63e4920b19_html_ad3716fa18dac5439c8d0dd63e4920b19"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_ad3716fa18dac5439c8d0dd63e4920b19.html#ad3716fa18dac5439c8d0dd63e4920b19">eosio::chain::controller_impl::wasmif</a></div><div class="ttdeci">wasm_interface wasmif</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00054">controller.cpp:54</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1reversible__block__object_html"><div class="ttname"><a href="classeosio_1_1chain_1_1reversible__block__object.html">eosio::chain::reversible_block_object</a></div><div class="ttdef"><b>Definition:</b> <a href="reversible__block__object_8hpp_source.html#l00016">reversible_block_object.hpp:16</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_a73bf06c95a2f3d9dae0531996e8e1833_html_a73bf06c95a2f3d9dae0531996e8e1833"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_a73bf06c95a2f3d9dae0531996e8e1833.html#a73bf06c95a2f3d9dae0531996e8e1833">eosio::chain::controller_impl::self</a></div><div class="ttdeci">controller &amp; self</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00047">controller.cpp:47</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_ab4ef0a03050f7740fe082fa687ddb9b1_html_ab4ef0a03050f7740fe082fa687ddb9b1"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_ab4ef0a03050f7740fe082fa687ddb9b1.html#ab4ef0a03050f7740fe082fa687ddb9b1">eosio::chain::controller_impl::initialize_fork_db</a></div><div class="ttdeci">void initialize_fork_db()</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00306">controller.cpp:306</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1transaction__header_a30597dae13f5178c2359e40fd083db5c_html_a30597dae13f5178c2359e40fd083db5c"><div class="ttname"><a href="structeosio_1_1chain_1_1transaction__header_a30597dae13f5178c2359e40fd083db5c.html#a30597dae13f5178c2359e40fd083db5c">eosio::chain::transaction_header::ref_block_num</a></div><div class="ttdeci">uint16_t ref_block_num</div><div class="ttdoc">specifies a block num in the last 2^16 blocks. </div><div class="ttdef"><b>Definition:</b> <a href="transaction_8hpp_source.html#l00032">transaction.hpp:32</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1block__header_a743c65588c382c3c1702341b2c84c552_html_a743c65588c382c3c1702341b2c84c552"><div class="ttname"><a href="structeosio_1_1chain_1_1block__header_a743c65588c382c3c1702341b2c84c552.html#a743c65588c382c3c1702341b2c84c552">eosio::chain::block_header::block_num</a></div><div class="ttdeci">uint32_t block_num() const</div><div class="ttdef"><b>Definition:</b> <a href="block__header_8hpp_source.html#l00040">block_header.hpp:40</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1transaction__object_html"><div class="ttname"><a href="classeosio_1_1chain_1_1transaction__object.html">eosio::chain::transaction_object</a></div><div class="ttdef"><b>Definition:</b> <a href="transaction__object_8hpp_source.html#l00024">transaction_object.hpp:24</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_a1295267c273db02724675e38215ea81f_html_a1295267c273db02724675e38215ea81f"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_a1295267c273db02724675e38215ea81f.html#a1295267c273db02724675e38215ea81f">eosio::chain::controller_impl::make_block_restore_point</a></div><div class="ttdeci">fc::scoped_exit&lt; std::function&lt; void()&gt; &gt; make_block_restore_point()</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00426">controller.cpp:426</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1fork__database_a76e682087ff59329225dbe4bad63c3c9_html_a76e682087ff59329225dbe4bad63c3c9"><div class="ttname"><a href="classeosio_1_1chain_1_1fork__database_a76e682087ff59329225dbe4bad63c3c9.html#a76e682087ff59329225dbe4bad63c3c9">eosio::chain::fork_database::add</a></div><div class="ttdeci">block_state_ptr add(signed_block_ptr b, bool trust=false)</div><div class="ttdef"><b>Definition:</b> <a href="fork__database_8cpp_source.html#l00145">fork_database.cpp:145</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_a5603fe6d434370976459475b8df8bfb7_html_a5603fe6d434370976459475b8df8bfb7"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_a5603fe6d434370976459475b8df8bfb7.html#a5603fe6d434370976459475b8df8bfb7">eosio::chain::controller_impl::apply_handlers</a></div><div class="ttdeci">map&lt; account_name, map&lt; handler_key, apply_handler &gt; &gt; apply_handlers</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00062">controller.cpp:62</a></div></div>
<div class="ttc" id="fork__database_8hpp_html"><div class="ttname"><a href="fork__database_8hpp.html">fork_database.hpp</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_1_1wasm__ops_a46b5a83fe49f18aeefa8d583086395e1_html_a46b5a83fe49f18aeefa8d583086395e1"><div class="ttname"><a href="namespaceeosio_1_1chain_1_1wasm__ops_a46b5a83fe49f18aeefa8d583086395e1.html#a46b5a83fe49f18aeefa8d583086395e1">eosio::chain::wasm_ops::pack</a></div><div class="ttdeci">void pack(instruction_stream *stream, uint32_t field)</div><div class="ttdef"><b>Definition:</b> <a href="wasm__eosio__binary__ops_8hpp_source.html#l00104">wasm_eosio_binary_ops.hpp:104</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_a3f1c90d1dfd7085ab59fa78d47d215e4_html_a3f1c90d1dfd7085ab59fa78d47d215e4"><div class="ttname"><a href="namespaceeosio_1_1chain_a3f1c90d1dfd7085ab59fa78d47d215e4.html#a3f1c90d1dfd7085ab59fa78d47d215e4">eosio::chain::global_property_multi_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; global_property_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, &gt; &gt; &gt; global_property_multi_index</div><div class="ttdef"><b>Definition:</b> <a href="global__property__object_8hpp_source.html#l00063">global_property_object.hpp:63</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1block__log_html"><div class="ttname"><a href="classeosio_1_1chain_1_1block__log.html">eosio::chain::block_log</a></div><div class="ttdef"><b>Definition:</b> <a href="block__log_8hpp_source.html#l00039">block_log.hpp:39</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1action_abbcfcaf717dfd03c1dc0f359754e4ac0_html_abbcfcaf717dfd03c1dc0f359754e4ac0"><div class="ttname"><a href="structeosio_1_1chain_1_1action_abbcfcaf717dfd03c1dc0f359754e4ac0.html#abbcfcaf717dfd03c1dc0f359754e4ac0">eosio::chain::action::data</a></div><div class="ttdeci">bytes data</div><div class="ttdef"><b>Definition:</b> <a href="action_8hpp_source.html#l00063">action.hpp:63</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1transaction__header_a57735f251563cf3b6f1205333b1b6135_html_a57735f251563cf3b6f1205333b1b6135"><div class="ttname"><a href="structeosio_1_1chain_1_1transaction__header_a57735f251563cf3b6f1205333b1b6135.html#a57735f251563cf3b6f1205333b1b6135">eosio::chain::transaction_header::verify_reference_block</a></div><div class="ttdeci">bool verify_reference_block(const block_id_type &amp;reference_block) const</div><div class="ttdef"><b>Definition:</b> <a href="transaction_8cpp_source.html#l00055">transaction.cpp:55</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_a113a4fa08534159756415238097d0b2b_html_a113a4fa08534159756415238097d0b2b"><div class="ttname"><a href="namespaceeosio_1_1chain_a113a4fa08534159756415238097d0b2b.html#a113a4fa08534159756415238097d0b2b">eosio::chain::generated_transaction_multi_index</a></div><div class="ttdeci">chainbase::shared_multi_index_container&lt; generated_transaction_object, indexed_by&lt; ordered_unique&lt; tag&lt; by_id &gt;, BOOST_MULTI_INDEX_MEMBER(generated_transaction_object, generated_transaction_object::id_type, id)&gt;, ordered_unique&lt; tag&lt; by_trx_id &gt;, BOOST_MULTI_INDEX_MEMBER(generated_transaction_object, transaction_id_type, trx_id)&gt;, ordered_unique&lt; tag&lt; by_expiration &gt;, composite_key&lt; generated_transaction_object, BOOST_MULTI_INDEX_MEMBER(generated_transaction_object, time_point, expiration), &gt; &gt;, ordered_unique&lt; tag&lt; by_delay &gt;, composite_key&lt; generated_transaction_object, BOOST_MULTI_INDEX_MEMBER(generated_transaction_object, time_point, delay_until), &gt; &gt;, ordered_unique&lt; tag&lt; by_sender_id &gt;, composite_key&lt; generated_transaction_object, BOOST_MULTI_INDEX_MEMBER(generated_transaction_object, account_name, sender), &gt; &gt; &gt; &gt; generated_transaction_multi_index</div><div class="ttdef"><b>Definition:</b> <a href="generated__transaction__object_8hpp_source.html#l00078">generated_transaction_object.hpp:78</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_a799fd724bdbd33b45a292845a7e6d0e5_html_a799fd724bdbd33b45a292845a7e6d0e5"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_a799fd724bdbd33b45a292845a7e6d0e5.html#a799fd724bdbd33b45a292845a7e6d0e5">eosio::chain::controller::set_proposed_producers</a></div><div class="ttdeci">int64_t set_proposed_producers(vector&lt; producer_key &gt; producers)</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01278">controller.cpp:1278</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_a5783134f223585dfc187a56716b5da22_html_a5783134f223585dfc187a56716b5da22"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_a5783134f223585dfc187a56716b5da22.html#a5783134f223585dfc187a56716b5da22">eosio::chain::controller::get_wasm_interface</a></div><div class="ttdeci">wasm_interface &amp; get_wasm_interface()</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01364">controller.cpp:1364</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_a57274fa2f7d8683ca77841e81c70010e_html_a57274fa2f7d8683ca77841e81c70010e"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_a57274fa2f7d8683ca77841e81c70010e.html#a57274fa2f7d8683ca77841e81c70010e">eosio::chain::controller::pending_producers</a></div><div class="ttdeci">const producer_schedule_type &amp; pending_producers() const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01328">controller.cpp:1328</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1block__header_a187c61e659e9590c656507c663b3b9a2_html_a187c61e659e9590c656507c663b3b9a2"><div class="ttname"><a href="structeosio_1_1chain_1_1block__header_a187c61e659e9590c656507c663b3b9a2.html#a187c61e659e9590c656507c663b3b9a2">eosio::chain::block_header::action_mroot</a></div><div class="ttdeci">checksum256_type action_mroot</div><div class="ttdoc">mroot of cycles_summary </div><div class="ttdef"><b>Definition:</b> <a href="block__header_8hpp_source.html#l00026">block_header.hpp:26</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1authorization__manager_a78089b665cfc36ba15d8fd8be54faad3_html_a78089b665cfc36ba15d8fd8be54faad3"><div class="ttname"><a href="classeosio_1_1chain_1_1authorization__manager_a78089b665cfc36ba15d8fd8be54faad3.html#a78089b665cfc36ba15d8fd8be54faad3">eosio::chain::authorization_manager::create_permission</a></div><div class="ttdeci">const permission_object &amp; create_permission(account_name account, permission_name name, permission_id_type parent, const authority &amp;auth, time_point initial_creation_time=time_point())</div><div class="ttdef"><b>Definition:</b> <a href="authorization__manager_8cpp_source.html#l00031">authorization_manager.cpp:31</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1pending__state_a03463b295d413d85f2521ddc7e66345f_html_a03463b295d413d85f2521ddc7e66345f"><div class="ttname"><a href="structeosio_1_1chain_1_1pending__state_a03463b295d413d85f2521ddc7e66345f.html#a03463b295d413d85f2521ddc7e66345f">eosio::chain::pending_state::push</a></div><div class="ttdeci">void push()</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00041">controller.cpp:41</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1block__header_a0ed33479cde4df295d7c41a388b34220_html_a0ed33479cde4df295d7c41a388b34220"><div class="ttname"><a href="structeosio_1_1chain_1_1block__header_a0ed33479cde4df295d7c41a388b34220.html#a0ed33479cde4df295d7c41a388b34220">eosio::chain::block_header::timestamp</a></div><div class="ttdeci">block_timestamp_type timestamp</div><div class="ttdef"><b>Definition:</b> <a href="block__header_8hpp_source.html#l00009">block_header.hpp:9</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_html"><div class="ttname"><a href="classeosio_1_1chain_1_1controller.html">eosio::chain::controller</a></div><div class="ttdef"><b>Definition:</b> <a href="controller_8hpp_source.html#l00036">controller.hpp:36</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_ab5c1e9a69d9cfd3beb3ec87676b2de48_html_ab5c1e9a69d9cfd3beb3ec87676b2de48"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_ab5c1e9a69d9cfd3beb3ec87676b2de48.html#ab5c1e9a69d9cfd3beb3ec87676b2de48">eosio::chain::controller_impl::blog</a></div><div class="ttdeci">block_log blog</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00050">controller.cpp:50</a></div></div>
<div class="ttc" id="namespaceeosio_1_1chain_ae6d914f3a3962e565e36b7c967990d65_html_ae6d914f3a3962e565e36b7c967990d65"><div class="ttname"><a href="namespaceeosio_1_1chain_ae6d914f3a3962e565e36b7c967990d65.html#ae6d914f3a3962e565e36b7c967990d65">eosio::chain::block_state_ptr</a></div><div class="ttdeci">std::shared_ptr&lt; block_state &gt; block_state_ptr</div><div class="ttdef"><b>Definition:</b> <a href="block__state_8hpp_source.html#l00030">block_state.hpp:30</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1authority_html"><div class="ttname"><a href="structeosio_1_1chain_1_1authority.html">eosio::chain::authority</a></div><div class="ttdef"><b>Definition:</b> <a href="authority_8hpp_source.html#l00059">authority.hpp:59</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1block__header__state_html"><div class="ttname"><a href="structeosio_1_1chain_1_1block__header__state.html">eosio::chain::block_header_state</a></div><div class="ttdoc">defines the minimum state necessary to validate transaction headers </div><div class="ttdef"><b>Definition:</b> <a href="block__header__state_8hpp_source.html#l00011">block_header_state.hpp:11</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_af13c72c9ffae64a8bc75dcb846b5d1d1_html_af13c72c9ffae64a8bc75dcb846b5d1d1"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_af13c72c9ffae64a8bc75dcb846b5d1d1.html#af13c72c9ffae64a8bc75dcb846b5d1d1">eosio::chain::controller_impl::clear_all_undo</a></div><div class="ttdeci">void clear_all_undo()</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00291">controller.cpp:291</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_a5bb158405154fc0e794668b8b841c31b_html_a5bb158405154fc0e794668b8b841c31b"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_a5bb158405154fc0e794668b8b841c31b.html#a5bb158405154fc0e794668b8b841c31b">eosio::chain::controller_impl::get_on_block_transaction</a></div><div class="ttdeci">signed_transaction get_on_block_transaction()</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01094">controller.cpp:1094</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1authorization__manager_html"><div class="ttname"><a href="classeosio_1_1chain_1_1authorization__manager.html">eosio::chain::authorization_manager</a></div><div class="ttdef"><b>Definition:</b> <a href="authorization__manager_8hpp_source.html#l00022">authorization_manager.hpp:22</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_acbf89eb28239a61e433cecb1abb1cfcd_html_acbf89eb28239a61e433cecb1abb1cfcd"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_acbf89eb28239a61e433cecb1abb1cfcd.html#acbf89eb28239a61e433cecb1abb1cfcd">eosio::chain::controller::push_scheduled_transaction</a></div><div class="ttdeci">transaction_trace_ptr push_scheduled_transaction(const transaction_id_type &amp;scheduled, fc::time_point deadline, uint32_t billed_cpu_time_us=0)</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01188">controller.cpp:1188</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1updateauth_html"><div class="ttname"><a href="structeosio_1_1chain_1_1updateauth.html">eosio::chain::updateauth</a></div><div class="ttdef"><b>Definition:</b> <a href="contract__types_8hpp_source.html#l00056">contract_types.hpp:56</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_af826b7e42e964e5942bbb53d6e8cd99a_html_af826b7e42e964e5942bbb53d6e8cd99a"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_af826b7e42e964e5942bbb53d6e8cd99a.html#af826b7e42e964e5942bbb53d6e8cd99a">eosio::chain::controller_impl::resource_limits</a></div><div class="ttdeci">resource_limits_manager resource_limits</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00055">controller.cpp:55</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a_html_af1ddbd95476e5e9b1a83b0bf6667428a"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_af1ddbd95476e5e9b1a83b0bf6667428a.html#af1ddbd95476e5e9b1a83b0bf6667428a">eosio::chain::controller_impl::head</a></div><div class="ttdeci">block_state_ptr head</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00052">controller.cpp:52</a></div></div>
<div class="ttc" id="name_8hpp_af9c1edb0e0da55ec6ba09f32f6839529_html_af9c1edb0e0da55ec6ba09f32f6839529"><div class="ttname"><a href="name_8hpp_af9c1edb0e0da55ec6ba09f32f6839529.html#af9c1edb0e0da55ec6ba09f32f6839529">N</a></div><div class="ttdeci">#define N(X)</div><div class="ttdef"><b>Definition:</b> <a href="name_8hpp_source.html#l00040">name.hpp:40</a></div></div>
<div class="ttc" id="controller_8hpp_html"><div class="ttname"><a href="controller_8hpp.html">controller.hpp</a></div></div>
<div class="ttc" id="generated__transaction__object_8hpp_html"><div class="ttname"><a href="generated__transaction__object_8hpp.html">generated_transaction_object.hpp</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_ac40e393162757df9f0ef076b616dc97c_html_ac40e393162757df9f0ef076b616dc97c"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_ac40e393162757df9f0ef076b616dc97c.html#ac40e393162757df9f0ef076b616dc97c">eosio::chain::controller_impl::add_indices</a></div><div class="ttdeci">void add_indices()</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00267">controller.cpp:267</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1authority_ae836513329658bea29e24f4122f4f5d6_html_ae836513329658bea29e24f4122f4f5d6"><div class="ttname"><a href="structeosio_1_1chain_1_1authority_ae836513329658bea29e24f4122f4f5d6.html#ae836513329658bea29e24f4122f4f5d6">eosio::chain::authority::accounts</a></div><div class="ttdeci">vector&lt; permission_level_weight &gt; accounts</div><div class="ttdef"><b>Definition:</b> <a href="authority_8hpp_source.html#l00075">authority.hpp:75</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_ad13b01f7b0aad220af8e9dffa98641f4_html_ad13b01f7b0aad220af8e9dffa98641f4"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_ad13b01f7b0aad220af8e9dffa98641f4.html#ad13b01f7b0aad220af8e9dffa98641f4">eosio::chain::controller::fetch_block_by_id</a></div><div class="ttdeci">signed_block_ptr fetch_block_by_id(block_id_type id) const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01243">controller.cpp:1243</a></div></div>
<div class="ttc" id="block__summary__object_8hpp_html"><div class="ttname"><a href="block__summary__object_8hpp.html">block_summary_object.hpp</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_af6aa9a5bcc592ae08c47d4f27a1a026c_html_af6aa9a5bcc592ae08c47d4f27a1a026c"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_af6aa9a5bcc592ae08c47d4f27a1a026c.html#af6aa9a5bcc592ae08c47d4f27a1a026c">eosio::chain::controller::check_contract_list</a></div><div class="ttdeci">void check_contract_list(account_name code) const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01402">controller.cpp:1402</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_a26d9e0eb5813aec9ba7fd212dab171c7_html_a26d9e0eb5813aec9ba7fd212dab171c7"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_a26d9e0eb5813aec9ba7fd212dab171c7.html#a26d9e0eb5813aec9ba7fd212dab171c7">eosio::chain::controller::is_known_unexpired_transaction</a></div><div class="ttdeci">bool is_known_unexpired_transaction(const transaction_id_type &amp;id) const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01463">controller.cpp:1463</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_af6a3e729d218d758a39da4dcec11a280_html_af6a3e729d218d758a39da4dcec11a280"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_af6a3e729d218d758a39da4dcec11a280.html#af6a3e729d218d758a39da4dcec11a280">eosio::chain::controller_impl::initialize_database</a></div><div class="ttdeci">void initialize_database()</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00357">controller.cpp:357</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1block__header__state_a04b4b750a38256cd43112e537618d553_html_a04b4b750a38256cd43112e537618d553"><div class="ttname"><a href="structeosio_1_1chain_1_1block__header__state_a04b4b750a38256cd43112e537618d553.html#a04b4b750a38256cd43112e537618d553">eosio::chain::block_header_state::active_schedule</a></div><div class="ttdeci">producer_schedule_type active_schedule</div><div class="ttdef"><b>Definition:</b> <a href="block__header__state_8hpp_source.html#l00021">block_header_state.hpp:21</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_afc114a9bfeaf2673c72b095dde4700e5_html_afc114a9bfeaf2673c72b095dde4700e5"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_afc114a9bfeaf2673c72b095dde4700e5.html#afc114a9bfeaf2673c72b095dde4700e5">eosio::chain::controller_impl::replaying</a></div><div class="ttdeci">bool replaying</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00059">controller.cpp:59</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1transaction__header_aad917528c8e713d3fc042210864cef53_html_aad917528c8e713d3fc042210864cef53"><div class="ttname"><a href="structeosio_1_1chain_1_1transaction__header_aad917528c8e713d3fc042210864cef53.html#aad917528c8e713d3fc042210864cef53">eosio::chain::transaction_header::set_reference_block</a></div><div class="ttdeci">void set_reference_block(const block_id_type &amp;reference_block)</div><div class="ttdef"><b>Definition:</b> <a href="transaction_8cpp_source.html#l00050">transaction.cpp:50</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1fork__database_html"><div class="ttname"><a href="classeosio_1_1chain_1_1fork__database.html">eosio::chain::fork_database</a></div><div class="ttdoc">manages light-weight state for all potential unconfirmed forks </div><div class="ttdef"><b>Definition:</b> <a href="fork__database_8hpp_source.html#l00022">fork_database.hpp:22</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1block__log_a4c80fb522e95773c33a035c863201aef_html_a4c80fb522e95773c33a035c863201aef"><div class="ttname"><a href="classeosio_1_1chain_1_1block__log_a4c80fb522e95773c33a035c863201aef.html#a4c80fb522e95773c33a035c863201aef">eosio::chain::block_log::reset_to_genesis</a></div><div class="ttdeci">uint64_t reset_to_genesis(const genesis_state &amp;gs, const signed_block_ptr &amp;genesis_block)</div><div class="ttdef"><b>Definition:</b> <a href="block__log_8cpp_source.html#l00202">block_log.cpp:202</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_a45489fbdb8b64b0c9e0dcdc1a71b35af_html_a45489fbdb8b64b0c9e0dcdc1a71b35af"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_a45489fbdb8b64b0c9e0dcdc1a71b35af.html#a45489fbdb8b64b0c9e0dcdc1a71b35af">eosio::chain::controller::active_producers</a></div><div class="ttdeci">const producer_schedule_type &amp; active_producers() const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01322">controller.cpp:1322</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1deleteauth_html"><div class="ttname"><a href="structeosio_1_1chain_1_1deleteauth.html">eosio::chain::deleteauth</a></div><div class="ttdef"><b>Definition:</b> <a href="contract__types_8hpp_source.html#l00071">contract_types.hpp:71</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1resource__limits_1_1resource__limits__manager_ae5bf9dae31e77d62b013a6590911f627_html_ae5bf9dae31e77d62b013a6590911f627"><div class="ttname"><a href="classeosio_1_1chain_1_1resource__limits_1_1resource__limits__manager_ae5bf9dae31e77d62b013a6590911f627.html#ae5bf9dae31e77d62b013a6590911f627">eosio::chain::resource_limits::resource_limits_manager::add_indices</a></div><div class="ttdeci">void add_indices()</div><div class="ttdef"><b>Definition:</b> <a href="resource__limits_8cpp_source.html#l00041">resource_limits.cpp:41</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1resource__limits_1_1resource__limits__manager_a453dba43454b8498745200b37f658b26_html_a453dba43454b8498745200b37f658b26"><div class="ttname"><a href="classeosio_1_1chain_1_1resource__limits_1_1resource__limits__manager_a453dba43454b8498745200b37f658b26.html#a453dba43454b8498745200b37f658b26">eosio::chain::resource_limits::resource_limits_manager::initialize_account</a></div><div class="ttdeci">void initialize_account(const account_name &amp;account)</div><div class="ttdef"><b>Definition:</b> <a href="resource__limits_8cpp_source.html#l00062">resource_limits.cpp:62</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_af046b9bd6a679a4a28cab4a3f46f2d8c_html_af046b9bd6a679a4a28cab4a3f46f2d8c"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_af046b9bd6a679a4a28cab4a3f46f2d8c.html#af046b9bd6a679a4a28cab4a3f46f2d8c">eosio::chain::controller::validate_referenced_accounts</a></div><div class="ttdeci">void validate_referenced_accounts(const transaction &amp;t) const</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01412">controller.cpp:1412</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_aefc14531638f18365926345eb19fa2e6_html_aefc14531638f18365926345eb19fa2e6ac9e825f4641cd3bec0ba01a0c2d67755"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_aefc14531638f18365926345eb19fa2e6.html#aefc14531638f18365926345eb19fa2e6ac9e825f4641cd3bec0ba01a0c2d67755">eosio::chain::controller::block_status::validated</a></div><div class="ttdoc">this is a complete block signed by a valid producer and has been previously applied by this node and ...</div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_a1e289b420cc20017f3e71ba22796103a_html_a1e289b420cc20017f3e71ba22796103a"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_a1e289b420cc20017f3e71ba22796103a.html#a1e289b420cc20017f3e71ba22796103a">eosio::chain::controller_impl::fork_db</a></div><div class="ttdeci">fork_database fork_db</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00053">controller.cpp:53</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1controller__impl_a6e07da740cc105ebe561ab6f3bf69cc8_html_a6e07da740cc105ebe561ab6f3bf69cc8"><div class="ttname"><a href="structeosio_1_1chain_1_1controller__impl_a6e07da740cc105ebe561ab6f3bf69cc8.html#a6e07da740cc105ebe561ab6f3bf69cc8">eosio::chain::controller_impl::create_native_account</a></div><div class="ttdeci">void create_native_account(account_name name, const authority &amp;owner, const authority &amp;active, bool is_privileged=false)</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l00327">controller.cpp:327</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1wasm__interface_html"><div class="ttname"><a href="classeosio_1_1chain_1_1wasm__interface.html">eosio::chain::wasm_interface</a></div><div class="ttdef"><b>Definition:</b> <a href="wasm__interface_8hpp_source.html#l00050">wasm_interface.hpp:50</a></div></div>
<div class="ttc" id="classeosio_1_1chain_1_1controller_af74b99ec7d2d67db061645b316541a15_html_af74b99ec7d2d67db061645b316541a15"><div class="ttname"><a href="classeosio_1_1chain_1_1controller_af74b99ec7d2d67db061645b316541a15.html#af74b99ec7d2d67db061645b316541a15">eosio::chain::controller::push_confirmation</a></div><div class="ttdeci">void push_confirmation(const header_confirmation &amp;c)</div><div class="ttdef"><b>Definition:</b> <a href="controller_8cpp_source.html#l01180">controller.cpp:1180</a></div></div>
<div class="ttc" id="reversible__block__object_8hpp_html"><div class="ttname"><a href="reversible__block__object_8hpp.html">reversible_block_object.hpp</a></div></div>
<div class="ttc" id="structeosio_1_1chain_1_1setcode_html"><div class="ttname"><a href="structeosio_1_1chain_1_1setcode.html">eosio::chain::setcode</a></div><div class="ttdef"><b>Definition:</b> <a href="contract__types_8hpp_source.html#l00027">contract_types.hpp:27</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue May 29 2018 17:40:54 for Eos by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
